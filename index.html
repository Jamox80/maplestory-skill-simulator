<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="ui/favicon.ico">
    <title>Artale技能模擬器</title>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-13D7FF11WN"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-13D7FF11WN');
</script>
    <style>
        /* --- PC 網頁版通用樣式調整 (魔法書卷風格) --- */

body {
    /* 確保背景舒適且不過於花俏，如果還沒有羊皮紙紋理，可以考慮加入 */
    background-color: #f0e6d6; /* 柔和的羊皮紙底色 */
    background-image: url('ui/parchment_texture.png');
    background-size: 100% 100%; /* 寬度固定為100%，高度拉伸以填滿整個內容區域 */
    background-repeat: no-repeat; /* 背景不重複 */
    background-attachment: scroll; /* PC版：背景隨頁面滾動 */
    background-position: center top; /* PC版：背景置頂 */
    font-family: 'Segoe UI', Arial, sans-serif; /* 常用且清晰的字體，或使用您喜歡的Google Fonts */
    line-height: 1.6; /* 增加行高，提升閱讀舒適度 */
    color: #333; /* 預設文字顏色 */
    display: flex; /* 讓body成為flex容器 */
    flex-direction: column; /* 垂直排列 */
    align-items: center; /* 水平居中所有內容 */
    min-height: 100vh; /* 確保內容至少佔據整個視窗高度 */
}

h1 {
    font-family: 'Cinzel Decorative', serif; /* 更具裝飾性的標題字體 */
    color: #4a2d1d; /* 深棕色，與書卷風格更搭 */
    text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.2); /* 增加文字陰影，提升立體感 */
    margin-top: 50px; /* 在標題上方增加間距，使其不會緊貼頂部 */
    margin-bottom: 30px; /* 增加與控制區的間距 */
    font-size: 2.5em; /* 調整標題大小 */
    letter-spacing: 2px; /* 增加字元間距，更顯大氣 */
    display: flex;
    align-items: center;
    justify-content: center;
}

.title-icon {
    height: 3.5em; /* 讓圖示高度與文字大小協調 */
    margin-right: 30px; /* 圖示與文字的間距 */
    vertical-align: middle; /* 確保垂直對齊 */
}

.controls {
    background-color: rgba(255, 255, 255, 0.5); /* 輕微透明背景 */
    padding: 15px 30px; /* 增加內邊距 */
    border-radius: 10px; /* 圓潤邊角 */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* 較明顯的陰影，提升層次感 */
    margin-bottom: 25px; /* 與主內容區的間距 */
    display: flex; /* 確保內部元素對齊 */
    align-items: center;
    justify-content: center;
    gap: 30px; /* 控制元素之間更大間距 */
}

.controls label {
    font-size: 1.1em; /* 調整標籤字體大小 */
    color: #5d4037; /* 深棕色 */
}

.controls select,
.controls input[type="number"] {
    padding: 10px 15px; /* 增加輸入框和選單的內邊距 */
    border: 2px solid #795548; /* 更明顯的邊框 */
    border-radius: 8px; /* 圓角 */
    background-color: #fefefe8c; /* 淺色背景 */
    color: #4e342e; /* 深文字 */
    box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.158); /* 內陰影，提升質感 */
    transition: border-color 0.3s ease, box-shadow 0.3s ease; /* 鼠標懸停過渡 */
}

.controls select:focus,
.controls input[type="number"]:focus {
    border-color: #a1887f; /* 聚焦時的邊框顏色 */
    box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1), 0 0 8px rgba(161, 136, 127, 0.5); /* 聚焦時的陰影 */
    outline: none; /* 移除瀏覽器預設的聚焦外框 */
}

.reset-button, .share-button {
    padding: 10px 20px;
    border-radius: 8px;
    font-size: 1.1em;
    font-weight: bold;
    color: white;
    border: none;
    cursor: pointer;
    transition: background-color 0.2s, box-shadow 0.2s;
    box-shadow: 0 2px 5px rgba(0,0,0,0.15);
}
.reset-button { background-color: #d32f2f; }
.reset-button:hover { background-color: #c62828; }
.share-button { background-color: #1976d2; }
.share-button:hover { background-color: #1565c0; }

.container {
    display: flex; /* 保持 flex 佈局，實現左右分欄 */
    justify-content: center;
    gap: 30px; /* 增加技能樹和總結區塊的間距 */
    max-width: 1200px; /* 限制整體內容最大寬度，避免過寬 */
    width: 90%; /* 佔據大部分可用寬度 */
    margin-bottom: 40px; /* 增加與頁面底部的間距 */
    flex-grow: 1; /* 讓主內容區塊擴展以填滿剩餘的垂直空間 */
    align-items: flex-start; /* 讓技能樹和總結區塊從頂部對齊，解決空白問題 */
}

.skill-tree,
.summary {
    background-color: rgba(252, 242, 223, 0.5); /* 讓內容區塊有近乎不透明的紙張感 */
    border: 3px solid #795548; /* 更粗的書卷邊框 */
    border-radius: 12px; /* 更圓潤的邊角 */
    padding: 40px; /* 增加內邊距，模擬書頁的寬廣邊緣 */
    box-shadow:
        0 8px 20px rgba(0, 0, 0, 0.3), /* 顯著的下層陰影 */
        inset 0 0 0 6px rgba(181, 158, 145, 0.4); /* 內邊框的陰影，模擬紙張厚度 */
    transition: transform 0.3s ease, box-shadow 0.3s ease; /* 平滑的懸停過渡 */
    position: relative;
    overflow: hidden;
    /* 模擬輕微捲曲的效果 */
    transform: perspective(1000px) rotateX(2deg) translateY(-8px); /* 輕微的3D旋轉和上移 */
}

.skill-tree:hover,
.summary:hover {
    transform: perspective(1000px) rotateX(0deg) translateY(0px); /* 鼠標懸停時稍微展開，增加互動感 */
    box-shadow: 0 12px 25px rgba(0, 0, 0, 0.4),
                inset 0 0 0 6px rgba(181, 158, 145, 0.5);
}

.skill-tree {
    width: 80%; /* 技能樹佔比更大 */
}

.summary {
    width: 20%; /* 總結區塊佔比 */
    position: sticky; /* 讓總結區塊在滾動時懸浮 */
    top: 150px; /* 距離頂部 150px，讓它位置更低 */
    height: fit-content; /* 高度自適應內容，避免不必要的拉伸 */
}

h2 {
    font-family: 'Cinzel Decorative', cursive; /* 與H1風格一致 */
    color: #795548; /* 深棕色 */
    border-bottom: 3px solid #795548; /* 更粗的底線 */
    padding-bottom: 8px;
    margin-bottom: 25px;
    text-align: center; /* 標題居中 */
}

/* 技能項目 (skill-item) 內部的微調 */
.skill-item {
    padding: 12px; /* 增加內邊距 */
    margin-bottom: 15px; /* 增加間距 */
    background-color: rgba(255, 255, 255, 0.65); /* 輕微透明，讓紋理透出 */
    border: 1px solid #bcaaa4; /* 細緻邊框 */
    border-radius: 6px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1); /* 輕微陰影 */
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}
.skill-item:hover {
    transform: translateY(-3px); /* 鼠標懸停時輕微上浮 */
    box-shadow: 0 4px 10px rgba(0,0,0,0.2);
}

.skill-header {
    display: flex;
    align-items: center;
    width: 100%;
}

.skill-icon {
    width: 40px; /* 調整圖示大小，使其在PC上更顯眼 */
    height: 40px;
    margin-right: 15px;
}

.skill-name {
    /* 這裡的修改：移除 flex-grow: 1; 並添加防止換行的屬性 */
    /* flex-grow: 1; <-- 移除這行 */
    flex-shrink: 1; /* 允許縮小 */
    overflow: hidden; /* 隱藏溢出內容 */
    text-overflow: ellipsis; /* 溢出時顯示省略號 */
    white-space: nowrap; /* 強制文字不換行 */
    font-size: 1.1em; /* 調整技能名稱字體 */
    color: #4e342e; /* 與主題色協調 */
    /* padding-right: 10px; 保持原本的間距 */
    /* display: flex; align-items: center; 保持原本的flex對齊 */
}

.skill-level-controls {
    display: flex;
    align-items: center;
    gap: 5px; /* 保持按鈕間距 */
    flex-shrink: 0; /* 阻止這個區塊縮小 */
    white-space: nowrap; /* 阻止按鈕換行 */
    margin-left: auto; /* 將控制按鈕推到右邊 */
}
.skill-level-controls button {
    padding: 8px 15px; /* 按鈕更大，更易點擊 */
    border-radius: 6px;
    font-size: 1em;
    font-weight: bold;
    text-transform: uppercase; /* 文字大寫，增加力量感 */
    box-shadow: 0 2px 4px rgba(0,0,0,0.1); /* 按鈕陰影 */
    background-color: #a1887f; /* 淺棕色，與書卷風格協調 */
    color: #f5f5f5; /* 淺色文字以確保可讀性 */
    border: 1px solid #795548; /* 深棕色邊框 */
    cursor: pointer;
    transition: background-color 0.2s ease;
}
.skill-level-controls button:hover:not(:disabled) {
    background-color: #8d6e63; /* 懸停時加深顏色 */
}
.skill-level-controls button:disabled {
    background-color: #d7ccc8; /* 禁用時的顏色 */
    color: #a1887f;
    cursor: not-allowed;
    border-color: #bcaaa4;
}
.skill-level-controls .max-button {
    background-color: #4caf50; /* 點滿按鈕更亮的綠色 */
}
.skill-level-controls .max-button:hover:not(:disabled) {
    background-color: #388e3c;
}

.skill-current-level {
    font-size: 1.1em;
    min-width: 40px; /* 確保顯示足夠空間 */
    color: #6d4c41; /* 調整顏色 */
}

.skill-prerequisites {
    font-size: 0.85em; /* 調整字體大小 */
    color: #6d4c41; /* 更深的顏色 */
    margin-top: 10px; /* 與上方內容間距 */
    padding-top: 8px; /* 內邊距 */
    border-top: 1px dashed #d7ccc8; /* 虛線分隔，更具書卷感 */
}
.skill-prerequisites .prereq-met {
    color: #388e3c; /* 更深的綠色 */
}
.skill-prerequisites .prereq-unmet {
    color: #d32f2f; /* 更深的紅色 */
}

.skill-description-area {
    background-color: rgba(245, 245, 245, 0.9); /* 略淺的背景，與技能項目主體有層次 */
    border-top: 1px solid #bcaaa4;
    padding: 12px;
    margin-top: 15px;
    border-radius: 6px;
}
.skill-description-area .current-level-effect {
    color: #1976d2; /* 調整藍色 */
}
.skill-description-area .full-description {
    color: #5d4037; /* 深棕色 */
}

/* 新增：垂直分隔線樣式 */
.vertical-separator {
    border-left: 1px solid #d7ccc8; /* 垂直線條，顏色與其他分隔線協調 */
    margin: 0 15px; /* 左右間距 */
    align-self: stretch; /* 讓分隔線自動延展高度 */
}
 /* --- 手機版適應性調整 (Media Queries) --- */
        @media (max-width: 768px) {
            /* 1. 整體與標題 */
            body {
                padding: 0 10px; /* 調整 body 邊距，避免內容緊貼螢幕邊緣 */
                -webkit-text-size-adjust: 100%; /* 防止 iOS 橫向時自動放大字體 */
                background-attachment: fixed; /* 手機版：背景固定 */
                background-position: center center; /* 手機版：背景置中 */
                background-size: cover; /* 手機版：覆蓋整個畫面，保持比例並裁切 */
            }
            h1 {
                font-size: 1.8em; /* 調整標題大小 */
                margin: 25px 0; /* 調整標題上下間距 */
            }

            /* 2. 控制區塊 */
            .controls {
                flex-direction: column; /* 控制區塊垂直堆疊 */
                width: 100%;
                padding: 15px;
                gap: 15px; /* 縮小元素間距 */
                box-sizing: border-box;
            }
            .controls label,
            .controls select,
            .controls input[type="number"],
            .controls .reset-button {
                width: 100%;
                margin: 0; /* 移除所有外邊距 */
                box-sizing: border-box;
            }
            .controls label {
                text-align: left; /* 標籤文字靠左 */
                margin-bottom: -5px; /* 縮小與輸入框的距離 */
            }

            /* 3. 主內容容器 */
            .container {
                flex-direction: column; /* 主內容區塊垂直堆疊 */
                width: 100%;
                gap: 20px; /* 調整技能樹與總結區塊的間距 */
            }

            /* 4. 技能樹與總結區塊 */
            .skill-tree,
            .summary {
                width: 100%;
                padding: 20px; /* 縮小內邊距 */
                box-sizing: border-box;
                transform: none; /* 移除 PC 版的 3D 傾斜效果 */
                box-shadow: 0 4px 10px rgba(0,0,0,0.15); /* 使用較柔和的陰影 */
            }
            .summary {
                position: static; /* 取消吸頂效果 */
                margin-top: 0;
            }
            .summary p {
                margin: 0.7em 0; /* 調整總結區塊的行間距 */
            }
            h2 {
                font-size: 1.5em; /* 縮小區塊標題 */
                margin-bottom: 20px;
            }

            /* 5. 技能項目 */
            .skill-item {
                padding: 10px; /* 調整內邊距 */
                margin-bottom: 10px;
            }
            .skill-header {
                flex-wrap: wrap; /* 允許換行 */
                gap: 10px 0; /* 增加垂直間距 */
            }
            .skill-icon {
                width: 32px; /* 縮小圖示 */
                height: 32px;
                margin-right: 10px;
            }
            .skill-name {
                /* 讓技能名稱和圖示佔據一行，並推開控制按鈕 */
                flex-grow: 1;
                white-space: normal; /* 允許名稱換行 */
                font-size: 1em;
            }
            .skill-level-controls {
                /* 讓控制按鈕佔據整行，並靠右對齊 */
                flex-basis: 100%;
                justify-content: flex-end;
                gap: 8px;
            }
            .skill-level-controls button {
                padding: 6px 12px; /* 調整按鈕大小 */
                font-size: 1em;
            }

            .skill-current-level {
                font-size: 1em;
                min-width: 30px;
            }

            /* 6. 前置與描述 */
            .skill-prerequisites {
                font-size: 0.8em;
                justify-content: flex-start; /* 文字靠左對齊 */
                text-align: left;
            }
            .skill-description-area {
                padding: 10px;
            }
            .skill-description-area .current-level-effect,
            .skill-description-area .full-description {
                font-size: 0.9em; /* 統一描述字體大小 */
            }
        }
    </style>
</head>
<body>
    <h1><img src="ui/title-icon.png" alt="標題圖示" class="title-icon">Artale技能模擬器</h1>

    <div class="controls">
        <label for="professionSelect">選擇職業:</label>
        <select id="professionSelect" onchange="loadProfessionData(this.value)">
            </select>
        <label for="levelInput">當前等級:</label>
        <input type="number" id="levelInput" value="100" min="1" max="300" oninput="updateLevelFromInput()">
        <button class="reset-button" onclick="resetSimulator()">重置</button>
        <button class="share-button" onclick="shareBuild()">分享配點</button>
    </div>

    <div class="container">
        <div class="skill-tree" id="skillTree">
            </div>

     <div class="summary">
            <h2>點數總結</h2>
            <p>總已分配點數: <span id="spentSp">0</span></p>
            <p>剩餘點數: <span id="remainingSp">0</span></p>
            <hr>
            <p>1轉/(2轉需求): <span id="spentSp_1stJob">0</span> / <span id="reqSp_2ndJob">0</span></p>
            <p>2轉/(3轉需求): <span id="spentSp_2ndJob_total">0</span> / <span id="reqSp_3rdJob">0</span></p>
            <p>3轉: <span id="spentSp_3rdJob_total">0</span> </p>
            </div>
    </div>

    <script>

        // --- 所有職業的數據結構 ---
               const allProfessionsData = {
            "主教 (Bishop)": {
                startingLevelForSp: 8,
                jobAdvancementSpBonuses: [8, 30, 70, 120],
                jobStagesOrder: ["0轉 (新手)", "1轉 (魔法師)", "2轉 (僧侶)", "3轉 (祭司)", "4轉 (主教)", "超技能", "5轉技能", "共通技能"],
                spRequiredFor2ndJob: 67, // 法師2轉點數需求
                spRequiredFor3rdJob: 188, // 法師3轉點數需求
                spRequiredFor4thJob: 255, // 4轉通用點數需求
                skills: {
                    "0轉 (新手)": [],
                    "1轉 (魔法師)": [
                        {
                            id: "magicPurify", name: "魔力淨化", maxLevel: 16, requiredLevel: 10, preRequisite: {}, description: "每10秒鐘可恢復更多量的MP。", imageUrl: "images/magicPurify.png",
                            levels: Array(17).fill(null).map((_, i) => i === 0 ? null : { effect: `${(0.1 * i).toFixed(1)}x角色等級+3 MP回復量`, fullDescription: `每10秒鐘可恢復更多量的MP。回復量公式：${(0.1 * i).toFixed(1)}x角色等級+3` })
                        },
                        {
                            id: "magicExtension", name: "魔力擴展", maxLevel: 10, requiredLevel: 10, preRequisite: { "magicPurify": 5 }, description: "當等級提升時，增加MP的最大追加量。", imageUrl: "images/magicExtension.png",
                            levels: Array(11).fill(null).map((_, i) => i === 0 ? null : { effect: `升級追加量: ${2 * i}`, fullDescription: `當等級提升時，增加MP的最大追加量。等級${i}效果：升級追加量${2 * i}。` })
                        },
                        {
                            id: "magicGuard", name: "魔心防禦", maxLevel: 20, requiredLevel: 10, preRequisite: {}, description: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。但若MP達到0時，則直接消耗HP。", imageUrl: "images/magicGuard.png",
                            levels: [
                                null,
                                { effect: "消耗MP: 6, 持續時間: 170秒, 替代率: 23%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級1效果：消耗MP6，持續170秒，替代率23%。" },
                                { effect: "消耗MP: 6, 持續時間: 180秒, 替代率: 26%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級2效果：消耗MP6，持續180秒，替代率26%。" },
                                { effect: "消耗MP: 6, 持續時間: 190秒, 替代率: 29%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級3效果：消耗MP6，持續190秒，替代率29%。" },
                                { effect: "消耗MP: 6, 持續時間: 200秒, 替代率: 32%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級4效果：消耗MP6，持續200秒，替代率32%。" },
                                { effect: "消耗MP: 6, 持續時間: 210秒, 替代率: 35%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級5效果：消耗MP6，持續210秒，替代率35%。" },
                                { effect: "消耗MP: 6, 持續時間: 220秒, 替代率: 38%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級6效果：消耗MP6，持續220秒，替代率38%。" },
                                { effect: "消耗MP: 6, 持續時間: 230秒, 替代率: 41%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級7效果：消耗MP6，持續230秒，替代率41%。" },
                                { effect: "消耗MP: 6, 持續時間: 240秒, 替代率: 44%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級8效果：消耗MP6，持續240秒，替代率44%。" },
                                { effect: "消耗MP: 6, 持續時間: 250秒, 替代率: 47%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級9效果：消耗MP6，持續250秒，替代率47%。" },
                                { effect: "消耗MP: 6, 持續時間: 260秒, 替代率: 50%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級10效果：消耗MP6，持續260秒，替代率50%。" },
                                { effect: "消耗MP: 12, 持續時間: 270秒, 替代率: 53%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級11效果：消耗MP12，持續270秒，替代率53%。" },
                                { effect: "消耗MP: 12, 持續時間: 280秒, 替代率: 56%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級12效果：消耗MP12，持續280秒，替代率56%。" },
                                { effect: "消耗MP: 12, 持續時間: 290秒, 替代率: 59%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級13效果：消耗MP12，持續290秒，替代率59%。" },
                                { effect: "消耗MP: 12, 持續時間: 300秒, 替代率: 62%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級14效果：消耗MP12，持續300秒，替代率62%。" },
                                { effect: "消耗MP: 12, 持續時間: 310秒, 替代率: 65%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級15效果：消耗MP12，持續310秒，替代率65%。" },
                                { effect: "消耗MP: 12, 持續時間: 320秒, 替代率: 68%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級16效果：消耗MP12，持續320秒，替代率68%。" },
                                { effect: "消耗MP: 12, 持續時間: 330秒, 替代率: 71%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級17效果：消耗MP12，持續330秒，替代率71%。" },
                                { effect: "消耗MP: 12, 持續時間: 340秒, 替代率: 74%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級18效果：消耗MP12，持續340秒，替代率74%。" },
                                { effect: "消耗MP: 12, 持續時間: 350秒, 替代率: 77%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級19效果：消耗MP12，持續350秒，替代率77%。" },
                                { effect: "消耗MP: 12, 持續時間: 360秒，替代率: 80%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級20效果：消耗MP12，持續360秒，替代率80%。" }
                            ]
                        },
                        {
                            id: "magicShield", name: "魔力之盾", maxLevel: 20, requiredLevel: 10, preRequisite: { "magicGuard": 3 }, description: "一定時間內把魔力集中在盔甲上，提高物理防禦力。", imageUrl: "images/magicShield.png",
                            levels: [
                                null,
                                { effect: "消耗MP: 8, 持續時間: 20秒, 防禦力: 2", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級1效果：消耗MP8，持續20秒，防禦力2。" },
                                { effect: "消耗MP: 8, 持續時間: 40秒, 防禦力: 4", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級2效果：消耗MP8，持續40秒，防禦力4。" },
                                { effect: "消耗MP: 8, 持續時間: 60秒, 防禦力: 6", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級3效果：消耗MP8，持續60秒，防禦力6。" },
                                { effect: "消耗MP: 8, 持續時間: 80秒, 防禦力: 8", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級4效果：消耗MP8，持續80秒，防禦力8。" },
                                { effect: "消耗MP: 8, 持續時間: 100秒, 防禦力: 10", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級5效果：消耗MP8，持續100秒，防禦力10。" },
                                { effect: "消耗MP: 8, 持續時間: 120秒, 防禦力: 12", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級6效果：消耗MP8，持續120秒，防禦力12。" },
                                { effect: "消耗MP: 8, 持續時間: 140秒, 防禦力: 14", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級7效果：消耗MP8，持續140秒，防禦力14。" },
                                { effect: "消耗MP: 8, 持續時間: 160秒, 防禦力: 16", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級8效果：消耗MP8，持續160秒，防禦力16。" },
                                { effect: "消耗MP: 8, 持續時間: 180秒, 防禦力: 18", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級9效果：消耗MP8，持續180秒，防禦力18。" },
                                { effect: "消耗MP: 8, 持續時間: 200秒, 防禦力: 20", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級10效果：消耗MP8，持續200秒，防禦力20。" },
                                { effect: "消耗MP: 13, 持續時間: 196秒, 防禦力: 22", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級11效果：消耗MP13，持續196秒，防禦力22。" },
                                { effect: "消耗MP: 13, 持續時間: 210秒, 防禦力: 24", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級12效果：消耗MP13，持續210秒，防禦力24。" },
                                { effect: "消耗MP: 13, 持續時間: 224秒, 防禦力: 26", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級13效果：消耗MP13，持續224秒，防禦力26。" },
                                { effect: "消耗MP: 13, 持續時間: 238秒, 防禦力: 28", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級14效果：消耗MP13，持續238秒，防禦力28。" },
                                { effect: "消耗MP: 13, 持續時間: 252秒, 防禦力: 30", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級15效果：消耗MP13，持續252秒，防禦力30。" },
                                { effect: "消耗MP: 16, 持續時間: 260秒, 防禦力: 32", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級16效果：消耗MP16，持續260秒，防禦力32。" },
                                { effect: "消耗MP: 16, 持續時間: 270秒, 防禦力: 34", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級17效果：消耗MP16，持續270秒，防禦力34。" },
                                { effect: "消耗MP: 16, 持續時間: 280秒, 防禦力: 36", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級18效果：消耗MP16，持續280秒，防禦力36。" },
                                { effect: "消耗MP: 16, 持續時間: 290秒, 防禦力: 38", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級19效果：消耗MP16，持續290秒，防禦力38。" },
                                { effect: "消耗MP: 16, 持續時間: 300秒，防禦力: 40", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級20效果：消耗MP16，持續300秒，防禦力40。" }
                            ]
                        },
                        {
                            id: "magicArrow", name: "魔靈彈", maxLevel: 20, requiredLevel: 10, preRequisite: {}, description: "消耗MP來攻擊單一個怪物。", imageUrl: "images/magicArrow.png",
                            levels: [
                                null,
                                { effect: "消耗MP: 6, 攻擊力: 20, 熟練度: 15%", fullDescription: "消耗MP來攻擊單一個怪物。等級1效果：消耗MP6，攻擊力20，熟練度15%。" },
                                { effect: "消耗MP: 6, 攻擊力: 21, 熟練度: 15%", fullDescription: "消耗MP來攻擊單一個怪物。等級2效果：消耗MP6，攻擊力21，熟練度15%。" },
                                { effect: "消耗MP: 6, 攻擊力: 22, 熟練度: 20%", fullDescription: "消耗MP來攻擊單一個怪物。等級3效果：消耗MP6，攻擊力22，熟練度20%。" },
                                { effect: "消耗MP: 6, 攻擊力: 23, 熟練度: 20%", fullDescription: "消耗MP來攻擊單一個怪物。等級4效果：消耗MP6，攻擊力23，熟練度20%。" },
                                { effect: "消耗MP: 6, 攻擊力: 24, 熟練度: 25%", fullDescription: "消耗MP來攻擊單一個怪物。等級5效果：消耗MP6，攻擊力24，熟練度25%。" },
                                { effect: "消耗MP: 6, 攻擊力: 25, 熟練度: 25%", fullDescription: "消耗MP來攻擊單一個怪物。等級6效果：消耗MP6，攻擊力25，熟練度25%。" },
                                { effect: "消耗MP: 6, 攻擊力: 26, 熟練度: 30%", fullDescription: "消耗MP來攻擊單一個怪物。等級7效果：消耗MP6，攻擊力26，熟練度30%。" },
                                { effect: "消耗MP: 6, 攻擊力: 27, 熟練度: 30%", fullDescription: "消耗MP來攻擊單一個怪物。等級8效果：消耗MP6，攻擊力27，熟練度30%。" },
                                { effect: "消耗MP: 6, 攻擊力: 28, 熟練度: 35%", fullDescription: "消耗MP來攻擊單一個怪物。等級9效果：消耗MP6，攻擊力28，熟練度35%。" },
                                { effect: "消耗MP: 6, 攻擊力: 29, 熟練度: 35%", fullDescription: "消耗MP來攻擊單一個怪物。等級10效果：消耗MP6，攻擊力29，熟練度35%。" },
                                { effect: "消耗MP: 14, 攻擊力: 30, 熟練度: 40%", fullDescription: "消耗MP來攻擊單一個怪物。等級11效果：消耗MP14，攻擊力30，熟練度40%。" },
                                { effect: "消耗MP: 14, 攻擊力: 31, 熟練度: 40%", fullDescription: "消耗MP來攻擊單一個怪物。等級12效果：消耗MP14，攻擊力31，熟練度40%。" },
                                { effect: "消耗MP: 14, 攻擊力: 32, 熟練度: 45%", fullDescription: "消耗MP來攻擊單一個怪物。等級13效果：消耗MP14，攻擊力32，熟練度45%。" },
                                { effect: "消耗MP: 14, 攻擊力: 33, 熟練度: 45%", fullDescription: "消耗MP來攻擊單一個怪物。等級14效果：消耗MP14，攻擊力33，熟練度45%。" },
                                { effect: "消耗MP: 14, 攻擊力: 34, 熟練度: 50%", fullDescription: "消耗MP來攻擊單一個怪物。等級15效果：消耗MP14，攻擊力34，熟練度50%。" },
                                { effect: "消耗MP: 14, 攻擊力: 35, 熟練度: 50%", fullDescription: "消耗MP來攻擊單一個怪物。等級16效果：消耗MP14，攻擊力35，熟練度50%。" },
                                { effect: "消耗MP: 14, 攻擊力: 36, 熟練度: 55%", fullDescription: "消耗MP來攻擊單一個怪物。等級17效果：消耗MP14，攻擊力36，熟練度55%。" },
                                { effect: "消耗MP: 14, 攻擊力: 37, 熟練度: 55%", fullDescription: "消耗MP來攻擊單一個怪物。等級18效果：消耗MP14，攻擊力37，熟練度55%。" },
                                { effect: "消耗MP: 14, 攻擊力: 38, 熟練度: 60%", fullDescription: "消耗MP來攻擊單一個怪物。等級19效果：消耗MP14，攻擊力38，熟練度60%。" },
                                { effect: "消耗MP: 14, 攻擊力: 39, 熟練度: 60%", fullDescription: "消耗MP來攻擊單一個怪物。等級20效果：消耗MP14，攻擊力39，熟練度60%。" }
                            ]
                        },
                        {
                            id: "magicClaw", name: "魔力爪", maxLevel: 20, requiredLevel: 10, preRequisite: { "magicArrow": 1 }, description: "消耗MP來對同一個怪物發動兩次的連續攻擊。", imageUrl: "images/magicClaw.png",
                            levels: [
                                null,
                                { effect: "消耗MP: 10, 攻擊力: 11, 熟練度: 15%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級1效果：消耗MP10，攻擊力11，熟練度15%。" },
                                { effect: "消耗MP: 10, 攻擊力: 12, 熟練度: 15%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級2效果：消耗MP10，攻擊力12，熟練度15%。" },
                                { effect: "消耗MP: 10, 攻擊力: 13, 熟練度: 20%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級3效果：消耗MP10，攻擊力13，熟練度20%。" },
                                { effect: "消耗MP: 10, 攻擊力: 14, 熟練度: 20%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級4效果：消耗MP10，攻擊力14，熟練度20%。" },
                                { effect: "消耗MP: 10, 攻擊力: 15, 熟練度: 25%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級5效果：消耗MP10，攻擊力15，熟練度25%。" },
                                { effect: "消耗MP: 10, 攻擊力: 16, 熟練度: 25%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級6效果：消耗MP10，攻擊力16，熟練度25%。" },
                                { effect: "消耗MP: 10, 攻擊力: 17, 熟練度: 30%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級7效果：消耗MP10，攻擊力17，熟練度30%。" },
                                { effect: "消耗MP: 10, 攻擊力: 18, 熟練度: 30%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級8效果：消耗MP10，攻擊力18，熟練度30%。" },
                                { effect: "消耗MP: 10, 攻擊力: 19, 熟練度: 35%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級9效果：消耗MP10，攻擊力19，熟練度35%。" },
                                { effect: "消耗MP: 10, 攻擊力: 20, 熟練度: 35%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級10效果：消耗MP10，攻擊力20，熟練度35%。" },
                                { effect: "消耗MP: 20, 攻擊力: 22, 熟練度: 40%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級11效果：消耗MP20，攻擊力22，熟練度40%。" },
                                { effect: "消耗MP: 20, 攻擊力: 24, 熟練度: 40%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級12效果：消耗MP20，攻擊力24，熟練度40%。" },
                                { effect: "消耗MP: 20, 攻擊力: 26, 熟練度: 45%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級13效果：消耗MP20，攻擊力26，熟練度45%。" },
                                { effect: "消耗MP: 20, 攻擊力: 28, 熟練度: 45%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級14效果：消耗MP20，攻擊力28，熟練度45%。" },
                                { effect: "消耗MP: 20, 攻擊力: 30, 熟練度: 50%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級15效果：消耗MP20，攻擊力30，熟練度50%。" },
                                { effect: "消耗MP: 20, 攻擊力: 32, 熟練度: 50%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級16效果：消耗MP20，攻擊力32，熟練度50%。" },
                                { effect: "消耗MP: 20, 攻擊力: 34, 熟練度: 55%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級17效果：消耗MP20，攻擊力34，熟練度55%。" },
                                { effect: "消耗MP: 20, 攻擊力: 36, 熟練度: 55%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級18效果：消耗MP20，攻擊力36，熟練度55%。" },
                                { effect: "消耗MP: 20, 攻擊力: 38, 熟練度: 60%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級19效果：消耗MP20，攻擊力38，熟練度60%。" },
                                { effect: "消耗MP: 20, 攻擊力: 40, 熟練度: 60%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級20效果：消耗MP20，攻擊力40，熟練度60%。" }
                            ]
                        }
                    ],
                    "2轉 (僧侶)": [
                        {
                            id: "magicDrain",
                            name: "魔力吸收",
                            maxLevel: 20,
                            requiredLevel: 30,
                            preRequisite: {},
                            description: "每次向敵人施展魔法攻擊時，依比例率吸收對方的MP直到敵人的MP為0。",
                            imageUrl: "images/magicDrain.png",
                            levels: Array(21).fill(null).map((_, i) => i === 0 ? null : {
                                effect: `發動率: ${10 + i}%, 吸收率: ${20 + i}%`,
                                fullDescription: `每次向敵人施展魔法攻擊時，依比例率吸收對方的MP直到敵人的MP為0。等級${i}效果：發動率${10 + i}%，吸收率${20 + i}%。`
                            })
                        },
                        {
                            id: "teleport",
                            name: "瞬間移動",
                            maxLevel: 20,
                            requiredLevel: 30,
                            preRequisite: {},
                            description: "利用魔法在一定的範圍內瞬間移動到指定位置，但若指定位置必須要有立足點。",
                            imageUrl: "images/teleport.png",
                            levels: Array(21).fill(null).map((_, i) => {
                                const mp = i <= 10 ? 60 - (i - 1) * 3 : 33 - (i - 11) * 2;
                                const dist = i <= 10 ? 130 : 130 + (i - 10) * 2;
                                return i === 0 ? null : {
                                    effect: `消耗MP: ${mp}, 移動距離: ${dist}`,
                                    fullDescription: `利用魔法在一定的範圍內瞬間移動到指定位置，但若指定位置必須要有立足點。等級${i}效果：消耗MP${mp}，移動距離${dist}。`
                                };
                            })
                        },
                        {
                            id: "holyLight",
                            name: "神聖之光",
                            maxLevel: 20,
                            requiredLevel: 30,
                            preRequisite: { "massHeal": 5 },
                            description: "在一定時間內，降低自己所受到物理攻擊傷害，但不包含魔法攻擊。",
                            imageUrl: "images/holyLight.png",
                            levels: Array(21).fill(null).map((_, i) => {
                                const mp = i <= 10 ? 15 : 30;
                                return i === 0 ? null : {
                                    effect: `消耗MP: ${mp}, 持續時間: ${i * 15}秒, 減輕傷害: ${10 + i}%`,
                                    fullDescription: `在一定時間內，降低自己所受到物理攻擊傷害，但不包含魔法攻擊。等級${i}效果：消耗MP${mp}，持續${i * 15}秒，減輕傷害${10 + i}%。`
                                };
                            })
                        },
                        {
                            id: "angelBlessing",
                            name: "天使祝福",
                            maxLevel: 20,
                            requiredLevel: 30,
                            preRequisite: { "holyLight": 5 },
                            description: "在一定時間內，提高周圍隊員的物理防禦、魔法防禦、命中率與迴避率，但不能與其他技能或各種藥水一起使用。",
                            imageUrl: "images/angelBlessing.png",
                            levels: [
                                null,
                                { effect: "消耗MP: 12, 持續時間: 10秒, 各能力值: 1", fullDescription: "在一定時間內，提高周圍隊員的物理防禦、魔法防禦、命中率與迴避率，但不能與其他技能或各種藥水一起使用。等級1效果：消耗MP12，持續10秒，各能力值1。" },
                                { effect: "消耗MP: 12, 持續時間: 20秒, 各能力值: 2", fullDescription: "在一定時間內，提高周圍隊員的物理防禦、魔法防禦、命中率與迴避率，但不能與其他技能或各種藥水一起使用。等級2效果：消耗MP12，持續20秒，各能力值2。" },
                                { effect: "消耗MP: 12, 持續時間: 30秒, 各能力值: 3", fullDescription: "在一定時間內，提高周圍隊員的物理防禦、魔法防禦、命中率與迴避率，但不能與其他技能或各種藥水一起使用。等級3效果：消耗MP12，持續30秒，各能力值3。" },
                                { effect: "消耗MP: 12, 持續時間: 40秒, 各能力值: 4", fullDescription: "在一定時間內，提高周圍隊員的物理防禦、魔法防禦、命中率與迴避率，但不能與其他技能或各種藥水一起使用。等級4效果：消耗MP12，持續40秒，各能力值4。" },
                                { effect: "消耗MP: 12, 持續時間: 50秒, 各能力值: 5", fullDescription: "在一定時間內，提高周圍隊員的物理防禦、魔法防禦、命中率與迴避率，但不能與其他技能或各種藥水一起使用。等級5效果：消耗MP12，持續50秒，各能力值5。" },
                                { effect: "消耗MP: 12, 持續時間: 60秒, 各能力值: 6", fullDescription: "在一定時間內，提高周圍隊員的物理防禦、魔法防禦、命中率與迴避率，但不能與其他技能或各種藥水一起使用。等級6效果：消耗MP12，持續60秒，各能力值6。" },
                                { effect: "消耗MP: 12, 持續時間: 70秒, 各能力值: 7", fullDescription: "在一定時間內，提高周圍隊員的物理防禦、魔法防禦、命中率與迴避率，但不能與其他技能或各種藥水一起使用。等級7效果：消耗MP12，持續70秒，各能力值7。" },
                                { effect: "消耗MP: 12, 持續時間: 80秒, 各能力值: 8", fullDescription: "在一定時間內，提高周圍隊員的物理防禦、魔法防禦、命中率與迴避率，但不能與其他技能或各種藥水一起使用。等級8效果：消耗MP12，持續80秒，各能力值8。" },
                                { effect: "消耗MP: 12, 持續時間: 90秒, 各能力值: 9", fullDescription: "在一定時間內，提高周圍隊員的物理防禦、魔法防禦、命中率與迴避率，但不能與其他技能或各種藥水一起使用。等級9效果：消耗MP12，持續90秒，各能力值9。" },
                                { effect: "消耗MP: 12, 持續時間: 100秒, 各能力值: 10", fullDescription: "在一定時間內，提高周圍隊員的物理防禦、魔法防禦、命中率與迴避率，但不能與其他技能或各種藥水一起使用。等級10效果：消耗MP12，持續100秒，各能力值10。" },
                                { effect: "消耗MP: 24, 持續時間: 120秒, 各能力值: 11", fullDescription: "在一定時間內，提高周圍隊員的物理防禦、魔法防禦、命中率與迴避率，但不能與其他技能或各種藥水一起使用。等級11效果：消耗MP24，持續120秒，各能力值11。" },
                                { effect: "消耗MP: 24, 持續時間: 140秒, 各能力值: 12", fullDescription: "在一定時間內，提高周圍隊員的物理防禦、魔法防禦、命中率與迴避率，但不能與其他技能或各種藥水一起使用。等級12效果：消耗MP24，持續140秒，各能力值12。" },
                                { effect: "消耗MP: 24, 持續時間: 160秒, 各能力值: 13", fullDescription: "在一定時間內，提高周圍隊員的物理防禦、魔法防禦、命中率與迴避率，但不能與其他技能或各種藥水一起使用。等級13效果：消耗MP24，持續160秒，各能力值13。" },
                                { effect: "消耗MP: 24, 持續時間: 180秒, 各能力值: 14", fullDescription: "在一定時間內，提高周圍隊員的物理防禦、魔法防禦、命中率與迴避率，但不能與其他技能或各種藥水一起使用。等級14效果：消耗MP24，持續180秒，各能力值14。" },
                                { effect: "消耗MP: 24, 持續時間: 200秒, 各能力值: 15", fullDescription: "在一定時間內，提高周圍隊員的物理防禦、魔法防禦、命中率與迴避率，但不能與其他技能或各種藥水一起使用。等級15效果：消耗MP24，持續200秒，各能力值15。" },
                                { effect: "消耗MP: 24, 持續時間: 220秒, 各能力值: 16", fullDescription: "在一定時間內，提高周圍隊員的物理防禦、魔法防禦、命中率與迴避率，但不能與其他技能或各種藥水一起使用。等級16效果：消耗MP24，持續220秒，各能力值16。" },
                                { effect: "消耗MP: 24, 持續時間: 240秒, 各能力值: 17", fullDescription: "在一定時間內，提高周圍隊員的物理防禦、魔法防禦、命中率與迴避率，但不能與其他技能或各種藥水一起使用。等級17效果：消耗MP24，持續240秒，各能力值17。" },
                                { effect: "消耗MP: 24, 持續時間: 260秒, 各能力值: 18", fullDescription: "在一定時間內，提高周圍隊員的物理防禦、魔法防禦、命中率與迴避率，但不能與其他技能或各種藥水一起使用。等級18效果：消耗MP24，持續260秒，各能力值18。" },
                                { effect: "消耗MP: 24, 持續時間: 280秒, 各能力值: 19", fullDescription: "在一定時間內，提高周圍隊員的物理防禦、魔法防禦、命中率與迴避率，但不能與其他技能或各種藥水一起使用。等級19效果：消耗MP24，持續280秒，各能力值19。" },
                                { effect: "消耗MP: 24, 持續時間: 300秒，各能力值: 20", fullDescription: "在一定時間內，提高周圍隊員的物理防禦、魔法防禦、命中率與迴避率，但不能與其他技能或各種藥水一起使用。等級20效果：消耗MP24，持續300秒，各能力值20。" }
                            ]
                        },
                        {
                            id: "massHeal",
                            name: "群體治癒",
                            maxLevel: 30,
                            requiredLevel: 30,
                            preRequisite: {},
                            description: "恢復範圍內所有隊員的HP並對群體黑暗屬性怪物可造成損傷（最多6名敵人）。",
                            imageUrl: "images/massHeal.png",
                            levels: Array(31).fill(null).map((_, i) => {
                                const mp = i <= 15 ? 12 : 24;
                                return i === 0 ? null : {
                                    effect: `消耗MP: ${mp}, 回復量: ${i * 10}%`,
                                    fullDescription: `恢復範圍內所有隊員的HP並對群體黑暗屬性怪物可造成損傷（最多6名敵人）。等級${i}效果：消耗MP${mp}，回復量${i * 10}%。`
                                };
                            })
                        },
                        {
                            id: "holyArrow",
                            name: "神聖之箭",
                            maxLevel: 30,
                            requiredLevel: 30,
                            preRequisite: {},
                            description: "召喚聖箭，向單一敵人發動攻擊，對不死系怪物或惡魔系怪物，會造成更大的損害。",
                            imageUrl: "images/holyArrow.png",
                            levels: Array(31).fill(null).map((_, i) => {
                                const mp = i <= 15 ? 12 : 24;
                                // 攻擊力數據有跳變，需分段處理
                                let attack;
                                if (i === 1) attack = 13;
                                else if (i === 2) attack = 24;
                                else if (i === 3) attack = 26;
                                else if (i === 4) attack = 28;
                                else if (i === 5) attack = 30;
                                else if (i === 6) attack = 32;
                                else if (i === 7) attack = 34;
                                else if (i === 8) attack = 36;
                                else if (i === 9) attack = 38;
                                else if (i === 10) attack = 40;
                                else if (i === 11) attack = 42;
                                else if (i === 12) attack = 44;
                                else if (i === 13) attack = 46;
                                else if (i === 14) attack = 48;
                                else if (i === 15) attack = 50;
                                else if (i === 16) attack = 52;
                                else if (i === 17) attack = 54;
                                else if (i === 18) attack = 56;
                                else if (i === 19) attack = 58;
                                else if (i === 20) attack = 60;
                                else if (i === 21) attack = 62;
                                else if (i === 22) attack = 64;
                                else if (i === 23) attack = 66;
                                else if (i === 24) attack = 68;
                                else if (i === 25) attack = 70;
                                else if (i === 26) attack = 72;
                                else if (i === 27) attack = 74;
                                else if (i === 28) attack = 76;
                                else if (i === 29) attack = 78;
                                else if (i === 30) attack = 80;
                                else attack = 0; // Default for unexpected values

                                const mastery = 15 + Math.floor((i - 1) / 3) * 5;
                                return i === 0 ? null : {
                                    effect: `消耗MP: ${mp}, 攻擊力: ${attack}, 熟練度: ${mastery}%`,
                                    fullDescription: `召喚聖箭，向單一敵人發動攻擊，對不死系怪物或惡魔系怪物，會造成更大的損害。等級${i}效果：消耗MP${mp}，攻擊力${attack}，熟練度${mastery}%。`
                                };
                            })
                        }
                    ],
                    "3轉 (祭司)": [
                        {
                            id: "summonHolyDragon",
                            name: "聖龍召喚",
                            maxLevel: 30,
                            requiredLevel: 70,
                            preRequisite: {},
                            description: "消耗召喚石在一定時間內，召喚出聖龍守護在主人身邊，並對敵人發動攻擊。技能等級越高時，可以召喚攻擊力更強的聖龍。",
                            imageUrl: "images/summonHolyDragon.png",
                            levels: Array(31).fill(null).map((_, i) => {
                                let mp, duration, attack;
                                if (i === 0) return null;
                                const mpCosts = [null, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80];
                                const durations = [null, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 84, 88, 92, 96, 100, 104, 108, 112, 116, 120, 124, 128, 132, 136, 140];
                                const attacks = [null, 64, 68, 72, 76, 80, 84, 88, 92, 96, 100, 104, 108, 112, 116, 120, 122, 124, 126, 128, 130, 132, 134, 136, 138, 140, 142, 144, 146, 148, 150];
                                mp = mpCosts[i];
                                duration = durations[i];
                                attack = attacks[i];
                                return {
                                    effect: `消耗MP: ${mp}, 持續時間: ${duration}秒, 攻擊力: ${attack}`,
                                    fullDescription: `消耗召喚石在一定時間內，召喚出聖龍守護在主人身邊，並對敵人發動攻擊。等級${i}效果：消耗MP${mp}，持續${duration}秒，攻擊力${attack}。`
                                };
                            })
                        },
                        {
                            id: "magicResistance",
                            name: "魔法抵抗",
                            maxLevel: 20,
                            requiredLevel: 70,
                            preRequisite: {},
                            description: "提高對所有性魔法攻擊的抗性。",
                            imageUrl: "images/magicResistance.png",
                            levels: Array(21).fill(null).map((_, i) => i === 0 ? null : {
                                effect: `抗性增加: ${10 + i * 2}%`,
                                fullDescription: `提高對所有性魔法攻擊的抗性。等級${i}效果：抗性增加${10 + i * 2}%。`
                            })
                        },
                        {
                            id: "dispel",
                            name: "淨化",
                            maxLevel: 20,
                            requiredLevel: 70,
                            preRequisite: {},
                            description: "一定範圍內使怪物的魔法效果無效，同時解除自己及周圍隊友的異常狀態。",
                            imageUrl: "images/dispel.png",
                            levels: Array(21).fill(null).map((_, i) => {
                                const mp = i <= 10 ? 15 : 20;
                                return i === 0 ? null : {
                                    effect: `消耗MP: ${mp}, 成功率: ${30 + i * 4}%, 施法範圍: ${100 + i * 10}%`,
                                    fullDescription: `一定範圍內使怪物的魔法效果無效，同時解除自己及周圍隊友的異常狀態。等級${i}效果：消耗MP${mp}，成功率${30 + i * 4}%，施法範圍${100 + i * 10}%。`
                                };
                            })
                        },
                        {
                            id: "monsterTransformation",
                            name: "喚化術",
                            maxLevel: 30,
                            requiredLevel: 70,
                            preRequisite: {},
                            description: "對多名敵方施加蝸牛詛咒，降低其魔法攻擊力及移動速度，BOSS無效。最多可使6隻怪物受到詛咒。",
                            imageUrl: "images/monsterTransformation.png",
                            levels: [
                                null,
                                { effect: "消耗MP: 8, 持續時間: 10秒, 移動速度降低: -31, 魔法攻擊力降低: -15", fullDescription: "對多名敵方施加蝸牛詛咒，降低其魔法攻擊力及移動速度，BOSS無效。等級1效果：消耗MP8，持續10秒，移動速度降低-31，魔法攻擊力降低-15。" }
                                // 等級2-30，數據未提供，將顯示通用提示
                            ].concat(Array(29).fill({ effect: "無此等級效果資料", fullDescription: "數據缺失或無法精確計算此等級效果。" }))
                        },
                        {
                            id: "mysticDoor",
                            name: "時空門",
                            maxLevel: 20,
                            requiredLevel: 70,
                            preRequisite: { "dispel": 3 },
                            description: "消耗魔法石創造出通往最近村莊的時空門，在時空門消失前，自已以及隊友可進入時空門回到村莊。",
                            imageUrl: "images/mysticDoor.png",
                            levels: Array(21).fill(null).map((_, i) => {
                                let mp, duration;
                                if (i === 0) return null;
                                const mpCosts = [null, 80, 77, 74, 71, 68, 65, 62, 59, 56, 53, 51, 49, 47, 45, 43, 41, 39, 37, 35, 33];
                                const durations = [null, 30, 40, 50, 60, 70, 80, 90, 100, 110, 126, 126, 132, 138, 144, 150, 156, 162, 168, 174, 180];
                                mp = mpCosts[i];
                                duration = durations[i];
                                return {
                                    effect: `消耗MP: ${mp}, 持續時間: ${duration}秒`,
                                    fullDescription: `消耗魔法石創造出通往最近村莊的時空門，在時空門消失前，自已以及隊友可進入時空門回到村莊。等級${i}效果：消耗MP${mp}，持續${duration}秒。`
                                };
                            })
                        },
                        {
                            id: "holySymbol",
                            name: "神聖祈禱",
                            maxLevel: 30,
                            requiredLevel: 70,
                            preRequisite: { "dispel": 3 },
                            description: "在一定的時間內，組隊獵殺怪物時，可獲得更多的經驗值。只有在兩人以上的組隊狀態下，才能發揮100%效果。",
                            imageUrl: "images/holySymbol.png",
                            levels: Array(31).fill(null).map((_, i) => {
                                let mp, duration, expBonus;
                                if (i === 0) return null;
                                const mpCosts = [null, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80];
                                const durations = [null, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300];
                                const expBonuses = [null, 102, 104, 106, 108, 110, 112, 114, 116, 118, 120, 122, 124, 126, 128, 130, 132, 134, 136, 138, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150];
                                mp = mpCosts[i];
                                duration = durations[i];
                                expBonus = expBonuses[i];
                                return {
                                    effect: `消耗MP: ${mp}, 持續時間: ${duration}秒, 經驗值: ${expBonus}%`,
                                    fullDescription: `在一定的時間內，組隊獵殺怪物時，可獲得更多的經驗值。等級${i}效果：消耗MP${mp}，持續${duration}秒，經驗值${expBonus}%。`
                                };
                            })
                        },
                        {
                            id: "shiningRay",
                            name: "聖光",
                            maxLevel: 30,
                            requiredLevel: 70,
                            preRequisite: {},
                            description: "利用神聖的光芒攻擊周圍的敵人。對不死系與魔族怪物，可造成更大的損害。",
                            imageUrl: "images/shiningRay.png",
                            levels: Array(31).fill(null).map((_, i) => {
                                let mp, attack, mastery;
                                if (i === 0) return null;
                                const mpCosts = [null, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50];
                                const attacks = [null, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118];
                                const masteries = [null, 15, 15, 15, 20, 20, 20, 25, 25, 25, 30, 30, 30, 35, 35, 35, 40, 40, 40, 45, 45, 45, 50, 50, 50, 55, 55, 55, 60, 60, 60];
                                mp = mpCosts[i];
                                attack = attacks[i];
                                mastery = masteries[i];
                                return {
                                    effect: `消耗MP: ${mp}, 攻擊力: ${attack}, 熟練度: ${mastery}%`,
                                    fullDescription: `利用神聖的光芒攻擊周圍的敵人。等級${i}效果：消耗MP${mp}，攻擊力${attack}，熟練度${mastery}%。`
                                };
                            })
                        }
                    ],
                    "4轉 (主教)": [],
                    "超技能": [],
                    "5轉技能": [],
                    "共通技能": []
                }
            },
            "火毒大魔導 (Arch Mage F/P)": {
                startingLevelForSp: 8,
                jobAdvancementSpBonuses: [8, 30, 70, 120], // 轉職額外SP的等級點
                jobStagesOrder: ["0轉 (新手)", "1轉 (魔法師)", "2轉 (火毒巫師)", "3轉 (火毒魔導士)", "4轉 (烈焰巫師)", "超技能", "5轉技能", "共通技能"], // 定義轉職階段的順序
                spRequiredFor2ndJob: 67, // 法師2轉點數需求
                spRequiredFor3rdJob: 188, // 法師3轉點數需求
                spRequiredFor4thJob: 255, // 4轉通用點數需求
                skills: {
                    "0轉 (新手)": [],
                    "1轉 (魔法師)": [
                        {
                            id: "magicPurify",
                            name: "魔力淨化",
                            maxLevel: 16,
                            requiredLevel: 10,
                            preRequisite: {},
                            description: "每10秒鐘可恢復更多量的MP。",
                            imageUrl: "images/magicPurify.png",
                            levels: Array(17).fill(null).map((_, i) => i === 0 ? null : {
                                effect: `${(0.1 * i).toFixed(1)}x角色等級+3 MP回復量`,
                                fullDescription: `每10秒鐘可恢復更多量的MP。回復量公式：${(0.1 * i).toFixed(1)}x角色等級+3`
                            })
                        },
                        {
                            id: "magicExtension",
                            name: "魔力擴展",
                            maxLevel: 10,
                            requiredLevel: 10,
                            preRequisite: { "magicPurify": 5 },
                            description: "當等級提升時，增加MP的最大追加量。",
                            imageUrl: "images/magicExtension.png",
                            levels: Array(11).fill(null).map((_, i) => i === 0 ? null : {
                                effect: `升級追加量: ${2 * i}`,
                                fullDescription: `當等級提升時，增加MP的最大追加量。等級${i}效果：升級追加量${2 * i}。`
                            })
                        },
                        {
                            id: "magicGuard",
                            name: "魔心防禦",
                            maxLevel: 20,
                            requiredLevel: 10,
                            preRequisite: {},
                            description: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。但若MP達到0時，則直接消耗HP。",
                            imageUrl: "images/magicGuard.png",
                            levels: [
                                null,
                                { effect: "消耗MP: 6, 持續時間: 170秒, 替代率: 23%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級1效果：消耗MP6，持續170秒，替代率23%。" },
                                { effect: "消耗MP: 6, 持續時間: 180秒, 替代率: 26%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級2效果：消耗MP6，持續180秒，替代率26%。" },
                                { effect: "消耗MP: 6, 持續時間: 190秒, 替代率: 29%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級3效果：消耗MP6，持續190秒，替代率29%。" },
                                { effect: "消耗MP: 6, 持續時間: 200秒, 替代率: 32%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級4效果：消耗MP6，持續200秒，替代率32%。" },
                                { effect: "消耗MP: 6, 持續時間: 210秒, 替代率: 35%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級5效果：消耗MP6，持續210秒，替代率35%。" },
                                { effect: "消耗MP: 6, 持續時間: 220秒, 替代率: 38%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級6效果：消耗MP6，持續220秒，替代率38%。" },
                                { effect: "消耗MP: 6, 持續時間: 230秒, 替代率: 41%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級7效果：消耗MP6，持續230秒，替代率41%。" },
                                { effect: "消耗MP: 6, 持續時間: 240秒, 替代率: 44%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級8效果：消耗MP6，持續240秒，替代率44%。" },
                                { effect: "消耗MP: 6, 持續時間: 250秒, 替代率: 47%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級9效果：消耗MP6，持續250秒，替代率47%。" },
                                { effect: "消耗MP: 6, 持續時間: 260秒, 替代率: 50%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級10效果：消耗MP6，持續260秒，替代率50%。" },
                                { effect: "消耗MP: 12, 持續時間: 270秒, 替代率: 53%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級11效果：消耗MP12，持續270秒，替代率53%。" },
                                { effect: "消耗MP: 12, 持續時間: 280秒, 替代率: 56%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級12效果：消耗MP12，持續280秒，替代率56%。" },
                                { effect: "消耗MP: 12, 持續時間: 290秒, 替代率: 59%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級13效果：消耗MP12，持續290秒，替代率59%。" },
                                { effect: "消耗MP: 12, 持續時間: 300秒, 替代率: 62%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級14效果：消耗MP12，持續300秒，替代率62%。" },
                                { effect: "消耗MP: 12, 持續時間: 310秒, 替代率: 65%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級15效果：消耗MP12，持續310秒，替代率65%。" },
                                { effect: "消耗MP: 12, 持續時間: 320秒, 替代率: 68%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級16效果：消耗MP12，持續320秒，替代率68%。" },
                                { effect: "消耗MP: 12, 持續時間: 330秒, 替代率: 71%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級17效果：消耗MP12，持續330秒，替代率71%。" },
                                { effect: "消耗MP: 12, 持續時間: 340秒, 替代率: 74%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級18效果：消耗MP12，持續340秒，替代率74%。" },
                                { effect: "消耗MP: 12, 持續時間: 350秒, 替代率: 77%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級19效果：消耗MP12，持續350秒，替代率77%。" },
                                { effect: "消耗MP: 12, 持續時間: 360秒，替代率: 80%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級20效果：消耗MP12，持續360秒，替代率80%。" }]
                        },
                        {
                            id: "magicShield", name: "魔力之盾", maxLevel: 20, requiredLevel: 10, preRequisite: { "magicGuard": 3 }, description: "一定時間內把魔力集中在盔甲上，提高物理防禦力。", imageUrl: "images/magicShield.png",
                            levels: [
                                null,
                                { effect: "消耗MP: 8, 持續時間: 20秒, 防禦力: 2", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級1效果：消耗MP8，持續20秒，防禦力2。" },
                                { effect: "消耗MP: 8, 持續時間: 40秒, 防禦力: 4", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級2效果：消耗MP8，持續40秒，防禦力4。" },
                                { effect: "消耗MP: 8, 持續時間: 60秒, 防禦力: 6", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級3效果：消耗MP8，持續60秒，防禦力6。" },
                                { effect: "消耗MP: 8, 持續時間: 80秒, 防禦力: 8", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級4效果：消耗MP8，持續80秒，防禦力8。" },
                                { effect: "消耗MP: 8, 持續時間: 100秒, 防禦力: 10", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級5效果：消耗MP8，持續100秒，防禦力10。" },
                                { effect: "消耗MP: 8, 持續時間: 120秒, 防禦力: 12", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級6效果：消耗MP8，持續120秒，防禦力12。" },
                                { effect: "消耗MP: 8, 持續時間: 140秒, 防禦力: 14", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級7效果：消耗MP8，持續140秒，防禦力14。" },
                                { effect: "消耗MP: 8, 持續時間: 160秒, 防禦力: 16", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級8效果：消耗MP8，持續160秒，防禦力16。" },
                                { effect: "消耗MP: 8, 持續時間: 180秒, 防禦力: 18", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級9效果：消耗MP8，持續180秒，防禦力18。" },
                                { effect: "消耗MP: 8, 持續時間: 200秒, 防禦力: 20", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級10效果：消耗MP8，持續200秒，防禦力20。" },
                                { effect: "消耗MP: 13, 持續時間: 196秒, 防禦力: 22", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級11效果：消耗MP13，持續196秒，防禦力22。" },
                                { effect: "消耗MP: 13, 持續時間: 210秒, 防禦力: 24", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級12效果：消耗MP13，持續210秒，防禦力24。" },
                                { effect: "消耗MP: 13, 持續時間: 224秒, 防禦力: 26", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級13效果：消耗MP13，持續224秒，防禦力26。" },
                                { effect: "消耗MP: 13, 持續時間: 238秒, 防禦力: 28", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級14效果：消耗MP13，持續238秒，防禦力28。" },
                                { effect: "消耗MP: 13, 持續時間: 252秒, 防禦力: 30", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級15效果：消耗MP13，持續252秒，防禦力30。" },
                                { effect: "消耗MP: 16, 持續時間: 260秒, 防禦力: 32", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級16效果：消耗MP16，持續260秒，防禦力32。" },
                                { effect: "消耗MP: 16, 持續時間: 270秒, 防禦力: 34", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級17效果：消耗MP16，持續270秒，防禦力34。" },
                                { effect: "消耗MP: 16, 持續時間: 280秒, 防禦力: 36", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級18效果：消耗MP16，持續280秒，防禦力36。" },
                                { effect: "消耗MP: 16, 持續時間: 290秒, 防禦力: 38", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級19效果：消耗MP16，持續290秒，防禦力38。" },
                                { effect: "消耗MP: 16, 持續時間: 300秒，防禦力: 40", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級20效果：消耗MP16，持續300秒，防禦力40。" }
                            ]
                        },
                        {
                            id: "magicArrow", name: "魔靈彈", maxLevel: 20, requiredLevel: 10, preRequisite: {}, description: "消耗MP來攻擊單一個怪物。", imageUrl: "images/magicArrow.png",
                            levels: [
                                null,
                                { effect: "消耗MP: 6, 攻擊力: 20, 熟練度: 15%", fullDescription: "消耗MP來攻擊單一個怪物。等級1效果：消耗MP6，攻擊力20，熟練度15%。" },
                                { effect: "消耗MP: 6, 攻擊力: 21, 熟練度: 15%", fullDescription: "消耗MP來攻擊單一個怪物。等級2效果：消耗MP6，攻擊力21，熟練度15%。" },
                                { effect: "消耗MP: 6, 攻擊力: 22, 熟練度: 20%", fullDescription: "消耗MP來攻擊單一個怪物。等級3效果：消耗MP6，攻擊力22，熟練度20%。" },
                                { effect: "消耗MP: 6, 攻擊力: 23, 熟練度: 20%", fullDescription: "消耗MP來攻擊單一個怪物。等級4效果：消耗MP6，攻擊力23，熟練度20%。" },
                                { effect: "消耗MP: 6, 攻擊力: 24, 熟練度: 25%", fullDescription: "消耗MP來攻擊單一個怪物。等級5效果：消耗MP6，攻擊力24，熟練度25%。" },
                                { effect: "消耗MP: 6, 攻擊力: 25, 熟練度: 25%", fullDescription: "消耗MP來攻擊單一個怪物。等級6效果：消耗MP6，攻擊力25，熟練度25%。" },
                                { effect: "消耗MP: 6, 攻擊力: 26, 熟練度: 30%", fullDescription: "消耗MP來攻擊單一個怪物。等級7效果：消耗MP6，攻擊力26，熟練度30%。" },
                                { effect: "消耗MP: 6, 攻擊力: 27, 熟練度: 30%", fullDescription: "消耗MP來攻擊單一個怪物。等級8效果：消耗MP6，攻擊力27，熟練度30%。" },
                                { effect: "消耗MP: 6, 攻擊力: 28, 熟練度: 35%", fullDescription: "消耗MP來攻擊單一個怪物。等級9效果：消耗MP6，攻擊力28，熟練度35%。" },
                                { effect: "消耗MP: 6, 攻擊力: 29, 熟練度: 35%", fullDescription: "消耗MP來攻擊單一個怪物。等級10效果：消耗MP6，攻擊力29，熟練度35%。" },
                                { effect: "消耗MP: 14, 攻擊力: 30, 熟練度: 40%", fullDescription: "消耗MP來攻擊單一個怪物。等級11效果：消耗MP14，攻擊力30，熟練度40%。" },
                                { effect: "消耗MP: 14, 攻擊力: 31, 熟練度: 40%", fullDescription: "消耗MP來攻擊單一個怪物。等級12效果：消耗MP14，攻擊力31，熟練度40%。" },
                                { effect: "消耗MP: 14, 攻擊力: 32, 熟練度: 45%", fullDescription: "消耗MP來攻擊單一個怪物。等級13效果：消耗MP14，攻擊力32，熟練度45%。" },
                                { effect: "消耗MP: 14, 攻擊力: 33, 熟練度: 45%", fullDescription: "消耗MP來攻擊單一個怪物。等級14效果：消耗MP14，攻擊力33，熟練度45%。" },
                                { effect: "消耗MP: 14, 攻擊力: 34, 熟練度: 50%", fullDescription: "消耗MP來攻擊單一個怪物。等級15效果：消耗MP14，攻擊力34，熟練度50%。" },
                                { effect: "消耗MP: 14, 攻擊力: 35, 熟練度: 50%", fullDescription: "消耗MP來攻擊單一個怪物。等級16效果：消耗MP14，攻擊力35，熟練度50%。" },
                                { effect: "消耗MP: 14, 攻擊力: 36, 熟練度: 55%", fullDescription: "消耗MP來攻擊單一個怪物。等級17效果：消耗MP14，攻擊力36，熟練度55%。" },
                                { effect: "消耗MP: 14, 攻擊力: 37, 熟練度: 55%", fullDescription: "消耗MP來攻擊單一個怪物。等級18效果：消耗MP14，攻擊力37，熟練度55%。" },
                                { effect: "消耗MP: 14, 攻擊力: 38, 熟練度: 60%", fullDescription: "消耗MP來攻擊單一個怪物。等級19效果：消耗MP14，攻擊力38，熟練度60%。" },
                                { effect: "消耗MP: 14, 攻擊力: 39, 熟練度: 60%", fullDescription: "消耗MP來攻擊單一個怪物。等級20效果：消耗MP14，攻擊力39，熟練度60%。" }
                            ]
                        },
                        {
                            id: "magicClaw", name: "魔力爪", maxLevel: 20, requiredLevel: 10, preRequisite: { "magicArrow": 1 }, description: "消耗MP來對同一個怪物發動兩次的連續攻擊。", imageUrl: "images/magicClaw.png",
                            levels: [
                                null,
                                { effect: "消耗MP: 10, 攻擊力: 11, 熟練度: 15%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級1效果：消耗MP10，攻擊力11，熟練度15%。" },
                                { effect: "消耗MP: 10, 攻擊力: 12, 熟練度: 15%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級2效果：消耗MP10，攻擊力12，熟練度15%。" },
                                { effect: "消耗MP: 10, 攻擊力: 13, 熟練度: 20%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級3效果：消耗MP10，攻擊力13，熟練度20%。" },
                                { effect: "消耗MP: 10, 攻擊力: 14, 熟練度: 20%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級4效果：消耗MP10，攻擊力14，熟練度20%。" },
                                { effect: "消耗MP: 10, 攻擊力: 15, 熟練度: 25%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級5效果：消耗MP10，攻擊力15，熟練度25%。" },
                                { effect: "消耗MP: 10, 攻擊力: 16, 熟練度: 25%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級6效果：消耗MP10，攻擊力16，熟練度25%。" },
                                { effect: "消耗MP: 10, 攻擊力: 17, 熟練度: 30%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級7效果：消耗MP10，攻擊力17，熟練度30%。" },
                                { effect: "消耗MP: 10, 攻擊力: 18, 熟練度: 30%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級8效果：消耗MP10，攻擊力18，熟練度30%。" },
                                { effect: "消耗MP: 10, 攻擊力: 19, 熟練度: 35%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級9效果：消耗MP10，攻擊力19，熟練度35%。" },
                                { effect: "消耗MP: 10, 攻擊力: 20, 熟練度: 35%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級10效果：消耗MP10，攻擊力20，熟練度35%。" },
                                { effect: "消耗MP: 20, 攻擊力: 22, 熟練度: 40%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級11效果：消耗MP20，攻擊力22，熟練度40%。" },
                                { effect: "消耗MP: 20, 攻擊力: 24, 熟練度: 40%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級12效果：消耗MP20，攻擊力24，熟練度40%。" },
                                { effect: "消耗MP: 20, 攻擊力: 26, 熟練度: 45%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級13效果：消耗MP20，攻擊力26，熟練度45%。" },
                                { effect: "消耗MP: 20, 攻擊力: 28, 熟練度: 45%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級14效果：消耗MP20，攻擊力28，熟練度45%。" },
                                { effect: "消耗MP: 20, 攻擊力: 30, 熟練度: 50%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級15效果：消耗MP20，攻擊力30，熟練度50%。" },
                                { effect: "消耗MP: 20, 攻擊力: 32, 熟練度: 50%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級16效果：消耗MP20，攻擊力32，熟練度50%。" },
                                { effect: "消耗MP: 20, 攻擊力: 34, 熟練度: 55%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級17效果：消耗MP20，攻擊力34，熟練度55%。" },
                                { effect: "消耗MP: 20, 攻擊力: 36, 熟練度: 55%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級18效果：消耗MP20，攻擊力36，熟練度55%。" },
                                { effect: "消耗MP: 20, 攻擊力: 38, 熟練度: 60%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級19效果：消耗MP20，攻擊力38，熟練度60%。" },
                                { effect: "消耗MP: 20, 攻擊力: 40, 熟練度: 60%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級20效果：消耗MP20，攻擊力40，熟練度60%。" }
                            ]
                        }
                    ],
                    "2轉 (火毒巫師)": [
                        {
                            id: "magicDrain",
                            name: "魔力吸收",
                            maxLevel: 20,
                            requiredLevel: 30,
                            preRequisite: {},
                            description: "每次向敵人施展魔法攻擊時，依比例率吸收對方的MP直到敵人的MP為0。",
                            imageUrl: "images/magicDrain.png",
                            levels: Array(21).fill(null).map((_, i) => i === 0 ? null : {
                                effect: `發動率: ${10 + i}%, 吸收率: ${20 + i}%`,
                                fullDescription: `每次向敵人施展魔法攻擊時，依比例率吸收對方的MP直到敵人的MP為0。等級${i}效果：發動率${10 + i}%，吸收率${20 + i}%。`
                            })
                        },
                        {
                            id: "teleport",
                            name: "瞬間移動",
                            maxLevel: 20,
                            requiredLevel: 30,
                            preRequisite: {},
                            description: "利用魔法在一定的範圍內瞬間移動到指定位置，但若指定位置必須要有立足點。",
                            imageUrl: "images/teleport.png",
                            levels: Array(21).fill(null).map((_, i) => {
                                const mp = i <= 10 ? 60 - (i - 1) * 3 : 33 - (i - 11) * 2;
                                const dist = i <= 10 ? 130 : 130 + (i - 10) * 2;
                                return i === 0 ? null : {
                                    effect: `消耗MP: ${mp}, 移動距離: ${dist}`,
                                    fullDescription: `利用魔法在一定的範圍內瞬間移動到指定位置，但若指定位置必須要有立足點。等級${i}效果：消耗MP${mp}，移動距離${dist}。`
                                };
                            })
                        },
                        {
    "id": "mentalClarity",
    "name": "精神強化",
    "maxLevel": 20,
    "requiredLevel": 30,
    "preRequisite": {},
    "description": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。",
    "imageUrl": "images/mentalClarity.png",
    "levels": [
        null,
        { "effect": "消耗MP: 10, 魔法攻擊力: 1, 持續時間: 10秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級1效果：消耗MP10，魔法攻擊力1，持續10秒。" },
        { "effect": "消耗MP: 10, 魔法攻擊力: 2, 持續時間: 20秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級2效果：消耗MP10，魔法攻擊力2，持續20秒。" },
        { "effect": "消耗MP: 10, 魔法攻擊力: 3, 持續時間: 30秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級3效果：消耗MP10，魔法攻擊力3，持續30秒。" },
        { "effect": "消耗MP: 10, 魔法攻擊力: 4, 持續時間: 40秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級4效果：消耗MP10，魔法攻擊力4，持續40秒。" },
        { "effect": "消耗MP: 10, 魔法攻擊力: 5, 持續時間: 50秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級5效果：消耗MP10，魔法攻擊力5，持續50秒。" },
        { "effect": "消耗MP: 10, 魔法攻擊力: 6, 持續時間: 60秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級6效果：消耗MP10，魔法攻擊力6，持續60秒。" },
        { "effect": "消耗MP: 10, 魔法攻擊力: 7, 持續時間: 70秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級7效果：消耗MP10，魔法攻擊力7，持續70秒。" },
        { "effect": "消耗MP: 10, 魔法攻擊力: 8, 持續時間: 80秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級8效果：消耗MP10，魔法攻擊力8，持續80秒。" },
        { "effect": "消耗MP: 10, 魔法攻擊力: 9, 持續時間: 90秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級9效果：消耗MP10，魔法攻擊力9，持續90秒。" },
        { "effect": "消耗MP: 10, 魔法攻擊力: 10, 持續時間: 100秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級10效果：消耗MP10，魔法攻擊力10，持續100秒。" },
        { "effect": "消耗MP: 20, 魔法攻擊力: 11, 持續時間: 120秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級11效果：消耗MP20，魔法攻擊力11，持續120秒。" },
        { "effect": "消耗MP: 20, 魔法攻擊力: 12, 持續時間: 140秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級12效果：消耗MP20，魔法攻擊力12，持續140秒。" },
        { "effect": "消耗MP: 20, 魔法攻擊力: 13, 持續時間: 160秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級13效果：消耗MP20，魔法攻擊力13，持續160秒。" },
        { "effect": "消耗MP: 20, 魔法攻擊力: 14, 持續時間: 180秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級14效果：消耗MP20，魔法攻擊力14，持續180秒。" },
        { "effect": "消耗MP: 20, 魔法攻擊力: 15, 持續時間: 200秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級15效果：消耗MP20，魔法攻擊力15，持續200秒。" },
        { "effect": "消耗MP: 20, 魔法攻擊力: 16, 持續時間: 220秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級16效果：消耗MP20，魔法攻擊力16，持續220秒。" },
        { "effect": "消耗MP: 20, 魔法攻擊力: 17, 持續時間: 240秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級17效果：消耗MP20，魔法攻擊力17，持續240秒。" },
        { "effect": "消耗MP: 20, 魔法攻擊力: 18, 持續時間: 260秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級18效果：消耗MP20，魔法攻擊力18，持續260秒。" },
        { "effect": "消耗MP: 20, 魔法攻擊力: 19, 持續時間: 280秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級19效果：消耗MP20，魔法攻擊力19，持續280秒。" },
        { "effect": "消耗MP: 20, 魔法攻擊力: 20, 持續時間: 300秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級20效果：消耗MP20，魔法攻擊力20，持續300秒。" }
    ]
},
                        {
                            id: "slow",
                            name: "緩速術",
                            maxLevel: 20,
                            requiredLevel: 30,
                            preRequisite: {},
                            description: "在一定時間內，降低怪物的移動速度。施展一次可影響6個怪物，但無法對同一怪物重複使用。",
                            imageUrl: "images/slow.png",
                            levels: Array(21).fill(null).map((_, i) => {
                                const mp = i <= 10 ? 8 : 16;
                                return i === 0 ? null : {
                                    effect: `消耗MP: ${mp}, 怪物移動速度: -${i * 2}, 持續時間: ${i * 2}秒`,
                                    fullDescription: `在一定時間內，降低怪物的移動速度。施展一次可影響6個怪物，但無法對同一怪物重複使用。等級${i}效果：消耗MP${mp}，移動速度-${i * 2}，持續${i * 2}秒。`
                                };
                            })
                        },
                        {
                            id: "flameArrow",
                            name: "火焰箭",
                            maxLevel: 30,
                            requiredLevel: 30,
                            preRequisite: {},
                            description: "利用魔法製作火箭來攻擊前方三隻怪物。對冰屬性的怪物可產生1.5倍的效力，但對火屬性的怪物，其效果則會減半。",
                            imageUrl: "images/flameArrow.png",
                            levels: Array(31).fill(null).map((_, i) => {
                                const mp = i <= 15 ? 14 : 28;
                                const attack = 15 + (i > 1 ? (i - 1) * 2 : 0);
                                const mastery = 15 + (i > 3 ? (Math.floor((i - 1) / 3)) * 5 : 0);
                                return i === 0 ? null : {
                                    effect: `消耗MP: ${mp}, 攻擊力: ${attack}, 熟練度: ${mastery}%`,
                                    fullDescription: `利用魔法製作火箭來攻擊前方三隻怪物。對冰屬性的怪物可產生1.5倍的效力，但對火屬性的怪物，其效果則會減半。等級${i}效果：消耗MP${mp}，攻擊力${attack}，熟練度${mastery}%。`
                                };
                            })
                        },
                        {
                            id: "poisonMist",
                            name: "毒霧",
                            maxLevel: 30,
                            requiredLevel: 30,
                            preRequisite: {},
                            description: "製作劇毒的水珠，向單一怪物進行攻擊。在一定時間內，根據一定比例使怪物中毒，而在中毒的狀況下，怪物的HP會逐漸減少。",
                            imageUrl: "images/poisonMist.png",
                            levels: Array(31).fill(null).map((_, i) => {
                                const mp = i <= 15 ? 10 : 20;
                                const attack = 10 + (i > 1 ? (i - 1) * 2 : 0);
                                const poisonRate = 100;
                                const mastery = 15 + (i > 3 ? (Math.floor((i - 1) / 3)) * 5 : 0);
                                const duration = 4 + (i > 3 ? (Math.floor((i - 1) / 3)) * 4 : 0);
                                return i === 0 ? null : {
                                    effect: `消耗MP: ${mp}, 攻擊力: ${attack}, 中毒率: ${poisonRate}%, 熟練度: ${mastery}%, 持續時間: ${duration}秒`,
                                    fullDescription: `製作劇毒的水珠，向單一怪物進行攻擊。在一定時間內，根據一定比例使怪物中毒，而在中毒的狀況下，怪物的HP會逐漸減少。等級${i}效果：消耗MP${mp}，攻擊力${attack}，中毒率${poisonRate}%，熟練度${mastery}%，持續${duration}秒。`
                                };
                            })
                        }
                    ],
                    "3轉 (火毒魔導士)": [
                        {
    "id": "magicBooster",
    "name": "魔力激發",
    "maxLevel": 30,
    "requiredLevel": 70, // 3轉技能通常70等可學
    "preRequisite": {}, // 請確認是否有前置技能，若有請補上
    "description": "消耗自身的MP用來提高魔法攻擊力。",
    "imageUrl": "images/magicBooster.png", // 確保圖片檔案存在
    "levels": Array(31).fill(null).map((_, i) => {
        if (i === 0) return null; // 處理索引0為null

        // 消耗MP(%) 的規律：
        // 1-10級: 105% 110% ... 140% (每次加3%) => 102 + i * 3
        // 11-20級: 160% 155% ... 175% (這段數據不太規則，但以提供的數據為準，用三段計算來模擬)
        // 21-30級: 180% 180% ... 200% (這段數據也不太規則，用三段計算來模擬)
        const mpCostsRaw = [null, 105, 110, 115, 120, 125, 130, 135, 140, 145, 150, 160, 155, 165, 160, 170, 165, 175, 170, 180, 175, 180, 180, 190, 185, 195, 190, 205, 200, 195, 200];
        const mpCostPercent = mpCostsRaw[i];

        // 魔法攻擊力 的規律：
        // 1-20級: 102% 104% ... 130% (每次加2%直到109%，然後複雜變化)
        // 21-30級: 132% 134% ... 150%
        const magicAttacksRaw = [null, 102, 104, 106, 108, 109, 110, 111, 112, 113, 114, 116, 116, 118, 118, 120, 120, 122, 122, 124, 124, 126, 126, 128, 128, 130, 130, 132, 132, 132, 135];
        const magicAttackPercent = magicAttacksRaw[i];

        // 持續時間 的規律：
        // 1-10級: 105秒 110秒 ... 150秒 (每次加5秒) => 100 + i * 5
        // 11-20級: 155秒 160秒 ... 200秒 (每次加5秒) => 150 + (i-10)*5
        // 21-30級: 210秒 220秒 ... 300秒 (每次加10秒) => 200 + (i-20)*10
        let duration;
        if (i <= 10) {
            duration = 100 + i * 5;
        } else if (i <= 20) {
            duration = 150 + (i - 10) * 5;
        } else {
            duration = 200 + (i - 20) * 10;
        }

        return {
            effect: `消耗MP: ${mpCostPercent}%, 魔法攻擊力: ${magicAttackPercent}%, 持續時間: ${duration}秒`,
            fullDescription: `消耗自身的MP用來提高魔法攻擊力。等級${i}效果：消耗MP${mpCostPercent}%，魔法攻擊力${magicAttackPercent}%，持續${duration}秒。`
        };
    })
},
                        {
                            id: "magicSeal",
                            name: "魔法封印",
                            maxLevel: 20,
                            requiredLevel: 70,
                            preRequisite: { "magicBooster": 3 },
                            description: "使敵人在一段時間內變成封印狀態。被封印狀態的怪物其物理防禦力與魔法防禦力會降低。",
                            imageUrl: "images/magicSeal.png",
                            levels: Array(21).fill(null).map((_, i) => {
                                const mp = i <= 5 ? 12 : (i <= 10 ? 18 : (i <= 15 ? 24 : 30));
                                const defenseReduction = i * 0.5;
                                const duration = 9 + Math.floor((i - 1) / 2); // Simplified based on data
                                return i === 0 ? null : {
                                    effect: `消耗MP: ${mp}, 物理與魔法防禦: -${defenseReduction}%, 持續時間: ${duration}秒`,
                                    fullDescription: `使敵人在一段時間內變成封印狀態。等級${i}效果：消耗MP${mp}，物理與魔法防禦-${defenseReduction}%，持續${duration}秒。`
                                };
                            })
                        },
                        {
    "id": "extremeCasting",
    "name": "極速詠唱",
    "maxLevel": 20,
    "requiredLevel": 70,
    "preRequisite": { "magicBooster": 3 },
    "description": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。",
    "imageUrl": "images/extremeCasting.png",
    "levels": [
        null,
        { "effect": "消耗HP: 58, 消耗MP: 53, 施法速度: 1, 持續時間: 10秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級1效果：消耗HP58，消耗MP53，施法速度1，持續10秒。" },
        { "effect": "消耗HP: 56, 消耗MP: 51, 施法速度: 1, 持續時間: 20秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級2效果：消耗HP56，消耗MP51，施法速度1，持續20秒。" },
        { "effect": "消耗HP: 54, 消耗MP: 49, 施法速度: 1, 持續時間: 30秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級3效果：消耗HP54，消耗MP49，施法速度1，持續30秒。" },
        { "effect": "消耗HP: 52, 消耗MP: 47, 施法速度: 1, 持續時間: 40秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級4效果：消耗HP52，消耗MP47，施法速度1，持續40秒。" },
        { "effect": "消耗HP: 50, 消耗MP: 45, 施法速度: 1, 持續時間: 50秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級5效果：消耗HP50，消耗MP45，施法速度1，持續50秒。" },
        { "effect": "消耗HP: 48, 消耗MP: 43, 施法速度: 1, 持續時間: 60秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級6效果：消耗HP48，消耗MP43，施法速度1，持續60秒。" },
        { "effect": "消耗HP: 46, 消耗MP: 41, 施法速度: 1, 持續時間: 70秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級7效果：消耗HP46，消耗MP41，施法速度1，持續70秒。" },
        { "effect": "消耗HP: 44, 消耗MP: 39, 施法速度: 1, 持續時間: 80秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級8效果：消耗HP44，消耗MP39，施法速度1，持續80秒。" },
        { "effect": "消耗HP: 42, 消耗MP: 37, 施法速度: 1, 持續時間: 90秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級9效果：消耗HP42，消耗MP37，施法速度1，持續90秒。" },
        { "effect": "消耗HP: 40, 消耗MP: 35, 施法速度: 1, 持續時間: 100秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級10效果：消耗HP40，消耗MP35，施法速度1，持續100秒。" },
        { "effect": "消耗HP: 39, 消耗MP: 34, 施法速度: 2, 持續時間: 110秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級11效果：消耗HP39，消耗MP34，施法速度2，持續110秒。" },
        { "effect": "消耗HP: 38, 消耗MP: 33, 施法速度: 2, 持續時間: 120秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級12效果：消耗HP38，消耗MP33，施法速度2，持續120秒。" },
        { "effect": "消耗HP: 34, 消耗MP: 29, 施法速度: 2, 持續時間: 130秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級13效果：消耗HP34，消耗MP29，施法速度2，持續130秒。" },
        { "effect": "消耗HP: 32, 消耗MP: 27, 施法速度: 2, 持續時間: 140秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級14效果：消耗HP32，消耗MP27，施法速度2，持續140秒。" },
        { "effect": "消耗HP: 30, 消耗MP: 25, 施法速度: 2, 持續時間: 150秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級15效果：消耗HP30，消耗MP25，施法速度2，持續150秒。" },
        { "effect": "消耗HP: 28, 消耗MP: 23, 施法速度: 2, 持續時間: 160秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級16效果：消耗HP28，消耗MP23，施法速度2，持續160秒。" },
        { "effect": "消耗HP: 26, 消耗MP: 21, 施法速度: 2, 持續時間: 170秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級17效果：消耗HP26，消耗MP21，施法速度2，持續170秒。" },
        { "effect": "消耗HP: 24, 消耗MP: 19, 施法速度: 2, 持續時間: 180秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級18效果：消耗HP24，消耗MP19，施法速度2，持續180秒。" },
        { "effect": "消耗HP: 22, 消耗MP: 17, 施法速度: 2, 持續時間: 190秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級19效果：消耗HP22，消耗MP17，施法速度2，持續190秒。" },
        { "effect": "消耗HP: 20, 消耗MP: 15, 施法速度: 2, 持續時間: 200秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級20效果：消耗HP20，消耗MP15，施法速度2，持續200秒。" }
    ]
},
                        {
                            id: "firePoisonStrike",
                            name: "火毒合擊",
                            maxLevel: 30,
                            requiredLevel: 70,
                            preRequisite: {},
                            description: "混合火、毒屬性的魔法，攻擊一個怪物。對火、毒屬性為弱點的怪物將可能造成致命性的傷害，並且有一定的機率會使怪物中毒。",
                            imageUrl: "images/firePoisonStrike.png",
                            levels: Array(31).fill(null).map((_, i) => {
                                let mp, poisonRate, attack, duration, mastery;
                                if (i === 0) return null;
                                mp = i <= 10 ? 14 : (i <= 20 ? 18 : 22);
                                poisonRate = 40 + i;
                                attack = 79 + i;
                                duration = 4 + Math.floor((i - 1) / 3) * 4;
                                mastery = 15 + Math.floor((i - 1) / 3) * 5;
                                return {
                                    effect: `消耗MP: ${mp}, 中毒機率: ${poisonRate}%, 攻擊力: ${attack}, 持續時間: ${duration}秒, 熟練度: ${mastery}%`,
                                    fullDescription: `混合火、毒屬性的魔法，攻擊一個怪物。等級${i}效果：消耗MP${mp}，中毒機率${poisonRate}%，攻擊力${attack}，持續時間${duration}秒，熟練度${mastery}%。`
                                };
                            })
                        },
                        {
                            id: "firePoisonResistance",
                            name: "火毒抵抗",
                            maxLevel: 20,
                            requiredLevel: 70,
                            preRequisite: {},
                            description: "提高對火、毒屬性魔法攻擊的抗性。",
                            imageUrl: "images/firePoisonResistance.png",
                            levels: Array(21).fill(null).map((_, i) => i === 0 ? null : {
                                effect: `抗性增加: ${0 + i * 3}%`,
                                fullDescription: `提高對火、毒屬性魔法攻擊的抗性。等級${i}效果：抗性增加${0 + i * 3}%。`
                            })
                        },
                        {
                            id: "apocalypse",
                            name: "末日烈焰",
                            maxLevel: 30,
                            requiredLevel: 70,
                            preRequisite: {},
                            description: "引發大爆炸來攻擊自身周圍的敵人。最多可攻擊6名敵人。",
                            imageUrl: "images/apocalypse.png",
                            levels: Array(31).fill(null).map((_, i) => {
                                let mp, attack, range, mastery;
                                if (i === 0) return null;
                                mp = 20 + i;
                                attack = 59 + i * 2;
                                range = 100 + i * 3;
                                mastery = 15 + Math.floor((i - 1) / 3) * 5;
                                return {
                                    effect: `消耗MP: ${mp}, 攻擊力: ${attack}, 攻擊範圍: ${range}%, 熟練度: ${mastery}%`,
                                    fullDescription: `引發大爆炸來攻擊自身周圍的敵人。等級${i}效果：消耗MP${mp}，攻擊力${attack}，攻擊範圍${range}%，熟練度${mastery}%。`
                                };
                            })
                        },
                        {
                            id: "deadlyPoison",
                            name: "致命毒霧",
                            maxLevel: 30,
                            requiredLevel: 70,
                            preRequisite: {},
                            description: "在一定的時間內，施放毒霧攻擊自身周圍的敵人。在毒霧內的怪物，會因中毒而使HP下降，對中毒怪物的數量則沒有限制。",
                            imageUrl: "images/deadlyPoison.png",
                            levels: Array(31).fill(null).map((_, i) => {
                                let mp, poisonRate, attack, duration, mastery, range;
                                if (i === 0) return null;
                                mp = 20 + i;
                                poisonRate = 40 + i;
                                attack = 30 + i * 2;
                                duration = 4 + Math.floor((i - 1) / 3) * 4;
                                mastery = 15 + Math.floor((i - 1) / 3) * 5;
                                range = 100 + i * 3;
                                return {
                                    effect: `消耗MP: ${mp}, 中毒機率: ${poisonRate}%, 攻擊力: ${attack}, 持續時間: ${duration}秒, 熟練度: ${mastery}%, 攻擊範圍: ${range}%`,
                                    fullDescription: `在一定的時間內，施放毒霧攻擊自身周圍的敵人。等級${i}效果：消耗MP${mp}，中毒機率${poisonRate}%，攻擊力${attack}，持續時間${duration}秒，熟練度${mastery}%，攻擊範圍${range}%。`
                                };
                            })
                        }
                    ],
                    "4轉 (烈焰巫師)": [],
                    "超技能": [],
                    "5轉技能": [],
                    "共通技能": []
                }
            },
            "冰雷大魔導 (Arch Mage I/L)": {
        startingLevelForSp: 8,
        jobAdvancementSpBonuses: [8, 30, 70, 120],
        jobStagesOrder: ["0轉 (新手)", "1轉 (魔法師)", "2轉 (冰雷巫師)", "3轉 (冰雷魔導士)", "4轉 (冰雷大魔導)", "超技能", "5轉技能", "共通技能"],
        spRequiredFor2ndJob: 67, // 法師2轉點數需求
        spRequiredFor3rdJob: 188, // 法師3轉點數需求
        spRequiredFor4thJob: 255, // 4轉通用點數需求
        skills: {
            "0轉 (新手)": [],
            "1轉 (魔法師)": [
                {
                    id: "magicPurify", name: "魔力淨化", maxLevel: 16, requiredLevel: 10, preRequisite: {}, description: "每10秒鐘可恢復更多量的MP。", imageUrl: "images/magicPurify.png",
                    levels: Array(17).fill(null).map((_, i) => i === 0 ? null : { effect: `${(0.1 * i).toFixed(1)}x角色等級+3 MP回復量`, fullDescription: `每10秒鐘可恢復更多量的MP。回復量公式：${(0.1 * i).toFixed(1)}x角色等級+3` })
                },
                {
                    id: "magicExtension", name: "魔力擴展", maxLevel: 10, requiredLevel: 10, preRequisite: { "magicPurify": 5 }, description: "當等級提升時，增加MP的最大追加量。", imageUrl: "images/magicExtension.png",
                    levels: Array(11).fill(null).map((_, i) => i === 0 ? null : { effect: `升級追加量: ${2 * i}`, fullDescription: `當等級提升時，增加MP的最大追加量。等級${i}效果：升級追加量${2 * i}。` })
                },
                {
                    id: "magicGuard", name: "魔心防禦", maxLevel: 20, requiredLevel: 10, preRequisite: {}, description: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。但若MP達到0時，則直接消耗HP。", imageUrl: "images/magicGuard.png",
                    levels: [
                        null,
                        { effect: "消耗MP: 6, 持續時間: 170秒, 替代率: 23%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級1效果：消耗MP6，持續170秒，替代率23%。" },
                        { effect: "消耗MP: 6, 持續時間: 180秒, 替代率: 26%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級2效果：消耗MP6，持續180秒，替代率26%。" },
                        { effect: "消耗MP: 6, 持續時間: 190秒, 替代率: 29%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級3效果：消耗MP6，持續190秒，替代率29%。" },
                        { effect: "消耗MP: 6, 持續時間: 200秒, 替代率: 32%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級4效果：消耗MP6，持續200秒，替代率32%。" },
                        { effect: "消耗MP: 6, 持續時間: 210秒, 替代率: 35%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級5效果：消耗MP6，持續210秒，替代率35%。" },
                        { effect: "消耗MP: 6, 持續時間: 220秒, 替代率: 38%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級6效果：消耗MP6，持續220秒，替代率38%。" },
                        { effect: "消耗MP: 6, 持續時間: 230秒, 替代率: 41%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級7效果：消耗MP6，持續230秒，替代率41%。" },
                        { effect: "消耗MP: 6, 持續時間: 240秒, 替代率: 44%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級8效果：消耗MP6，持續240秒，替代率44%。" },
                        { effect: "消耗MP: 6, 持續時間: 250秒, 替代率: 47%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級9效果：消耗MP6，持續250秒，替代率47%。" },
                        { effect: "消耗MP: 6, 持續時間: 260秒, 替代率: 50%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級10效果：消耗MP6，持續260秒，替代率50%。" },
                        { effect: "消耗MP: 12, 持續時間: 270秒, 替代率: 53%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級11效果：消耗MP12，持續270秒，替代率53%。" },
                        { effect: "消耗MP: 12, 持續時間: 280秒, 替代率: 56%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級12效果：消耗MP12，持續280秒，替代率56%。" },
                        { effect: "消耗MP: 12, 持續時間: 290秒, 替代率: 59%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級13效果：消耗MP12，持續290秒，替代率59%。" },
                        { effect: "消耗MP: 12, 持續時間: 300秒, 替代率: 62%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級14效果：消耗MP12，持續300秒，替代率62%。" },
                        { effect: "消耗MP: 12, 持續時間: 310秒, 替代率: 65%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級15效果：消耗MP12，持續310秒，替代率65%。" },
                        { effect: "消耗MP: 12, 持續時間: 320秒, 替代率: 68%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級16效果：消耗MP12，持續320秒，替代率68%。" },
                        { effect: "消耗MP: 12, 持續時間: 330秒, 替代率: 71%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級17效果：消耗MP12，持續330秒，替代率71%。" },
                        { effect: "消耗MP: 12, 持續時間: 340秒, 替代率: 74%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級18效果：消耗MP12，持續340秒，替代率74%。" },
                        { effect: "消耗MP: 12, 持續時間: 350秒, 替代率: 77%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級19效果：消耗MP12，持續350秒，替代率77%。" },
                        { effect: "消耗MP: 12, 持續時間: 360秒，替代率: 80%", fullDescription: "一定的時間內，依比例用MP來帶替傷害所耗損的HP生命值。等級20效果：消耗MP12，持續360秒，替代率80%。" }]
                },
                {
                    id: "magicShield", name: "魔力之盾", maxLevel: 20, requiredLevel: 10, preRequisite: { "magicGuard": 3 }, description: "一定時間內把魔力集中在盔甲上，提高物理防禦力。", imageUrl: "images/magicShield.png",
                    levels: [
                        null,
                        { effect: "消耗MP: 8, 持續時間: 20秒, 防禦力: 2", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級1效果：消耗MP8，持續20秒，防禦力2。" },
                        { effect: "消耗MP: 8, 持續時間: 40秒, 防禦力: 4", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級2效果：消耗MP8，持續40秒，防禦力4。" },
                        { effect: "消耗MP: 8, 持續時間: 60秒, 防禦力: 6", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級3效果：消耗MP8，持續60秒，防禦力6。" },
                        { effect: "消耗MP: 8, 持續時間: 80秒, 防禦力: 8", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級4效果：消耗MP8，持續80秒，防禦力8。" },
                        { effect: "消耗MP: 8, 持續時間: 100秒, 防禦力: 10", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級5效果：消耗MP8，持續100秒，防禦力10。" },
                        { effect: "消耗MP: 8, 持續時間: 120秒, 防禦力: 12", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級6效果：消耗MP8，持續120秒，防禦力12。" },
                        { effect: "消耗MP: 8, 持續時間: 140秒, 防禦力: 14", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級7效果：消耗MP8，持續140秒，防禦力14。" },
                        { effect: "消耗MP: 8, 持續時間: 160秒, 防禦力: 16", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級8效果：消耗MP8，持續160秒，防禦力16。" },
                        { effect: "消耗MP: 8, 持續時間: 180秒, 防禦力: 18", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級9效果：消耗MP8，持續180秒，防禦力18。" },
                        { effect: "消耗MP: 8, 持續時間: 200秒, 防禦力: 20", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級10效果：消耗MP8，持續200秒，防禦力20。" },
                        { effect: "消耗MP: 13, 持續時間: 196秒, 防禦力: 22", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級11效果：消耗MP13，持續196秒，防禦力22。" },
                        { effect: "消耗MP: 13, 持續時間: 210秒, 防禦力: 24", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級12效果：消耗MP13，持續210秒，防禦力24。" },
                        { effect: "消耗MP: 13, 持續時間: 224秒, 防禦力: 26", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級13效果：消耗MP13，持續224秒，防禦力26。" },
                        { effect: "消耗MP: 13, 持續時間: 238秒, 防禦力: 28", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級14效果：消耗MP13，持續238秒，防禦力28。" },
                        { effect: "消耗MP: 13, 持續時間: 252秒, 防禦力: 30", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級15效果：消耗MP13，持續252秒，防禦力30。" },
                        { effect: "消耗MP: 16, 持續時間: 260秒, 防禦力: 32", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級16效果：消耗MP16，持續260秒，防禦力32。" },
                        { effect: "消耗MP: 16, 持續時間: 270秒, 防禦力: 34", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級17效果：消耗MP16，持續270秒，防禦力34。" },
                        { effect: "消耗MP: 16, 持續時間: 280秒, 防禦力: 36", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級18效果：消耗MP16，持續280秒，防禦力36。" },
                        { effect: "消耗MP: 16, 持續時間: 290秒, 防禦力: 38", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級19效果：消耗MP16，持續290秒，防禦力38。" },
                        { effect: "消耗MP: 16, 持續時間: 300秒，防禦力: 40", fullDescription: "一定時間內把魔力集中在盔甲上，提高物理防禦力。等級20效果：消耗MP16，持續300秒，防禦力40。" }
                            ]
                        },
                        {
                            id: "magicArrow", name: "魔靈彈", maxLevel: 20, requiredLevel: 10, preRequisite: {}, description: "消耗MP來攻擊單一個怪物。", imageUrl: "images/magicArrow.png",
                            levels: [
                                null,
                                { effect: "消耗MP: 6, 攻擊力: 20, 熟練度: 15%", fullDescription: "消耗MP來攻擊單一個怪物。等級1效果：消耗MP6，攻擊力20，熟練度15%。" },
                                { effect: "消耗MP: 6, 攻擊力: 21, 熟練度: 15%", fullDescription: "消耗MP來攻擊單一個怪物。等級2效果：消耗MP6，攻擊力21，熟練度15%。" },
                                { effect: "消耗MP: 6, 攻擊力: 22, 熟練度: 20%", fullDescription: "消耗MP來攻擊單一個怪物。等級3效果：消耗MP6，攻擊力22，熟練度20%。" },
                                { effect: "消耗MP: 6, 攻擊力: 23, 熟練度: 20%", fullDescription: "消耗MP來攻擊單一個怪物。等級4效果：消耗MP6，攻擊力23，熟練度20%。" },
                                { effect: "消耗MP: 6, 攻擊力: 24, 熟練度: 25%", fullDescription: "消耗MP來攻擊單一個怪物。等級5效果：消耗MP6，攻擊力24，熟練度25%。" },
                                { effect: "消耗MP: 6, 攻擊力: 25, 熟練度: 25%", fullDescription: "消耗MP來攻擊單一個怪物。等級6效果：消耗MP6，攻擊力25，熟練度25%。" },
                                { effect: "消耗MP: 6, 攻擊力: 26, 熟練度: 30%", fullDescription: "消耗MP來攻擊單一個怪物。等級7效果：消耗MP6，攻擊力26，熟練度30%。" },
                                { effect: "消耗MP: 6, 攻擊力: 27, 熟練度: 30%", fullDescription: "消耗MP來攻擊單一個怪物。等級8效果：消耗MP6，攻擊力27，熟練度30%。" },
                                { effect: "消耗MP: 6, 攻擊力: 28, 熟練度: 35%", fullDescription: "消耗MP來攻擊單一個怪物。等級9效果：消耗MP6，攻擊力28，熟練度35%。" },
                                { effect: "消耗MP: 6, 攻擊力: 29, 熟練度: 35%", fullDescription: "消耗MP來攻擊單一個怪物。等級10效果：消耗MP6，攻擊力29，熟練度35%。" },
                                { effect: "消耗MP: 14, 攻擊力: 30, 熟練度: 40%", fullDescription: "消耗MP來攻擊單一個怪物。等級11效果：消耗MP14，攻擊力30，熟練度40%。" },
                                { effect: "消耗MP: 14, 攻擊力: 31, 熟練度: 40%", fullDescription: "消耗MP來攻擊單一個怪物。等級12效果：消耗MP14，攻擊力31，熟練度40%。" },
                                { effect: "消耗MP: 14, 攻擊力: 32, 熟練度: 45%", fullDescription: "消耗MP來攻擊單一個怪物。等級13效果：消耗MP14，攻擊力32，熟練度45%。" },
                                { effect: "消耗MP: 14, 攻擊力: 33, 熟練度: 45%", fullDescription: "消耗MP來攻擊單一個怪物。等級14效果：消耗MP14，攻擊力33，熟練度45%。" },
                                { effect: "消耗MP: 14, 攻擊力: 34, 熟練度: 50%", fullDescription: "消耗MP來攻擊單一個怪物。等級15效果：消耗MP14，攻擊力34，熟練度50%。" },
                                { effect: "消耗MP: 14, 攻擊力: 35, 熟練度: 50%", fullDescription: "消耗MP來攻擊單一個怪物。等級16效果：消耗MP14，攻擊力35，熟練度50%。" },
                                { effect: "消耗MP: 14, 攻擊力: 36, 熟練度: 55%", fullDescription: "消耗MP來攻擊單一個怪物。等級17效果：消耗MP14，攻擊力36，熟練度55%。" },
                                { effect: "消耗MP: 14, 攻擊力: 37, 熟練度: 55%", fullDescription: "消耗MP來攻擊單一個怪物。等級18效果：消耗MP14，攻擊力37，熟練度55%。" },
                                { effect: "消耗MP: 14, 攻擊力: 38, 熟練度: 60%", fullDescription: "消耗MP來攻擊單一個怪物。等級19效果：消耗MP14，攻擊力38，熟練度60%。" },
                                { effect: "消耗MP: 14, 攻擊力: 39, 熟練度: 60%", fullDescription: "消耗MP來攻擊單一個怪物。等級20效果：消耗MP14，攻擊力39，熟練度60%。" }
                            ]
                        },
                        {
                            id: "magicClaw", name: "魔力爪", maxLevel: 20, requiredLevel: 10, preRequisite: { "magicArrow": 1 }, description: "消耗MP來對同一個怪物發動兩次的連續攻擊。", imageUrl: "images/magicClaw.png",
                            levels: [
                                null,
                                { effect: "消耗MP: 10, 攻擊力: 11, 熟練度: 15%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級1效果：消耗MP10，攻擊力11，熟練度15%。" },
                                { effect: "消耗MP: 10, 攻擊力: 12, 熟練度: 15%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級2效果：消耗MP10，攻擊力12，熟練度15%。" },
                                { effect: "消耗MP: 10, 攻擊力: 13, 熟練度: 20%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級3效果：消耗MP10，攻擊力13，熟練度20%。" },
                                { effect: "消耗MP: 10, 攻擊力: 14, 熟練度: 20%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級4效果：消耗MP10，攻擊力14，熟練度20%。" },
                                { effect: "消耗MP: 10, 攻擊力: 15, 熟練度: 25%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級5效果：消耗MP10，攻擊力15，熟練度25%。" },
                                { effect: "消耗MP: 10, 攻擊力: 16, 熟練度: 25%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級6效果：消耗MP10，攻擊力16，熟練度25%。" },
                                { effect: "消耗MP: 10, 攻擊力: 17, 熟練度: 30%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級7效果：消耗MP10，攻擊力17，熟練度30%。" },
                                { effect: "消耗MP: 10, 攻擊力: 18, 熟練度: 30%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級8效果：消耗MP10，攻擊力18，熟練度30%。" },
                                { effect: "消耗MP: 10, 攻擊力: 19, 熟練度: 35%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級9效果：消耗MP10，攻擊力19，熟練度35%。" },
                                { effect: "消耗MP: 10, 攻擊力: 20, 熟練度: 35%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級10效果：消耗MP10，攻擊力20，熟練度35%。" },
                                { effect: "消耗MP: 20, 攻擊力: 22, 熟練度: 40%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級11效果：消耗MP20，攻擊力22，熟練度40%。" },
                                { effect: "消耗MP: 20, 攻擊力: 24, 熟練度: 40%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級12效果：消耗MP20，攻擊力24，熟練度40%。" },
                                { effect: "消耗MP: 20, 攻擊力: 26, 熟練度: 45%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級13效果：消耗MP20，攻擊力26，熟練度45%。" },
                                { effect: "消耗MP: 20, 攻擊力: 28, 熟練度: 45%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級14效果：消耗MP20，攻擊力28，熟練度45%。" },
                                { effect: "消耗MP: 20, 攻擊力: 30, 熟練度: 50%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級15效果：消耗MP20，攻擊力30，熟練度50%。" },
                                { effect: "消耗MP: 20, 攻擊力: 32, 熟練度: 50%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級16效果：消耗MP20，攻擊力32，熟練度50%。" },
                                { effect: "消耗MP: 20, 攻擊力: 34, 熟練度: 55%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級17效果：消耗MP20，攻擊力34，熟練度55%。" },
                                { effect: "消耗MP: 20, 攻擊力: 36, 熟練度: 55%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級18效果：消耗MP20，攻擊力36，熟練度55%。" },
                                { effect: "消耗MP: 20, 攻擊力: 38, 熟練度: 60%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級19效果：消耗MP20，攻擊力38，熟練度60%。" },
                                { effect: "消耗MP: 20, 攻擊力: 40, 熟練度: 60%", fullDescription: "消耗MP來對同一個怪物發動兩次的連續攻擊。等級20效果：消耗MP20，攻擊力40，熟練度60%。" }
                            ]
                        }
                    ],
                    "2轉 (冰雷巫師)": [
                        {
                            id: "magicDrain",
                            name: "魔力吸收",
                            maxLevel: 20,
                            requiredLevel: 30,
                            preRequisite: {},
                            description: "每次向敵人施展魔法攻擊時，依比例率吸收對方的MP直到敵人的MP為0。",
                            imageUrl: "images/magicDrain.png",
                            levels: Array(21).fill(null).map((_, i) => i === 0 ? null : {
                                effect: `發動率: ${10 + i}%, 吸收率: ${20 + i}%`,
                                fullDescription: `每次向敵人施展魔法攻擊時，依比例率吸收對方的MP直到敵人的MP為0。等級${i}效果：發動率${10 + i}%，吸收率${20 + i}%。`
                            })
                        },
                        {
                            id: "teleport",
                            name: "瞬間移動",
                            maxLevel: 20,
                            requiredLevel: 30,
                            preRequisite: {},
                            description: "利用魔法在一定的範圍內瞬間移動到指定位置，但若指定位置必須要有立足點。",
                            imageUrl: "images/teleport.png",
                            levels: Array(21).fill(null).map((_, i) => {
                                const mp = i <= 10 ? 60 - (i - 1) * 3 : 33 - (i - 11) * 2;
                                const dist = i <= 10 ? 130 : 130 + (i - 10) * 2;
                                return i === 0 ? null : {
                                    effect: `消耗MP: ${mp}, 移動距離: ${dist}`,
                                    fullDescription: `利用魔法在一定的範圍內瞬間移動到指定位置，但若指定位置必須要有立足點。等級${i}效果：消耗MP${mp}，移動距離${dist}。`
                                };
                            })
                        },
                        {
    "id": "mentalClarity",
    "name": "精神強化",
    "maxLevel": 20,
    "requiredLevel": 30,
    "preRequisite": {},
    "description": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。",
    "imageUrl": "images/mentalClarity.png",
    "levels": [
        null,
        { "effect": "消耗MP: 10, 魔法攻擊力: 1, 持續時間: 10秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級1效果：消耗MP10，魔法攻擊力1，持續10秒。" },
        { "effect": "消耗MP: 10, 魔法攻擊力: 2, 持續時間: 20秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級2效果：消耗MP10，魔法攻擊力2，持續20秒。" },
        { "effect": "消耗MP: 10, 魔法攻擊力: 3, 持續時間: 30秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級3效果：消耗MP10，魔法攻擊力3，持續30秒。" },
        { "effect": "消耗MP: 10, 魔法攻擊力: 4, 持續時間: 40秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級4效果：消耗MP10，魔法攻擊力4，持續40秒。" },
        { "effect": "消耗MP: 10, 魔法攻擊力: 5, 持續時間: 50秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級5效果：消耗MP10，魔法攻擊力5，持續50秒。" },
        { "effect": "消耗MP: 10, 魔法攻擊力: 6, 持續時間: 60秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級6效果：消耗MP10，魔法攻擊力6，持續60秒。" },
        { "effect": "消耗MP: 10, 魔法攻擊力: 7, 持續時間: 70秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級7效果：消耗MP10，魔法攻擊力7，持續70秒。" },
        { "effect": "消耗MP: 10, 魔法攻擊力: 8, 持續時間: 80秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級8效果：消耗MP10，魔法攻擊力8，持續80秒。" },
        { "effect": "消耗MP: 10, 魔法攻擊力: 9, 持續時間: 90秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級9效果：消耗MP10，魔法攻擊力9，持續90秒。" },
        { "effect": "消耗MP: 10, 魔法攻擊力: 10, 持續時間: 100秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級10效果：消耗MP10，魔法攻擊力10，持續100秒。" },
        { "effect": "消耗MP: 20, 魔法攻擊力: 11, 持續時間: 120秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級11效果：消耗MP20，魔法攻擊力11，持續120秒。" },
        { "effect": "消耗MP: 20, 魔法攻擊力: 12, 持續時間: 140秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級12效果：消耗MP20，魔法攻擊力12，持續140秒。" },
        { "effect": "消耗MP: 20, 魔法攻擊力: 13, 持續時間: 160秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級13效果：消耗MP20，魔法攻擊力13，持續160秒。" },
        { "effect": "消耗MP: 20, 魔法攻擊力: 14, 持續時間: 180秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級14效果：消耗MP20，魔法攻擊力14，持續180秒。" },
        { "effect": "消耗MP: 20, 魔法攻擊力: 15, 持續時間: 200秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級15效果：消耗MP20，魔法攻擊力15，持續200秒。" },
        { "effect": "消耗MP: 20, 魔法攻擊力: 16, 持續時間: 220秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級16效果：消耗MP20，魔法攻擊力16，持續220秒。" },
        { "effect": "消耗MP: 20, 魔法攻擊力: 17, 持續時間: 240秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級17效果：消耗MP20，魔法攻擊力17，持續240秒。" },
        { "effect": "消耗MP: 20, 魔法攻擊力: 18, 持續時間: 260秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級18效果：消耗MP20，魔法攻擊力18，持續260秒。" },
        { "effect": "消耗MP: 20, 魔法攻擊力: 19, 持續時間: 280秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級19效果：消耗MP20，魔法攻擊力19，持續280秒。" },
        { "effect": "消耗MP: 20, 魔法攻擊力: 20, 持續時間: 300秒", "fullDescription": "經由冥想使精神集中，一定時間內提高周圍所有隊員的魔法攻擊力。等級20效果：消耗MP20，魔法攻擊力20，持續300秒。" }
    ]
},
                        {
                            id: "slow",
                            name: "緩速術",
                            maxLevel: 20,
                            requiredLevel: 30,
                            preRequisite: {},
                            description: "在一定時間內，降低怪物的移動速度。施展一次可影響6個怪物，但無法對同一怪物重複使用。",
                            imageUrl: "images/slow.png",
                            levels: Array(21).fill(null).map((_, i) => {
                                const mp = i <= 10 ? 8 : 16;
                                return i === 0 ? null : {
                                    effect: `消耗MP: ${mp}, 怪物移動速度: -${i * 2}, 持續時間: ${i * 2}秒`,
                                    fullDescription: `在一定時間內，降低怪物的移動速度。施展一次可影響6個怪物，但無法對同一怪物重複使用。等級${i}效果：消耗MP${mp}，移動速度-${i * 2}，持續${i * 2}秒。`
                                };
                            })
                        },
                        {
                            id: "iceBolt",
                            name: "冰錐術",
                            maxLevel: 30,
                            requiredLevel: 30,
                            preRequisite: {},
                            description: "製作出尖銳的冰錐，向單一怪物發動攻擊，被命中的怪物會無法行動。對火屬性的怪物，會造成1.5倍殺傷力，而對冰屬性的怪物，其效力便會減半。",
                            imageUrl: "images/iceBolt.png",
                            levels: Array(31).fill(null).map((_, i) => {
                                const mp = i <= 15 ? 12 : 24;
                                const attack = 10 + (i > 1 ? (i - 1) * 3 : 0);
                                const freezeDuration = i <= 15 ? 1 : 2;
                                const mastery = 15 + (i > 3 ? (Math.floor((i - 1) / 3)) * 5 : 0);
                                return i === 0 ? null : {
                                    effect: `消耗MP: ${mp}, 攻擊力: ${attack}, 凍結時間: ${freezeDuration}秒, 熟練度: ${mastery}%`,
                                    fullDescription: `製作出尖銳的冰錐，向單一怪物發動攻擊，被命中的怪物會無法行動。等級${i}效果：消耗MP${mp}，攻擊力${attack}，凍結時間${freezeDuration}秒，熟練度${mastery}%。`
                                };
                            })
                        },
                        {
                            id: "thunderBolt",
                            name: "雷閃電鳴",
                            maxLevel: 30,
                            requiredLevel: 30,
                            preRequisite: {},
                            description: "在周圍製造強力磁場，向周遭至多六支怪物發起雷電攻擊。",
                            imageUrl: "images/thunderBolt.png",
                            levels: Array(31).fill(null).map((_, i) => {
                                const mp = i <= 15 ? 20 : 40;
                                const attack = 0 + (i > 1 ? (i - 1) * 2 : 0);
                                const mastery = 15 + (i > 3 ? (Math.floor((i - 1) / 3)) * 5 : 0);
                                return i === 0 ? null : {
                                    effect: `消耗MP: ${mp}, 攻擊力: ${attack}, 熟練度: ${mastery}%`,
                                    fullDescription: `在周圍製造強力磁場，向周遭至多六支怪物發起雷電攻擊。等級${i}效果：消耗MP${mp}，攻擊力${attack}，熟練度${mastery}%。`
                                };
                            })
                        }
                    ],
                    "3轉 (冰雷魔導士)": [
                        {
    "id": "magicBooster",
    "name": "魔力激發",
    "maxLevel": 30,
    "requiredLevel": 70, // 3轉技能通常70等可學
    "preRequisite": {}, // 請確認是否有前置技能，若有請補上
    "description": "消耗自身的MP用來提高魔法攻擊力。",
    "imageUrl": "images/magicBooster.png", // 確保圖片檔案存在
    "levels": Array(31).fill(null).map((_, i) => {
        if (i === 0) return null; // 處理索引0為null

        // 消耗MP(%) 的規律：
        // 1-10級: 105% 110% ... 140% (每次加3%) => 102 + i * 3
        // 11-20級: 160% 155% ... 175% (這段數據不太規則，但以提供的數據為準，用三段計算來模擬)
        // 21-30級: 180% 180% ... 200% (這段數據也不太規則，用三段計算來模擬)
        const mpCostsRaw = [null, 105, 110, 115, 120, 125, 130, 135, 140, 145, 150, 160, 155, 165, 160, 170, 165, 175, 170, 180, 175, 180, 180, 190, 185, 195, 190, 205, 200, 195, 200];
        const mpCostPercent = mpCostsRaw[i];

        // 魔法攻擊力 的規律：
        // 1-20級: 102% 104% ... 130% (每次加2%直到109%，然後複雜變化)
        // 21-30級: 132% 134% ... 150%
        const magicAttacksRaw = [null, 102, 104, 106, 108, 109, 110, 111, 112, 113, 114, 116, 116, 118, 118, 120, 120, 122, 122, 124, 124, 126, 126, 128, 128, 130, 130, 132, 132, 132, 135];
        const magicAttackPercent = magicAttacksRaw[i];

        // 持續時間 的規律：
        // 1-10級: 105秒 110秒 ... 150秒 (每次加5秒) => 100 + i * 5
        // 11-20級: 155秒 160秒 ... 200秒 (每次加5秒) => 150 + (i-10)*5
        // 21-30級: 210秒 220秒 ... 300秒 (每次加10秒) => 200 + (i-20)*10
        let duration;
        if (i <= 10) {
            duration = 100 + i * 5;
        } else if (i <= 20) {
            duration = 150 + (i - 10) * 5;
        } else {
            duration = 200 + (i - 20) * 10;
        }

        return {
            effect: `消耗MP: ${mpCostPercent}%, 魔法攻擊力: ${magicAttackPercent}%, 持續時間: ${duration}秒`,
            fullDescription: `消耗自身的MP用來提高魔法攻擊力。等級${i}效果：消耗MP${mpCostPercent}%，魔法攻擊力${magicAttackPercent}%，持續${duration}秒。`
        };
    })
},
                        {
                            id: "magicSeal",
                            name: "魔法封印",
                            maxLevel: 20,
                            requiredLevel: 70,
                            preRequisite: { "magicBooster": 3 },
                            description: "使敵人在一段時間內變成封印狀態。被封印狀態的怪物其物理防禦力與魔法防禦力會降低。（適用於BOSS）",
                            imageUrl: "images/magicSeal.png",
                            levels: Array(21).fill(null).map((_, i) => {
                                const mp = i <= 5 ? 12 : (i <= 10 ? 18 : (i <= 15 ? 24 : 30));
                                const defenseReduction = i * 0.5;
                                const duration = 9 + Math.floor((i - 1) / 2);
                                return i === 0 ? null : {
                                    effect: `消耗MP: ${mp}, 物理與魔法防禦: -${defenseReduction}%, 持續時間: ${duration}秒`,
                                    fullDescription: `使敵人在一段時間內變成封印狀態。等級${i}效果：消耗MP${mp}，物理與魔法防禦-${defenseReduction}%，持續${duration}秒。（適用於BOSS）`
                                };
                            })
                        },
                        {
    "id": "extremeCasting",
    "name": "極速詠唱",
    "maxLevel": 20,
    "requiredLevel": 70,
    "preRequisite": { "magicBooster": 3 },
    "description": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。",
    "imageUrl": "images/extremeCasting.png",
    "levels": [
        null,
        { "effect": "消耗HP: 58, 消耗MP: 53, 施法速度: 1, 持續時間: 10秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級1效果：消耗HP58，消耗MP53，施法速度1，持續10秒。" },
        { "effect": "消耗HP: 56, 消耗MP: 51, 施法速度: 1, 持續時間: 20秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級2效果：消耗HP56，消耗MP51，施法速度1，持續20秒。" },
        { "effect": "消耗HP: 54, 消耗MP: 49, 施法速度: 1, 持續時間: 30秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級3效果：消耗HP54，消耗MP49，施法速度1，持續30秒。" },
        { "effect": "消耗HP: 52, 消耗MP: 47, 施法速度: 1, 持續時間: 40秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級4效果：消耗HP52，消耗MP47，施法速度1，持續40秒。" },
        { "effect": "消耗HP: 50, 消耗MP: 45, 施法速度: 1, 持續時間: 50秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級5效果：消耗HP50，消耗MP45，施法速度1，持續50秒。" },
        { "effect": "消耗HP: 48, 消耗MP: 43, 施法速度: 1, 持續時間: 60秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級6效果：消耗HP48，消耗MP43，施法速度1，持續60秒。" },
        { "effect": "消耗HP: 46, 消耗MP: 41, 施法速度: 1, 持續時間: 70秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級7效果：消耗HP46，消耗MP41，施法速度1，持續70秒。" },
        { "effect": "消耗HP: 44, 消耗MP: 39, 施法速度: 1, 持續時間: 80秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級8效果：消耗HP44，消耗MP39，施法速度1，持續80秒。" },
        { "effect": "消耗HP: 42, 消耗MP: 37, 施法速度: 1, 持續時間: 90秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級9效果：消耗HP42，消耗MP37，施法速度1，持續90秒。" },
        { "effect": "消耗HP: 40, 消耗MP: 35, 施法速度: 1, 持續時間: 100秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級10效果：消耗HP40，消耗MP35，施法速度1，持續100秒。" },
        { "effect": "消耗HP: 39, 消耗MP: 34, 施法速度: 2, 持續時間: 110秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級11效果：消耗HP39，消耗MP34，施法速度2，持續110秒。" },
        { "effect": "消耗HP: 38, 消耗MP: 33, 施法速度: 2, 持續時間: 120秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級12效果：消耗HP38，消耗MP33，施法速度2，持續120秒。" },
        { "effect": "消耗HP: 34, 消耗MP: 29, 施法速度: 2, 持續時間: 130秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級13效果：消耗HP34，消耗MP29，施法速度2，持續130秒。" },
        { "effect": "消耗HP: 32, 消耗MP: 27, 施法速度: 2, 持續時間: 140秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級14效果：消耗HP32，消耗MP27，施法速度2，持續140秒。" },
        { "effect": "消耗HP: 30, 消耗MP: 25, 施法速度: 2, 持續時間: 150秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級15效果：消耗HP30，消耗MP25，施法速度2，持續150秒。" },
        { "effect": "消耗HP: 28, 消耗MP: 23, 施法速度: 2, 持續時間: 160秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級16效果：消耗HP28，消耗MP23，施法速度2，持續160秒。" },
        { "effect": "消耗HP: 26, 消耗MP: 21, 施法速度: 2, 持續時間: 170秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級17效果：消耗HP26，消耗MP21，施法速度2，持續170秒。" },
        { "effect": "消耗HP: 24, 消耗MP: 19, 施法速度: 2, 持續時間: 180秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級18效果：消耗HP24，消耗MP19，施法速度2，持續180秒。" },
        { "effect": "消耗HP: 22, 消耗MP: 17, 施法速度: 2, 持續時間: 190秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級19效果：消耗HP22，消耗MP17，施法速度2，持續190秒。" },
        { "effect": "消耗HP: 20, 消耗MP: 15, 施法速度: 2, 持續時間: 200秒", "fullDescription": "消耗自身的HP及MP，縮短使用攻擊性魔法的施法速度。等級20效果：消耗HP20，消耗MP15，施法速度2，持續200秒。" }
    ]
},
                        {
                            id: "iceLightningStrike",
                            name: "冰雷合擊",
                            maxLevel: 30,
                            requiredLevel: 70,
                            preRequisite: {},
                            description: "混合冰、雷屬性的魔法，攻擊一個怪物。對冰、雷屬性為弱點的怪物將可能造成致命性的傷害，並且以一定的機率會使怪物變成凍結狀態。",
                            imageUrl: "images/iceLightningStrike.png",
                            levels: Array(31).fill(null).map((_, i) => {
                                const mp = i <= 10 ? 14 : (i <= 20 ? 18 : 22);
                                const attack = i === 1 ? 110 : (i === 30 ? 170 : (79 + i));
                                const freezeDuration = i <= 15 ? 1 : 2;
                                const mastery = 15 + (i > 3 ? Math.floor((i - 1) / 3) * 5 : 0);
                                return i === 0 ? null : {
                                    effect: `消耗MP: ${mp}, 攻擊力: ${attack}, 冰凍時間: ${freezeDuration}秒, 熟練度: ${mastery}%`,
                                    fullDescription: `混合冰、雷屬性的魔法，攻擊一個怪物。等級${i}效果：消耗MP${mp}，攻擊力${attack}，冰凍時間${freezeDuration}秒，熟練度${mastery}%。`
                                };
                            })
                        },
                        {
                            id: "iceLightningResistance",
                            name: "冰雷抵抗",
                            maxLevel: 20,
                            requiredLevel: 70,
                            preRequisite: {},
                            description: "提高對冰、雷屬性魔法攻擊的抗性。",
                            imageUrl: "images/iceLightningResistance.png",
                            levels: Array(21).fill(null).map((_, i) => i === 0 ? null : {
                                effect: `抗性增加: ${0 + i * 3}%`,
                                fullDescription: `提高對冰、雷屬性魔法攻擊的抗性。等級${i}效果：抗性增加${0 + i * 3}%。`
                            })
                        },
                        {
                            id: "iceStorm",
                            name: "冰風暴",
                            maxLevel: 30,
                            requiredLevel: 70,
                            preRequisite: {},
                            description: "召喚出尖銳的冰塊，對周圍的敵人發動攻擊。非冰屬性的怪物被攻擊到時會有暫時凍結的效果，最多一次可攻擊6個怪物。",
                            imageUrl: "images/iceStorm.png",
                            levels: Array(31).fill(null).map((_, i) => {
                                const mp = 20 + i;
                                const attack = i === 29 ? 111 : (i === 30 ? 115 : (30 + i * 2));
                                const freezeDuration = i <= 15 ? 1 : 2;
                                const mastery = 15 + Math.floor((i - 1) / 3) * 5;
                                const range = 100 + i * 3;
                                return i === 0 ? null : {
                                    effect: `消耗MP: ${mp}, 攻擊力: ${attack}, 凍結時間: ${freezeDuration}秒, 熟練度: ${mastery}%, 攻擊範圍: ${range}%`,
                                    fullDescription: `召喚出尖銳的冰塊，對周圍的敵人發動攻擊。等級${i}效果：消耗MP${mp}，攻擊力${attack}，凍結時間${freezeDuration}秒，熟練度${mastery}%，攻擊範圍${range}%。`
                                };
                            })
                        },
                        {
                            id: "lightningOrb",
                            name: "落雷凝聚",
                            maxLevel: 30,
                            requiredLevel: 70,
                            preRequisite: {},
                            description: "集結雷電的力量，對單一敵人發動強力的雷屬性攻擊。",
                            imageUrl: "images/lightningOrb.png",
                            levels: Array(31).fill(null).map((_, i) => {
                                const mp = i <= 3 ? 10 : (i <= 12 ? 10 + Math.floor((i - 4) / 3) : (i <= 21 ? 15 + Math.floor((i - 13) / 3) : 22 + Math.floor((i - 22) / 3)));
                                const attack = i === 1 ? 84 : (i === 30 ? 200 : (79 + i * 3));
                                const mastery = 15 + Math.floor((i - 1) / 3) * 5;
                                return i === 0 ? null : {
                                    effect: `消耗MP: ${mp}, 攻擊力: ${attack}, 熟練度: ${mastery}%`,
                                    fullDescription: `集結雷電的力量，對單一敵人發動強力的雷屬性攻擊。等級${i}效果：消耗MP${mp}，攻擊力${attack}，熟練度${mastery}%。`
                                };
                            })
                        }
                    ],
                    "4轉 (冰雷大魔導)": [],
                    "超技能": [],
                    "5轉技能": [],
                    "共通技能": []
                }
            },
            "英雄 (Hero)": {
        startingLevelForSp: 10, // 劍士系通常10等轉職
        jobAdvancementSpBonuses: [10, 30, 70, 120],
        jobStagesOrder: ["0轉 (新手)", "1轉 (劍士)", "2轉 (狂戰士)", "3轉 (十字軍)", "4轉 (英雄)", "超技能", "5轉技能", "共通技能"],
                spRequiredFor2ndJob: 61, // 其他職業2轉點數需求
                spRequiredFor3rdJob: 182, // 其他職業3轉點數需求
                spRequiredFor4thJob: 249, // 4轉通用點數需求        
skills: {
            "0轉 (新手)": [],
            "1轉 (劍士)": [
                {
                    id: "hpRecovery",
                    name: "生命淨化",
                    maxLevel: 16,
                    requiredLevel: 10,
                    preRequisite: {},
                    description: "自我恢复时能回复更多HP。移動中可恢復",
                    imageUrl: "images/hpRecovery.png",
                    levels: Array(17).fill(null).map((_, i) => i === 0 ? null : {
                        effect: `回復量: ${i * 3}`,
                        fullDescription: `自我恢復時能回復更多HP。移動中可恢復。等級${i}效果：回復量${i * 3}。`
                    })
                },
                {
                    id: "hpBoost",
                    name: "生命擴展",
                    maxLevel: 10,
                    requiredLevel: 10,
                    preRequisite: {"hpRecovery":5},
                    description: "等級上升或使用升級點(AP)數增加HP的增血量。",
                    imageUrl: "images/hpBoost.png",
                    levels: Array(11).fill(null).map((_, i) => i === 0 ? null : {
                        effect: `升級血量: ${i * 4}`,
                        fullDescription: `等級上升或使用升級點(AP)數增加HP的增血量。等級${i}效果：升級血量${i * 4}。`
                    })
                },
                {
                    id: "hpRestore",
                    name: "生命恢復",
                    maxLevel: 8,
                    requiredLevel: 10,
                    preRequisite: { "hpRecovery": 5, "hpBoost": 3 },
                    description: "提升自我恢復HP。可與生命淨化疊加。",
                    imageUrl: "images/hpRestore.png",
                    levels: Array(9).fill(null).map((_, i) => i === 0 ? null : {
                        effect: `HP追加恢復: ${i * 4}`,
                        fullDescription: `提升自我恢復HP。可與生命淨化疊加。等級${i}效果：HP追加恢復${i * 4}。`
                    })
                },
                {
                    id: "ironBody",
                    name: "自身強化",
                    maxLevel: 20,
                    requiredLevel: 10,
                    preRequisite: { "hpRecovery": 5, "hpBoost": 3, "hpRestore": 3 },
                    description: "一定時間內增加物理防禦力。",
                    imageUrl: "images/ironBody.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, def, speed, duration;
                        if (i === 0) return null;
                        const mpCosts = [null, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15];
                        const defs = [null, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40];
                        const speeds = [null, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10];
                        const durations = [null, 75, 30, 45, 60, 75, 90, 105, 120, 135, 150, 165, 180, 195, 210, 225, 240, 255, 270, 285, 300];
                        mp = mpCosts[i];
                        def = defs[i];
                        speed = speeds[i];
                        duration = durations[i];
                        return {
                            effect: `消耗MP: ${mp}, 防禦力: ${def}, 移動速度: ${speed}, 持續時間: ${duration}秒`,
                            fullDescription: `一定時間內增加物理防禦力。等級${i}效果：消耗MP${mp}，防禦力${def}，移動速度${speed}，持續${duration}秒。`
                        };
                    })
                },
                {
                    id: "slashBlast",
                    name: "魔天一擊",
                    maxLevel: 20,
                    requiredLevel: 10,
                    preRequisite: {},
                    description: "消耗MP，給予怪物強力一擊。",
                    imageUrl: "images/slashBlast.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, attack;
                        if (i === 0) return null;
                        const mpCosts = [null, 4, 4, 4, 4, 5, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12];
                        const attacks = [null, 114, 120, 126, 132, 142, 148, 154, 164, 170, 180, 186, 196, 202, 212, 218, 228, 234, 244, 250, 260];
                        mp = mpCosts[i];
                        attack = attacks[i];
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%`,
                            fullDescription: `消耗MP，給予怪物強力一擊。等級${i}效果：消耗MP${mp}，攻擊力${attack}%。`
                        };
                    })
                },
                {
                    id: "powerStrike",
                    name: "劍氣縱橫",
                    maxLevel: 20,
                    requiredLevel: 10,
                    preRequisite: {"slashBlast":1},
                    description: "消耗HP和MP，同時攻擊周遭的多個怪物。",
                    imageUrl: "images/powerStrike.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let hp, mp, attack;
                        if (i === 0) return null;
                        const hpCosts = [null, 8, 8, 8, 8, 9, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, 14, 14, 15, 15, 16];
                        const mpCosts = [null, 6, 6, 6, 6, 7, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, 14];
                        const attacks = [null, 57, 60, 63, 66, 71, 74, 77, 85, 88, 93, 96, 101, 104, 109, 112, 117, 120, 122, 125, 130];
                        hp = hpCosts[i];
                        mp = mpCosts[i];
                        attack = attacks[i];
                        return {
                            effect: `消耗HP: ${hp}, 消耗MP: ${mp}, 攻擊力: ${attack}%`,
                            fullDescription: `消耗HP和MP，同時攻擊周遭的多個怪物。等級${i}效果：消耗HP${hp}，消耗MP${mp}，攻擊力${attack}%。`
                        };
                    })
                }
            ],
            "2轉 (狂戰士)": [
                {
                    id: "swordMastery",
                    name: "精準之劍",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "提升劍系武器的命中率及熟練度，此技能必須是使用單手劍或雙手劍的情況下，才能發揮作用。",
                    imageUrl: "images/swordMastery.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let hitRate, mastery;
                        if (i === 0) return null;
                        const hitRates = [null, 1, 2, 3, 4, 5, 6, 6, 8, 8, 10, 10, 12, 12, 14, 14, 16, 16, 18, 19, 20];
                        const masteries = [null, 15, 15, 20, 20, 25, 25, 25, 30, 30, 35, 35, 40, 40, 45, 45, 50, 50, 55, 60, 60];
                        hitRate = hitRates[i];
                        mastery = masteries[i];
                        return {
                            effect: `命中率: ${hitRate}, 熟練度: ${mastery}%`,
                            fullDescription: `提升劍系武器的命中率及熟練度，此技能必須是使用單手劍或雙手劍的情況下，才能發揮作用。等級${i}效果：命中率${hitRate}，熟練度${mastery}%。`
                        };
                    })
                },
                {
                    id: "axeMastery",
                    name: "精準之斧",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "提升斧系武器的命中率及熟練度，此技能必須是使用單手斧或雙手斧的情況下，才會發揮作用。",
                    imageUrl: "images/axeMastery.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let hitRate, mastery;
                        if (i === 0) return null;
                        const hitRates = [null, 1, 2, 3, 4, 5, 6, 6, 8, 8, 10, 10, 12, 12, 14, 14, 16, 16, 18, 19, 20];
                        const masteries = [null, 15, 15, 20, 20, 25, 25, 25, 30, 30, 35, 35, 40, 40, 45, 45, 50, 50, 55, 60, 60];
                        hitRate = hitRates[i];
                        mastery = masteries[i];
                        return {
                            effect: `命中率: ${hitRate}, 熟練度: ${mastery}%`,
                            fullDescription: `提升斧系武器的命中率及熟練度，此技能必須是使用單手斧或雙手斧的情況下，才會發揮作用。等級${i}效果：命中率${hitRate}，熟練度${mastery}%。`
                        };
                    })
                },
                {
                    id: "swordBooster",
                    name: "快速之劍",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: { "swordMastery": 5 },
                    description: "消耗HP與MP，將使用刀劍的攻擊速度，向上提升一個等級。此技能必須是使用單手劍或雙手劍的情況下，才能發揮作用。",
                    imageUrl: "images/swordBooster.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, hp, duration;
                        if (i === 0) return null;
                        const mpCosts = [null, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10];
                        const hpCosts = [null, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10];
                        const durations = [null, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 120, 140, 160, 180, 200, 220, 240, 260, 280, 300];
                        mp = mpCosts[i];
                        hp = hpCosts[i];
                        duration = durations[i];
                        return {
                            effect: `消耗MP: ${mp}, 消耗HP: ${hp}, 持續時間: ${duration}秒`,
                            fullDescription: `消耗HP與MP，將使用刀劍的攻擊速度，向上提升一個等級。此技能必須是使用單手劍或雙手劍的情況下，才能發揮作用。等級${i}效果：消耗MP${mp}，消耗HP${hp}，持續${duration}秒。`
                        };
                    })
                },
                {
                    id: "axeBooster",
                    name: "快速之斧",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: { "axeMastery": 5 },
                    description: "消耗HP與MP，將使用斧頭的攻擊速度，向上提升一個等級。此技能必須是使用單手斧或雙手斧的情況下，才能發揮作用。",
                    imageUrl: "images/axeBooster.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, hp, duration;
                        if (i === 0) return null;
                        const mpCosts = [null, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10];
                        const hpCosts = [null, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10];
                        const durations = [null, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 120, 140, 160, 180, 200, 220, 240, 260, 280, 300];
                        mp = mpCosts[i];
                        hp = hpCosts[i];
                        duration = durations[i];
                        return {
                            effect: `消耗MP: ${mp}, 消耗HP: ${hp}, 持續時間: ${duration}秒`,
                            fullDescription: `消耗HP與MP，將使用斧頭的攻擊速度，向上提升一個等級。此技能必須是使用單手斧或雙手斧的情況下，才能發揮作用。等級${i}效果：消耗MP${mp}，消耗HP${hp}，持續${duration}秒。`
                        };
                    })
                },
                {
                    id: "finalAttackSword",
                    name: "終極之劍",
                    maxLevel: 30,
                    requiredLevel: 30,
                    preRequisite: { "swordMastery": 3 },
                    description: "按照一定機率，在使用攻擊技能後發動連續攻擊。此技能必須是使用單手劍或雙手劍的情況下，才能發揮作用。",
                    imageUrl: "images/finalAttackSword.png",
                    levels: Array(31).fill(null).map((_, i) => {
                        let procRate, attack;
                        if (i === 0) return null;
                        const procRates = [null, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60];
                        const attacks = [null, 105, 110, 115, 120, 125, 130, 135, 140, 145, 150, 155, 160, 165, 170, 175, 180, 185, 10, 195, 200, 205, 210, 215, 220, 225, 230, 235, 240, 245, 250]; // Level 18 attack is 10% as provided
                        procRate = procRates[i];
                        attack = attacks[i];
                        return {
                            effect: `發動率: ${procRate}%, 攻擊力: ${attack}%`,
                            fullDescription: `按照一定機率，在使用攻擊技能後發動連續攻擊。此技能必須是使用單手劍或雙手劍的情況下，才能發揮作用。等級${i}效果：發動率${procRate}%，攻擊力${attack}%。`
                        };
                    })
                },
                {
                    id: "finalAttackAxe",
                    name: "終極之斧",
                    maxLevel: 30,
                    requiredLevel: 30,
                    preRequisite: { "axeMastery": 3 },
                    description: "按照一定機率，在使用攻擊技能後發動連續攻擊。此技能必須是使用單手斧或雙手斧的情況下，才能發揮作用。",
                    imageUrl: "images/finalAttackAxe.png",
                    levels: Array(31).fill(null).map((_, i) => {
                        let procRate, attack;
                        if (i === 0) return null;
                        const procRates = [null, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60];
                        const attacks = [null, 105, 110, 115, 120, 125, 130, 135, 140, 145, 150, 155, 160, 165, 170, 175, 180, 185, 10, 195, 200, 205, 210, 215, 220, 225, 230, 235, 240, 245, 250]; // Level 18 attack is 10% as provided
                        procRate = procRates[i];
                        attack = attacks[i];
                        return {
                            effect: `發動率: ${procRate}%, 攻擊力: ${attack}%`,
                            fullDescription: `按照一定機率，在使用攻擊技能後發動連續攻擊。此技能必須是使用單手斧或雙手斧的情況下，才能發揮作用。等級${i}效果：發動率${procRate}%，攻擊力${attack}%。`
                        };
                    })
                },
                {
    "id": "rage",
    "name": "激勵",
    "maxLevel": 20,
    "requiredLevel": 30,
    "preRequisite": {},
    "description": "在一定時間內，提升周圍組員的物理攻擊力，但物理防禦力會相對下降。",
    "imageUrl": "images/rage.png",
    "levels": Array(21).fill(null).map((_, i) => {
        let mpCost, pAttack, pDef, duration;
        if (i === 0) return null;

        // 消耗MP 的規律
        // 1-10級: 12
        // 11-20級: 20
        if (i >= 1 && i <= 10) {
            mpCost = 12;
        } else if (i >= 11 && i <= 20) {
            mpCost = 20;
        }

        // 物理攻擊 和 物理防禦 的規律：
        // 攻擊力從1到10，防禦力從-1到-10
        // 1-10級: 攻擊力 i/2 (向下取整再根據數據調整), 防禦力 -i/2 (向下取整再根據數據調整)
        // 11-20級: 攻擊力從6到10，防禦力從-6到-10 (根據數據)
        // 這裡直接使用數據中觀察到的線性關係
        pAttack = Math.floor((i + 1) / 2); // 攻擊力
        if (i % 2 === 0) pAttack = Math.floor(i / 2); // 為了讓1,2級都為1，3,4級都為2，etc.
        if (i >= 1 && i <= 10) {
             pAttack = Math.ceil(i / 2); // 1,1,2,2,3,3,4,4,5,5
        } else { // i >= 11
             pAttack = Math.ceil((i - 10) / 2) + 5; // 從6開始
        }
        // 根據提供的數據硬編碼攻擊力和防禦力，以確保精確性
        const pAttacksRaw = [null, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10];
        pAttack = pAttacksRaw[i];
        pDef = -pAttack; // 物理防禦是物理攻擊力的負數

        // 持續時間 的規律：每級加10秒
        duration = i * 10 + 100; // 等級1是110秒，所以是 (100 + 10)

        return {
            effect: `消耗MP: ${mpCost}, 物理攻擊: ${pAttack}, 物理防禦: ${pDef}, 持續時間: ${duration}秒`,
            fullDescription: `在一定時間內，提升周圍組員的物理攻擊力，但物理防禦力會相對下降。等級${i}效果：消耗MP${mpCost}，物理攻擊${pAttack}，物理防禦${pDef}，持續時間${duration}秒。`
        };
    })
},
                {
    "id": "powerReflection",
    "name": "反射之盾",
    "maxLevel": 30,
    "requiredLevel": 30,
    "preRequisite": {},
    "description": "將怪物對自身傷害的一定量回饋給怪物，但所能轉移給怪物的傷害，以怪物的最大HP10%為限度。",
    "imageUrl": "images/powerReflection.png",
    "levels": Array(31).fill(null).map((_, i) => {
        let mpCost, counterRate, duration;
        if (i === 0) return null;

        // 消耗MP 的規律
        if (i >= 1 && i <= 15) {
            mpCost = 15;
        } else { // i >= 16
            mpCost = 50;
        }

        // 反擊率 的規律：線性增加 (11% 到 40%) => 10 + i
        counterRate = 10 + i;

        // 持續時間 的規律：多段線性
        if (i >= 1 && i <= 15) {
            duration = i * 3;
        } else if (i >= 16 && i <= 20) {
            duration = 45 + (i - 15) * 3; // 從15級的45秒開始計算
        } else if (i >= 21 && i <= 28) {
            duration = 60 + (i - 20) * 30; // 20級是60秒，21級跳到90秒，每級加30秒
        } else { // i >= 29
            duration = 300; // 29和30級固定300秒
        }

        return {
            effect: `消耗MP: ${mpCost}, 反擊率: ${counterRate}%, 持續時間: ${duration}秒`,
            fullDescription: `將怪物對自身傷害的一定量回饋給怪物，但所能轉移給怪物的傷害，以怪物的最大HP10%為限度。等級${i}效果：消耗MP${mpCost}，反擊率${counterRate}%，持續${duration}秒。`
        };
    })
}
            ],
            "3轉 (十字軍)": [
                {
                    id: "mpRecoveryHero",
                    name: "魔力恢復",
                    maxLevel: 20,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "增加每10秒的MP恢復量。",
                    imageUrl: "images/mpRecoveryHero.png",
                    levels: Array(21).fill(null).map((_, i) => i === 0 ? null : {
                        effect: `回復量: ${i * 2}`,
                        fullDescription: `增加每10秒的MP恢復量。等級${i}效果：回復量${i * 2}。`
                    })
                },
                {
                    id: "shieldMastery",
                    name: "盾防精通",
                    maxLevel: 20,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "提升所佩帶的盾牌的防禦力，若未佩帶盾牌便不會產生效果。",
                    imageUrl: "images/shieldMastery.png",
                    levels: Array(21).fill(null).map((_, i) => i === 0 ? null : {
                        effect: `盾牌防禦: ${100 + i * 5}%`,
                        fullDescription: `提升所佩帶的盾牌的防禦力，若未佩帶盾牌便不會產生效果。等級${i}效果：盾牌防禦${100 + i * 5}%。`
                    })
                },
                {
                    id: "combatMastery",
                    name: "鬥氣集中",
                    maxLevel: 30,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "集中全身的鬥氣，使角色成為可集中鬥氣的狀態，每次進行攻擊時便會提升鬥氣，最多可集中到5個鬥氣，鬥氣集中後可大幅提升一般攻擊與技能攻擊的殺傷力，並且可消耗全部鬥氣施展黑暗之劍與氣絕劍。",
                    imageUrl: "images/combatMastery.png",
                    levels: Array(31).fill(null).map((_, i) => {
                        let mp, attack, comboCount, duration;
                        if (i === 0) return null;
                        mp = i <= 10 ? 25 : (i <= 20 ? 30 : 35);
                        attack = 100 + i * 4; // Simplified
                        comboCount = i <= 10 ? 3 : (i <= 20 ? 4 : 5);
                        duration = 100 + (i > 5 ? Math.floor((i - 1) / 5) * 20 : 0); // Simplified
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%, 連擊數量: ${comboCount}, 持續時間: ${duration}秒`,
                            fullDescription: `集中全身的鬥氣，使角色成為可集中鬥氣的狀態，每次進行攻擊時便會提升鬥氣，最多可集中到5個鬥氣，鬥氣集中後可大幅提升一般攻擊與技能攻擊的殺傷力，並且可消耗全部鬥氣施展黑暗之劍與氣絕劍。等級${i}效果：消耗MP${mp}，攻擊力${attack}%，連擊數量${comboCount}，持續時間${duration}秒。`
                        };
                    })
                },
                {
                    id: "brandishSword",
                    name: "黑暗之劍",
                    maxLevel: 30,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "對單一敵人發動黑暗狀態攻擊，但必須裝備劍，且需處於鬥氣集中的狀態下才能使用。",
                    imageUrl: "images/brandishSword.png",
                    levels: Array(31).fill(null).map((_, i) => {
                        let mp, attack, darkChance;
                        if (i === 0) return null;
                        mp = i <= 10 ? 10 : (i <= 20 ? 17 : 24);
                        attack = 149 + i * 7; // Simplified
                        darkChance = 30 + i * 2; // Simplified
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%, 黑暗機率: ${darkChance}%`,
                            fullDescription: `對單一敵人發動黑暗狀態攻擊，但必須裝備劍，且需處於鬥氣集中的狀態下才能使用。等級${i}效果：消耗MP${mp}，攻擊力${attack}%，黑暗機率${darkChance}%。`
                        };
                    })
                },
                {
                    id: "brandishAxe",
                    name: "黑暗之斧",
                    maxLevel: 30,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "對單一敵人發動黑暗狀態攻擊，但必須裝備斧，且需處於鬥氣集中的狀態下才能使用。",
                    imageUrl: "images/brandishAxe.png",
                    levels: Array(31).fill(null).map((_, i) => {
                        let mp, attack, darkChance;
                        if (i === 0) return null;
                        mp = i <= 10 ? 10 : (i <= 20 ? 17 : 24);
                        attack = 149 + i * 7; // Simplified
                        darkChance = 30 + i * 2; // Simplified
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%, 黑暗機率: ${darkChance}%`,
                            fullDescription: `對單一敵人發動黑暗狀態攻擊，但必須裝備斧，且需處於鬥氣集中的狀態下才能使用。等級${i}效果：消耗MP${mp}，攻擊力${attack}%，黑暗機率${darkChance}%。`
                        };
                    })
                },
                {
                    id: "panicSword",
                    name: "氣絕劍",
                    maxLevel: 30,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "對週遭怪物發動攻擊使對方昏迷，但必須裝備劍，且需處於鬥氣集中的狀態下才能使用。",
                    imageUrl: "images/panicSword.png",
                    levels: Array(31).fill(null).map((_, i) => {
                        let hp, mp, attack, stunChance;
                        if (i === 0) return null;
                        hp = i <= 10 ? 15 : (i <= 20 ? 20 : 25);
                        mp = i <= 10 ? 12 : (i <= 20 ? 17 : 26);
                        attack = 80 + i * 4; // Simplified
                        stunChance = 30 + i * 2; // Simplified
                        return {
                            effect: `消耗HP: ${hp}, 消耗MP: ${mp}, 攻擊力: ${attack}%, 昏迷機率: ${stunChance}%`,
                            fullDescription: `對週遭怪物發動攻擊使對方昏迷，但必須裝備劍，且需處於鬥氣集中的狀態下才能使用。等級${i}效果：消耗HP${hp}，消耗MP${mp}，攻擊力${attack}%，昏迷機率${stunChance}%。`
                        };
                    })
                },
                {
                    id: "panicAxe",
                    name: "氣絕斧",
                    maxLevel: 30,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "對週遭怪物發動攻擊使對方昏迷，但必須裝備斧，且需處於鬥氣集中的狀態下才能使用。",
                    imageUrl: "images/panicAxe.png",
                    levels: Array(31).fill(null).map((_, i) => {
                        let hp, mp, attack, stunChance;
                        if (i === 0) return null;
                        hp = i <= 10 ? 15 : (i <= 20 ? 20 : 25);
                        mp = i <= 10 ? 12 : (i <= 20 ? 17 : 26);
                        attack = 80 + i * 4; // Simplified
                        stunChance = 30 + i * 2; // Simplified
                        return {
                            effect: `消耗HP: ${hp}, 消耗MP: ${mp}, 攻擊力: ${attack}%, 昏迷機率: ${stunChance}%`,
                            fullDescription: `對週遭怪物發動攻擊使對方昏迷，但必須裝備斧，且需處於鬥氣集中的狀態下才能使用。等級${i}效果：消耗HP${hp}，消耗MP${mp}，攻擊力${attack}%，昏迷機率${stunChance}%。`
                        };
                    })
                },
                {
    "id": "tigerOfFury",
    "name": "虎咆哮",
    "maxLevel": 30,
    "requiredLevel": 70,
    "preRequisite": {},
    "description": "對周邊怪物發出虎吼並加以給予傷害，同時並以一定機率使其昏迷。該技能一次最多僅能攻擊6隻怪物。",
    "imageUrl": "images/tigerOfFury.png",
    "levels": [
        null,
        { "effect": "消耗MP: 8, 昏迷機率: 52%, 攻擊力: 11%, 持續時間: 5秒, 攻擊範圍: 110%", "fullDescription": "對周邊怪物發出虎吼並加以給予傷害，同時並以一定機率使其昏迷。等級1效果：消耗MP8，昏迷機率52%，攻擊力11%，持續5秒，攻擊範圍110%。" },
        { "effect": "消耗MP: 8, 昏迷機率: 54%, 攻擊力: 12%, 持續時間: 5秒, 攻擊範圍: 110%", "fullDescription": "對周邊怪物發出虎吼並加以給予傷害，同時並以一定機率使其昏迷。等級2效果：消耗MP8，昏迷機率54%，攻擊力12%，持續5秒，攻擊範圍110%。" },
        { "effect": "消耗MP: 8, 昏迷機率: 56%, 攻擊力: 13%, 持續時間: 5秒, 攻擊範圍: 110%", "fullDescription": "對周邊怪物發出虎吼並加以給予傷害，同時並以一定機率使其昏迷。等級3效果：消耗MP8，昏迷機率56%，攻擊力13%，持續5秒，攻擊範圍110%。" },
        { "effect": "消耗MP: 8, 昏迷機率: 58%, 攻擊力: 14%, 持續時間: 5秒, 攻擊範圍: 120%", "fullDescription": "對周邊怪物發出虎吼並加以給予傷害，同時並以一定機率使其昏迷。等級4效果：消耗MP8，昏迷機率58%，攻擊力14%，持續5秒，攻擊範圍120%。" },
        { "effect": "消耗MP: 8, 昏迷機率: 60%, 攻擊力: 15%, 持續時間: 5秒, 攻擊範圍: 120%", "fullDescription": "對周邊怪物發出虎吼並加以給予傷害，同時並以一定機率使其昏迷。等級5效果：消耗MP8，昏迷機率60%，攻擊力15%，持續5秒，攻擊範圍120%。" },
        { "effect": "消耗MP: 8, 昏迷機率: 62%, 攻擊力: 16%, 持續時間: 6秒, 攻擊範圍: 120%", "fullDescription": "對周邊怪物發出虎吼並加以給予傷害，同時並以一定機率使其昏迷。等級6效果：消耗MP8，昏迷機率62%，攻擊力16%，持續6秒，攻擊範圍120%。" },
        { "effect": "消耗MP: 8, 昏迷機率: 64%, 攻擊力: 17%, 持續時間: 6秒, 攻擊範圍: 130%", "fullDescription": "對周邊怪物發出虎吼並加以給予傷害，同時並以一定機率使其昏迷。等級7效果：消耗MP8，昏迷機率64%，攻擊力17%，持續6秒，攻擊範圍130%。" },
        { "effect": "消耗MP: 8, 昏迷機率: 66%, 攻擊力: 18%, 持續時間: 6秒, 攻擊範圍: 130%", "fullDescription": "對周邊怪物發出虎吼並加以給予傷害，同時並以一定機率使其昏迷。等級8效果：消耗MP8，昏迷機率66%，攻擊力18%，持續6秒，攻擊範圍130%。" },
        { "effect": "消耗MP: 8, 昏迷機率: 68%, 攻擊力: 19%, 持續時間: 6秒, 攻擊範圍: 130%", "fullDescription": "對周邊怪物發出虎吼並加以給予傷害，同時並以一定機率使其昏迷。等級9效果：消耗MP8，昏迷機率68%，攻擊力19%，持續6秒，攻擊範圍130%。" },
        { "effect": "消耗MP: 8, 昏迷機率: 70%, 攻擊力: 20%, 持續時間: 6秒, 攻擊範圍: 140%", "fullDescription": "對周邊怪物發出虎吼並加以給予傷害，同時並以一定機率使其昏迷。等級10效果：消耗MP8，昏迷機率70%，攻擊力20%，持續6秒，攻擊範圍140%。" },
        { "effect": "消耗MP: 12, 昏迷機率: 72%, 攻擊力: 20%, 持續時間: 7秒, 攻擊範圍: 140%", "fullDescription": "對周邊怪物發出虎吼並加以給予傷害，同時並以一定機率使其昏迷。等級11效果：消耗MP12，昏迷機率72%，攻擊力20%，持續7秒，攻擊範圍140%。" },
        { "effect": "消耗MP: 12, 昏迷機率: 74%, 攻擊力: 21%, 持續時間: 7秒, 攻擊範圍: 140%", "fullDescription": "對周邊怪物發出虎吼並加以給予傷害，同時並以一定機率使其昏迷。等級12效果：消耗MP12，昏迷機率74%，攻擊力21%，持續7秒，攻擊範圍140%。" },
        { "effect": "消耗MP: 12, 昏迷機率: 76%, 攻擊力: 21%, 持續時間: 7秒, 攻擊範圍: 150%", "fullDescription": "對周邊怪物發出虎吼並加以給予傷害，同時並以一定機率使其昏迷。等級13效果：消耗MP12，昏迷機率76%，攻擊力21%，持續7秒，攻擊範圍150%。" },
        { "effect": "消耗MP: 12, 昏迷機率: 78%, 攻擊力: 22%, 持續時間: 7秒, 攻擊範圍: 150%", "fullDescription": "對周邊怪物發出虎吼並加以給予傷害，同時並以一定機率使其昏迷。等級14效果：消耗MP12，昏迷機率78%，攻擊力22%，持續7秒，攻擊範圍150%。" },
        { "effect": "消耗MP: 12, 昏迷機率: 80%, 攻擊力: 22%, 持續時間: 7秒, 攻擊範圍: 150%", "fullDescription": "對周邊怪物發出虎吼並加以給予傷害，同時並以一定機率使其昏迷。等級15效果：消耗MP12，昏迷機率80%，攻擊力22%，持續7秒，攻擊範圍150%。" },
        { "effect": "消耗MP: 12, 昏迷機率: 81%, 攻擊力: 23%, 持續時間: 8秒, 攻擊範圍: 160%", "fullDescription": "對周邊怪物發出虎吼並加以給予傷害，同時並以一定機率使其昏迷。等級16效果：消耗MP12，昏迷機率81%，攻擊力23%，持續8秒，攻擊範圍160%。" },
        { "effect": "消耗MP: 12, 昏迷機率: 82%, 攻擊力: 23%, 持續時間: 8秒, 攻擊範圍: 160%", "fullDescription": "對周邊怪物發出虎吼並加以給予傷害，同時並以一定機率使其昏迷。等級17效果：消耗MP12，昏迷機率82%，攻擊力23%，持續8秒，攻擊範圍160%。" },
        { "effect": "消耗MP: 12, 昏迷機率: 83%, 攻擊力: 24%, 持續時間: 8秒, 攻擊範圍: 160%", "fullDescription": "對周邊怪物發出虎吼並加以給予傷害，同時並以一定機率使其昏迷。等級18效果：消耗MP12，昏迷機率83%，攻擊力24%，持續8秒，攻擊範圍160%。" },
        { "effect": "消耗MP: 12, 昏迷機率: 84%, 攻擊力: 24%, 持續時間: 8秒, 攻擊範圍: 170%", "fullDescription": "對周邊怪物發出虎吼並加以給予傷害，同時並以一定機率使其昏迷。等級19效果：消耗MP12，昏迷機率84%，攻擊力24%，持續8秒，攻擊範圍170%。" },
        { "effect": "消耗MP: 12, 昏迷機率: 85%, 攻擊力: 25%, 持續時間: 8秒, 攻擊範圍: 170%", "fullDescription": "對周邊怪物發出虎吼並加以給予傷害，同時並以一定機率使其昏迷。等級20效果：消耗MP12，昏迷機率85%，攻擊力25%，持續8秒，攻擊範圍170%。" },
        { "effect": "消耗MP: 16, 昏迷機率: 86%, 攻擊力: 25%, 持續時間: 9秒, 攻擊範圍: 170%", "fullDescription": "對周邊怪物發出虎吼並加以給予傷害，同時並以一定機率使其昏迷。等級21效果：消耗MP16，昏迷機率86%，攻擊力25%，持續9秒，攻擊範圍170%。" },
        { "effect": "消耗MP: 16, 昏迷機率: 87%, 攻擊力: 26%, 持續時間: 9秒, 攻擊範圍: 180%", "fullDescription": "對周邊怪物發出虎吼並加以給予傷害，同時並以一定機率使其昏迷。等級22效果：消耗MP16，昏迷機率87%，攻擊力26%，持續9秒，攻擊範圍180%。" },
        { "effect": "消耗MP: 16, 昏迷機率: 88%, 攻擊力: 26%, 持續時間: 9秒, 攻擊範圍: 180%", "fullDescription": "對周邊怪物發出虎吼並加以給予傷害，同時並以一定機率使其昏迷。等級23效果：消耗MP16，昏迷機率88%，攻擊力26%，持續9秒，攻擊範圍180%。" },
        { "effect": "消耗MP: 16, 昏迷機率: 89%, 攻擊力: 27%, 持續時間: 9秒, 攻擊範圍: 180%", "fullDescription": "對周邊怪物發出虎吼並加以給予傷害，同時並以一定機率使其昏迷。等級24效果：消耗MP16，昏迷機率89%，攻擊力27%，持續9秒，攻擊範圍180%。" },
        { "effect": "消耗MP: 16, 昏迷機率: 90%, 攻擊力: 27%, 持續時間: 9秒, 攻擊範圍: 190%", "fullDescription": "對周邊怪物發出虎吼並加以給予傷害，同時並以一定機率使其昏迷。等級25效果：消耗MP16，昏迷機率90%，攻擊力27%，持續9秒，攻擊範圍190%。" },
        { "effect": "消耗MP: 16, 昏迷機率: 91%, 攻擊力: 28%, 持續時間: 10秒, 攻擊範圍: 190%", "fullDescription": "對周邊怪物發出虎吼並加以給予傷害，同時並以一定機率使其昏迷。等級26效果：消耗MP16，昏迷機率91%，攻擊力28%，持續10秒，攻擊範圍190%。" },
        { "effect": "消耗MP: 16, 昏迷機率: 92%, 攻擊力: 28%, 持續時間: 10秒, 攻擊範圍: 190%", "fullDescription": "對周邊怪物發出虎吼並加以給予傷害，同時並以一定機率使其昏迷。等級27效果：消耗MP16，昏迷機率92%，攻擊力28%，持續10秒，攻擊範圍190%。" },
        { "effect": "消耗MP: 16, 昏迷機率: 93%, 攻擊力: 29%, 持續時間: 10秒, 攻擊範圍: 200%", "fullDescription": "對周邊怪物發出虎吼並加以給予傷害，同時並以一定機率使其昏迷。等級28效果：消耗MP16，昏迷機率93%，攻擊力29%，持續10秒，攻擊範圍200%。" },
        { "effect": "消耗MP: 16, 昏迷機率: 94%, 攻擊力: 29%, 持續時間: 10秒, 攻擊範圍: 200%", "fullDescription": "對周邊怪物發出虎吼並加以給予傷害，同時並以一定機率使其昏迷。等級29效果：消耗MP16，昏迷機率94%，攻擊力29%，持續10秒，攻擊範圍200%。" },
        { "effect": "消耗MP: 16, 昏迷機率: 95%, 攻擊力: 30%, 持續時間: 10秒, 攻擊範圍: 200%", "fullDescription": "對周邊怪物發出虎吼並加以給予傷害，同時並以一定機率使其昏迷。等級30效果：消耗MP16，昏迷機率95%，攻擊力30%，持續10秒，攻擊範圍200%。" }
    ]
},
                {
                    id: "guardCancel",
                    name: "防禦消除",
                    maxLevel: 20,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "無視怪物防禦力。",
                    imageUrl: "images/guardCancel.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, successRate;
                        if (i === 0) return null;
                        mp = 35 - i * 2; // Simplified
                        successRate = 20 + i * 4; // Simplified
                        return {
                            effect: `消耗MP: ${mp}, 成功率: ${successRate}%`,
                            fullDescription: `無視怪物防禦力。等級${i}效果：消耗MP${mp}，成功率${successRate}%。`
                        };
                    })
                }
            ],
            "4轉 (英雄)": [],
            "超技能": [],
            "5轉技能": [],
            "共通技能": []
        }
    },
            "聖騎士 (Paladin)": {
        startingLevelForSp: 10, // 劍士系通常10等轉職
        jobAdvancementSpBonuses: [10, 30, 70, 120],
        jobStagesOrder: ["0轉 (新手)", "1轉 (劍士)", "2轉 (見習騎士)", "3轉 (騎士)", "4轉 (聖騎士)", "超技能", "5轉技能", "共通技能"],
        spRequiredFor2ndJob: 61, // 其他職業2轉點數需求
        spRequiredFor3rdJob: 182, // 其他職業3轉點數需求
        spRequiredFor4thJob: 249, // 4轉通用點數需求            
skills: {
            "0轉 (新手)": [],
            "1轉 (劍士)": [
                {
                    id: "hpRecovery",
                    name: "生命淨化",
                    maxLevel: 16,
                    requiredLevel: 10,
                    preRequisite: {},
                    description: "自我恢复时能回复更多HP。移動中可恢復",
                    imageUrl: "images/hpRecovery.png",
                    levels: Array(17).fill(null).map((_, i) => i === 0 ? null : {
                        effect: `回復量: ${i * 3}`,
                        fullDescription: `自我恢復時能回復更多HP。移動中可恢復。等級${i}效果：回復量${i * 3}。`
                    })
                },
                {
                    id: "hpBoost",
                    name: "生命擴展",
                    maxLevel: 10,
                    requiredLevel: 10,
                    preRequisite: {"hpRecovery":5},
                    description: "等級上升或使用升級點(AP)數增加HP的增血量。",
                    imageUrl: "images/hpBoost.png",
                    levels: Array(11).fill(null).map((_, i) => i === 0 ? null : {
                        effect: `升級血量: ${i * 4}`,
                        fullDescription: `等級上升或使用升級點(AP)數增加HP的增血量。等級${i}效果：升級血量${i * 4}。`
                    })
                },
                {
                    id: "hpRestore",
                    name: "生命恢復",
                    maxLevel: 8,
                    requiredLevel: 10,
                    preRequisite: { "hpRecovery": 5, "hpBoost": 3 },
                    description: "提升自我恢復HP。可與生命淨化疊加。",
                    imageUrl: "images/hpRestore.png",
                    levels: Array(9).fill(null).map((_, i) => i === 0 ? null : {
                        effect: `HP追加恢復: ${i * 4}`,
                        fullDescription: `提升自我恢復HP。可與生命淨化疊加。等級${i}效果：HP追加恢復${i * 4}。`
                    })
                },
                {
                    id: "ironBody",
                    name: "自身強化",
                    maxLevel: 20,
                    requiredLevel: 10,
                    preRequisite: { "hpRecovery": 5, "hpBoost": 3, "hpRestore": 3 },
                    description: "一定時間內增加物理防禦力。",
                    imageUrl: "images/ironBody.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, def, speed, duration;
                        if (i === 0) return null;
                        const mpCosts = [null, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15];
                        const defs = [null, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40];
                        const speeds = [null, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10];
                        const durations = [null, 75, 30, 45, 60, 75, 90, 105, 120, 135, 150, 165, 180, 195, 210, 225, 240, 255, 270, 285, 300];
                        mp = mpCosts[i];
                        def = defs[i];
                        speed = speeds[i];
                        duration = durations[i];
                        return {
                            effect: `消耗MP: ${mp}, 防禦力: ${def}, 移動速度: ${speed}, 持續時間: ${duration}秒`,
                            fullDescription: `一定時間內增加物理防禦力。等級${i}效果：消耗MP${mp}，防禦力${def}，移動速度${speed}，持續${duration}秒。`
                        };
                    })
                },
                {
                    id: "slashBlast",
                    name: "魔天一擊",
                    maxLevel: 20,
                    requiredLevel: 10,
                    preRequisite: {},
                    description: "消耗MP，給予怪物強力一擊。",
                    imageUrl: "images/slashBlast.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, attack;
                        if (i === 0) return null;
                        const mpCosts = [null, 4, 4, 4, 4, 5, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12];
                        const attacks = [null, 114, 120, 126, 132, 142, 148, 154, 164, 170, 180, 186, 196, 202, 212, 218, 228, 234, 244, 250, 260];
                        mp = mpCosts[i];
                        attack = attacks[i];
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%`,
                            fullDescription: `消耗MP，給予怪物強力一擊。等級${i}效果：消耗MP${mp}，攻擊力${attack}%。`
                        };
                    })
                },
                {
                    id: "powerStrike",
                    name: "劍氣縱橫",
                    maxLevel: 20,
                    requiredLevel: 10,
                    preRequisite: {"slashBlast":1},
                    description: "消耗HP和MP，同時攻擊周遭的多個怪物。",
                    imageUrl: "images/powerStrike.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let hp, mp, attack;
                        if (i === 0) return null;
                        const hpCosts = [null, 8, 8, 8, 8, 9, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, 14, 14, 15, 15, 16];
                        const mpCosts = [null, 6, 6, 6, 6, 7, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, 14];
                        const attacks = [null, 57, 60, 63, 66, 71, 74, 77, 85, 88, 93, 96, 101, 104, 109, 112, 117, 120, 122, 125, 130];
                        hp = hpCosts[i];
                        mp = mpCosts[i];
                        attack = attacks[i];
                        return {
                            effect: `消耗HP: ${hp}, 消耗MP: ${mp}, 攻擊力: ${attack}%`,
                            fullDescription: `消耗HP和MP，同時攻擊周遭的多個怪物。等級${i}效果：消耗HP${hp}，消耗MP${mp}，攻擊力${attack}%。`
                        };
                    })
                }
            ],
            "2轉 (見習騎士)": [
                {
                    id: "swordMastery",
                    name: "精準之劍",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "提升劍系武器的命中率及熟練度，此技能必須是使用單手劍或雙手劍的情況下，才能發揮作用。",
                    imageUrl: "images/swordMastery.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let hitRate, mastery;
                        if (i === 0) return null;
                        const hitRates = [null, 1, 2, 3, 4, 5, 6, 6, 8, 8, 10, 10, 12, 12, 14, 14, 16, 16, 18, 19, 20];
                        const masteries = [null, 15, 15, 20, 20, 25, 25, 25, 30, 30, 35, 35, 40, 40, 45, 45, 50, 50, 55, 60, 60];
                        hitRate = hitRates[i];
                        mastery = masteries[i];
                        return {
                            effect: `命中率: ${hitRate}, 熟練度: ${mastery}%`,
                            fullDescription: `提升劍系武器的命中率及熟練度，此技能必須是使用單手劍或雙手劍的情況下，才能發揮作用。等級${i}效果：命中率${hitRate}，熟練度${mastery}%。`
                        };
                    })
                },
                {
                    id: "bluntWeaponMastery",
                    name: "精準之棍",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "提升棍系武器的命中率及熟練度，此技能必須是使用單手棍或雙手棍的情況下，才會發揮作用。",
                    imageUrl: "images/bluntWeaponMastery.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let hitRate, mastery;
                        if (i === 0) return null;
                        const hitRates = [null, 1, 2, 3, 4, 5, 6, 6, 8, 8, 10, 10, 12, 12, 14, 14, 16, 16, 18, 19, 20];
                        const masteries = [null, 15, 15, 20, 20, 25, 25, 25, 30, 30, 35, 35, 40, 40, 45, 45, 50, 50, 55, 60, 60];
                        hitRate = hitRates[i];
                        mastery = masteries[i];
                        return {
                            effect: `命中率: ${hitRate}, 熟練度: ${mastery}%`,
                            fullDescription: `提升棍系武器的命中率及熟練度，此技能必須是使用單手棍或雙手棍的情況下，才會發揮作用。等級${i}效果：命中率${hitRate}，熟練度${mastery}%。`
                        };
                    })
                },
                {
                    id: "swordBooster",
                    name: "快速之劍",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: { "swordMastery": 5 },
                    description: "消耗HP與MP，將使用刀劍的攻擊速度，向上提升一個等級。此技能必須是使用單手劍或雙手劍的情況下，才能發揮作用。",
                    imageUrl: "images/swordBooster.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, hp, duration;
                        if (i === 0) return null;
                        const mpCosts = [null, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10];
                        const hpCosts = [null, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10];
                        const durations = [null, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 120, 140, 160, 180, 200, 220, 240, 260, 280, 300];
                        mp = mpCosts[i];
                        hp = hpCosts[i];
                        duration = durations[i];
                        return {
                            effect: `消耗MP: ${mp}, 消耗HP: ${hp}, 持續時間: ${duration}秒`,
                            fullDescription: `消耗HP與MP，將使用刀劍的攻擊速度，向上提升一個等級。此技能必須是使用單手劍或雙手劍的情況下，才能發揮作用。等級${i}效果：消耗MP${mp}，消耗HP${hp}，持續${duration}秒。`
                        };
                    })
                },
                {
                    id: "bluntWeaponBooster",
                    name: "快速之棍",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: { "bluntWeaponMastery": 5 },
                    description: "消耗HP與MP，將使用棍的攻擊速度，向上提升一個等級。此技能必須是使用單手棍或雙手棍的情況下，才能發揮作用。",
                    imageUrl: "images/bluntWeaponBooster.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, hp, duration;
                        if (i === 0) return null;
                        const mpCosts = [null, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10];
                        const hpCosts = [null, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10];
                        const durations = [null, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 120, 140, 160, 180, 200, 220, 240, 260, 280, 300];
                        mp = mpCosts[i];
                        hp = hpCosts[i];
                        duration = durations[i];
                        return {
                            effect: `消耗MP: ${mp}, 消耗HP: ${hp}, 持續時間: ${duration}秒`,
                            fullDescription: `消耗HP與MP，將使用棍的攻擊速度，向上提升一個等級。此技能必須是使用單手棍或雙手棍的情況下，才能發揮作用。等級${i}效果：消耗MP${mp}，消耗HP${hp}，持續${duration}秒。`
                        };
                    })
                },
                {
                    id: "finalAttackSword",
                    name: "終極之劍",
                    maxLevel: 30,
                    requiredLevel: 30,
                    preRequisite: { "swordMastery": 3 },
                    description: "按照一定機率，在使用攻擊技能後發動連續攻擊。此技能必須是使用單手劍或雙手劍的情況下，才能發揮作用。",
                    imageUrl: "images/finalAttackSword.png",
                    levels: Array(31).fill(null).map((_, i) => {
                        let procRate, attack;
                        if (i === 0) return null;
                        const procRates = [null, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60];
                        const attacks = [null, 105, 110, 115, 120, 125, 130, 135, 140, 145, 150, 155, 160, 165, 170, 175, 180, 185, 10, 195, 200, 205, 210, 215, 220, 225, 230, 235, 240, 245, 250]; // Level 18 attack is 10% as provided
                        procRate = procRates[i];
                        attack = attacks[i];
                        return {
                            effect: `發動率: ${procRate}%, 攻擊力: ${attack}%`,
                            fullDescription: `按照一定機率，在使用攻擊技能後發動連續攻擊。此技能必須是使用單手劍或雙手劍的情況下，才能發揮作用。等級${i}效果：發動率${procRate}%，攻擊力${attack}%。`
                        };
                    })
                },
                {
                    id: "finalAttackBluntWeapon",
                    name: "終極之棍",
                    maxLevel: 30,
                    requiredLevel: 30,
                    preRequisite: { "bluntWeaponMastery": 3 },
                    description: "按照一定機率，在使用攻擊技能後發動連續攻擊。此技能必須是使用單手棍或雙手棍的情況下，才能發揮作用。",
                    imageUrl: "images/finalAttackBluntWeapon.png",
                    levels: Array(31).fill(null).map((_, i) => {
                        let procRate, attack;
                        if (i === 0) return null;
                        const procRates = [null, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60];
                        const attacks = [null, 105, 110, 115, 120, 125, 130, 135, 140, 145, 150, 155, 160, 165, 170, 175, 180, 185, 190, 195, 200, 205, 210, 215, 220, 225, 230, 235, 240, 245, 250];
                        procRate = procRates[i];
                        attack = attacks[i];
                        return {
                            effect: `發動率: ${procRate}%, 攻擊力: ${attack}%`,
                            fullDescription: `按照一定機率，在使用攻擊技能後發動連續攻擊。此技能必須是使用單手棍或雙手棍的情況下，才能發揮作用。等級${i}效果：發動率${procRate}%，攻擊力${attack}%。`
                        };
                    })
                },
                {
                    id: "threaten",
                    name: "降魔咒",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "消耗MP而讓周圍的怪物感到壓制感，降低怪物的物理攻擊力與物理防禦力。（適用於BOSS）",
                    imageUrl: "images/threaten.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, pDef, pAttack, duration;
                        if (i === 0) return null;
                        const mpCosts = [null, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20];
                        const defs = [null, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20];
                        const attacks = [null, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20];
                        const durations = [null, 7, 9, 11, 13, 15, 17, 19, 21, 23, 25, 27, 29, 31, 33, 35, 37, 39, 41, 43, 45];
                        mp = mpCosts[i];
                        pDef = defs[i];
                        pAttack = attacks[i];
                        duration = durations[i];
                        return {
                            effect: `消耗MP: ${mp}, 物理防禦: -${pDef}%, 物理攻擊: -${pAttack}%, 持續時間: ${duration}秒`,
                            fullDescription: `消耗MP而讓周圍的怪物感到壓制感，降低怪物的物理攻擊力與物理防禦力。（適用於BOSS）等級${i}效果：消耗MP${mp}，物理防禦-${pDef}%，物理攻擊-${pAttack}%，持續${duration}秒。`
                        };
                    })
                },
                {
    "id": "powerReflection",
    "name": "反射之盾",
    "maxLevel": 30,
    "requiredLevel": 30,
    "preRequisite": {},
    "description": "將怪物對自身傷害的一定量回饋給怪物，但所能轉移給怪物的傷害，以怪物的最大HP10%為限度。",
    "imageUrl": "images/powerReflection.png",
    "levels": Array(31).fill(null).map((_, i) => {
        let mpCost, counterRate, duration;
        if (i === 0) return null;

        // 消耗MP 的規律
        if (i >= 1 && i <= 15) {
            mpCost = 15;
        } else { // i >= 16
            mpCost = 50;
        }

        // 反擊率 的規律：線性增加 (11% 到 40%) => 10 + i
        counterRate = 10 + i;

        // 持續時間 的規律：多段線性
        if (i >= 1 && i <= 15) {
            duration = i * 3;
        } else if (i >= 16 && i <= 20) {
            duration = 45 + (i - 15) * 3; // 從15級的45秒開始計算
        } else if (i >= 21 && i <= 28) {
            duration = 60 + (i - 20) * 30; // 20級是60秒，21級跳到90秒，每級加30秒
        } else { // i >= 29
            duration = 300; // 29和30級固定300秒
        }

        return {
            effect: `消耗MP: ${mpCost}, 反擊率: ${counterRate}%, 持續時間: ${duration}秒`,
            fullDescription: `將怪物對自身傷害的一定量回饋給怪物，但所能轉移給怪物的傷害，以怪物的最大HP10%為限度。等級${i}效果：消耗MP${mpCost}，反擊率${counterRate}%，持續${duration}秒。`
        };
    })
}
            ],
            "3轉 (騎士)": [
                {
                    id: "mpRecoveryKnight",
                    name: "魔力恢復",
                    maxLevel: 20,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "增加每10秒的MP恢復量。",
                    imageUrl: "images/mpRecoveryKnight.png",
                    levels: Array(21).fill(null).map((_, i) => i === 0 ? null : {
                        effect: `回復量: ${i * 2}`,
                        fullDescription: `增加每10秒的MP恢復量。等級${i}效果：回復量${i * 2}。`
                    })
                },
                {
                    id: "shieldMastery",
                    name: "盾防精通",
                    maxLevel: 20,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "提升所佩帶的盾牌的防禦力，若未佩帶盾牌便不會產生效果。",
                    imageUrl: "images/shieldMastery.png",
                    levels: Array(21).fill(null).map((_, i) => i === 0 ? null : {
                        effect: `盾牌防禦: ${100 + i * 5}%`,
                        fullDescription: `提升所佩帶的盾牌的防禦力，若未佩帶盾牌便不會產生效果。等級${i}效果：盾牌防禦${100 + i * 5}%。`
                    })
                },
                {
    "id": "elementalCharge",
    "name": "屬性攻擊",
    "maxLevel": 30,
    "requiredLevel": 70,
    "preRequisite": {},
    "description": "利用賦予在武器的屬性，同時攻擊6個以下的多數敵人。該技能必須在賦予屬性的情況下使用。",
    "imageUrl": "images/elementalCharge.png",
    "levels": Array(31).fill(null).map((_, i) => {
        let hpCost, mpCost, attack;
        if (i === 0) return null;

        // 消耗HP 的規律
        if (i >= 1 && i <= 10) {
            hpCost = 12;
        } else if (i >= 11 && i <= 20) {
            hpCost = 19;
        } else if (i >= 21 && i <= 30) {
            hpCost = 26;
        }

        // 消耗MP 的規律
        if (i >= 1 && i <= 10) {
            mpCost = 15;
        } else if (i >= 11 && i <= 20) {
            mpCost = 20;
        } else if (i >= 21 && i <= 30) {
            mpCost = 25;
        }

        // 攻擊力 的規律：分段線性
        if (i >= 1 && i <= 20) {
            attack = 160 + i * 2;
        } else if (i >= 21 && i <= 30) {
            attack = 210 + (i - 20) * 4;
        }

        return {
            effect: `消耗HP: ${hpCost}, 消耗MP: ${mpCost}, 攻擊力: ${attack}%`,
            fullDescription: `利用賦予在武器的屬性，同時攻擊6個以下的多數敵人。等級${i}效果：消耗HP${hpCost}，消耗MP${mpCost}，攻擊力${attack}%。`
        };
    })
},
                {
    "id": "flameChargeSword",
    "name": "烈焰之劍",
    "maxLevel": 30,
    "requiredLevel": 70,
    "preRequisite": {},
    "description": "在配帶的劍類武器上賦予火屬性。發動攻擊時，會對週遭敵人造成火焰殺傷力，若配合屬性攻擊則會造成強大的傷害，並且此技能會消失。",
    "imageUrl": "images/flameChargeSword.png",
    "levels": Array(31).fill(null).map((_, i) => {
        let mp, attack, duration;
        if (i === 0) return null;

        // 消耗MP 的規律
        const mpCosts = [null, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35];
        mp = mpCosts[i];

        // 攻擊力 的規律 (精確數值)
        const attacks = [null, 102, 103, 104, 105, 106, 107, 108, 109, 109, 110, 110, 111, 111, 112, 112, 113, 113, 114, 114, 115, 115, 116, 116, 117, 117, 118, 118, 119, 119, 120];
        attack = attacks[i];

        // 持續時間 的規律 (精確數值)
        const durations = [null, 12, 19, 26, 33, 40, 47, 54, 61, 68, 75, 82, 89, 96, 103, 110, 116, 122, 128, 134, 140, 146, 158, 158, 164, 170, 176, 182, 188, 194, 200];
        duration = durations[i];

        return {
            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%, 持續時間: ${duration}秒`,
            fullDescription: `在配帶的劍類武器上賦予火屬性。發動攻擊時，會對週遭敵人造成火焰殺傷力，若配合屬性攻擊則會造成強大的傷害，並且此技能會消失。等級${i}效果：消耗MP${mp}，攻擊力${attack}%，持續時間${duration}秒。`
        };
    })
},
                {
    "id": "flameChargeBluntWeapon",
    "name": "烈焰之棍",
    "maxLevel": 30,
    "requiredLevel": 70,
    "preRequisite": {},
    "description": "在配帶的棍類武器上賦予火屬性。發動攻擊時，會對週遭敵人造成火焰殺傷力，若配合屬性攻擊則會造成強大的傷害，並且此技能會消失。",
    "imageUrl": "images/flameChargeBluntWeapon.png",
    "levels": Array(31).fill(null).map((_, i) => {
        let mp, attack, duration;
        if (i === 0) return null;

        // 消耗MP 的規律
        const mpCosts = [null, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35];
        mp = mpCosts[i];

        // 攻擊力 的規律 (精確數值)
        const attacks = [null, 102, 103, 104, 105, 106, 107, 108, 109, 109, 110, 110, 111, 111, 112, 112, 113, 113, 114, 114, 115, 115, 116, 116, 117, 117, 118, 118, 119, 119, 120];
        attack = attacks[i];

        // 持續時間 的規律 (精確數值)
        const durations = [null, 12, 19, 26, 33, 40, 47, 54, 61, 68, 75, 82, 89, 96, 103, 110, 116, 122, 128, 134, 140, 146, 158, 158, 164, 170, 176, 182, 188, 194, 200];
        duration = durations[i];

        return {
            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%, 持續時間: ${duration}秒`,
            fullDescription: `在配帶的棍類武器上賦予火屬性。發動攻擊時，會對週遭敵人造成火焰殺傷力，若配合屬性攻擊則會造成強大的傷害，並且此技能會消失。等級${i}效果：消耗MP${mp}，攻擊力${attack}%，持續時間${duration}秒。`
        };
    })
},
                {
    "id": "iceChargeSword",
    "name": "寒冰之劍",
    "maxLevel": 30,
    "requiredLevel": 70,
    "preRequisite": {},
    "description": "在配帶的劍類武器上賦予冰屬性。發動攻擊時，敵人會在一定時間內維持冰凍狀態，若配合屬性攻擊則會造成強大的傷害，並且此技能會消失。",
    "imageUrl": "images/iceChargeSword.png",
    "levels": Array(31).fill(null).map((_, i) => {
        let mp, attack, duration;
        if (i === 0) return null;

        // 消耗MP 的規律：分段
        const mpCosts = [null, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35];
        mp = mpCosts[i];

        // 攻擊力 的規律：有不規則跳變，精確列出
        const attacks = [null, 102, 103, 104, 105, 106, 107, 108, 109, 109, 110, 110, 111, 111, 112, 112, 113, 113, 114, 114, 115, 115, 116, 116, 117, 117, 118, 118, 119, 119, 120];
        attack = attacks[i];

        // 持續時間 的規律：有不規則跳變，精確列出
        const durations = [null, 12, 19, 26, 33, 40, 47, 54, 61, 68, 75, 82, 89, 96, 103, 110, 116, 122, 128, 134, 140, 146, 158, 158, 164, 170, 176, 182, 188, 194, 200];
        duration = durations[i];

        return {
            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%, 持續時間: ${duration}秒`,
            fullDescription: `在配帶的劍類武器上賦予冰屬性。發動攻擊時，敵人會在一定時間內維持冰凍狀態，若配合屬性攻擊則會造成強大的傷害，並且此技能會消失。等級${i}效果：消耗MP${mp}，攻擊力${attack}%，持續時間${duration}秒。`
        };
    })
},
                {
    "id": "iceChargeBluntWeapon",
    "name": "寒冰之棍",
    "maxLevel": 30,
    "requiredLevel": 70,
    "preRequisite": {},
    "description": "在配帶的棍類武器上賦予冰屬性。發動攻擊時，敵人會在一定時間內維持冰凍狀態，若配合屬性攻擊則會造成強大的傷害，並且此技能會消失。",
    "imageUrl": "images/iceChargeBluntWeapon.png",
    "levels": Array(31).fill(null).map((_, i) => {
        let mp, attack, duration;
        if (i === 0) return null;

        // 消耗MP 的規律
        const mpCosts = [null, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35];
        mp = mpCosts[i];

        // 攻擊力 的規律 (精確數值)
        const attacks = [null, 102, 103, 104, 105, 106, 107, 108, 109, 109, 110, 110, 111, 111, 112, 112, 113, 113, 114, 114, 115, 115, 116, 116, 117, 117, 118, 118, 119, 119, 120];
        attack = attacks[i];

        // 持續時間 的規律 (精確數值)
        const durations = [null, 12, 19, 26, 33, 40, 47, 54, 61, 68, 75, 82, 89, 96, 103, 110, 116, 122, 128, 134, 140, 146, 158, 158, 164, 170, 176, 182, 188, 194, 200];
        duration = durations[i];

        return {
            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%, 持續時間: ${duration}秒`,
            fullDescription: `在配帶的棍類武器上賦予冰屬性。發動攻擊時，敵人會在一定時間內維持冰凍狀態，若配合屬性攻擊則會造成強大的傷害，並且此技能會消失。等級${i}效果：消耗MP${mp}，攻擊力${attack}%，持續時間${duration}秒。`
        };
    })
},
                {
    "id": "lightningChargeSword",
    "name": "雷鳴之劍",
    "maxLevel": 30,
    "requiredLevel": 70,
    "preRequisite": {},
    "description": "在配帶的劍類武器上賦予雷屬性。發動攻擊時，會對週遭敵人造成雷電殺傷力，若配合屬性攻擊則會造成強大的傷害，並且此技能會消失。",
    "imageUrl": "images/lightningChargeSword.png",
    "levels": Array(31).fill(null).map((_, i) => {
        let mp, attack, duration;
        if (i === 0) return null;

        // 消耗MP 的規律：分段
        const mpCosts = [null, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35];
        mp = mpCosts[i];

        // 攻擊力 的規律 (精確數值)
        const attacks = [null, 102, 104, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 117, 118, 118, 119, 119, 120, 120, 121, 121, 122, 122, 123, 123, 124, 124, 125];
        attack = attacks[i];

        // 持續時間 的規律 (精確數值)
        const durations = [null, 12, 19, 26, 33, 40, 47, 54, 61, 68, 75, 82, 89, 96, 103, 110, 116, 122, 128, 134, 140, 146, 158, 158, 164, 170, 176, 182, 188, 194, 200];
        duration = durations[i];

        return {
            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%, 持續時間: ${duration}秒`,
            fullDescription: `在配帶的劍類武器上賦予雷屬性。發動攻擊時，會對週遭敵人造成雷電殺傷力，若配合屬性攻擊則會造成強大的傷害，並且此技能會消失。等級${i}效果：消耗MP${mp}，攻擊力${attack}%，持續時間${duration}秒。`
        };
    })
},

{
    "id": "lightningChargeBluntWeapon",
    "name": "雷鳴之棍",
    "maxLevel": 30,
    "requiredLevel": 70,
    "preRequisite": {},
    "description": "在配帶的棍類武器上賦予雷屬性。發動攻擊時，會對週遭敵人造成雷電殺傷力，若配合屬性攻擊則會產生強大的傷害，並且此技能會消失。",
    "imageUrl": "images/lightningChargeBluntWeapon.png",
    "levels": Array(31).fill(null).map((_, i) => {
        let mp, attack, duration;
        if (i === 0) return null;

        // 消耗MP 的規律：分段
        const mpCosts = [null, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35];
        mp = mpCosts[i];

        // 攻擊力 的規律 (精確數值)
        const attacks = [null, 102, 104, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 117, 118, 118, 119, 119, 120, 120, 121, 121, 122, 122, 123, 123, 124, 124, 125];
        attack = attacks[i];

        // 持續時間 的規律 (精確數值)
        const durations = [null, 12, 19, 26, 33, 40, 47, 54, 61, 68, 75, 82, 89, 96, 103, 110, 116, 122, 128, 134, 140, 146, 158, 158, 164, 170, 176, 182, 188, 194, 200];
        duration = durations[i];

        return {
            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%, 持續時間: ${duration}秒`,
            fullDescription: `在配帶的棍類武器上賦予雷屬性。發動攻擊時，會對週遭敵人造成雷電殺傷力，若配合屬性攻擊則會產生強大的傷害，並且此技能會消失。等級${i}效果：消耗MP${mp}，攻擊力${attack}%，持續時間${duration}秒。`
        };
    })
},
                {
    "id": "magicCrash",
    "name": "魔防消除",
    "maxLevel": 20,
    "requiredLevel": 70,
    "preRequisite": {},
    "description": "增加自身與隊友屬性攻擊傷害。（屬性充能增加10%，法師的屬性魔法傷害乘算110%）",
    "imageUrl": "images/magicCrash.png",
    "levels": Array(21).fill(null).map((_, i) => {
        let mpCost, attributeDmgIncrease, duration;
        if (i === 0) return null;

        // 消耗MP 的規律 (精確數值)
        const mpCosts = [null, 35, 33, 31, 29, 27, 25, 23, 21, 19, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7];
        mpCost = mpCosts[i];

        // 屬性傷害增加 的規律：線性 (i * 0.5)
        attributeDmgIncrease = i * 0.5;

        // 持續時間 的規律 (精確數值)
        const durations = [null, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 120, 140, 160, 180, 200, 220, 240, 260, 280, 300];
        duration = durations[i];

        return {
            effect: `消耗MP: ${mpCost}, 屬性傷害增加: ${attributeDmgIncrease}%, 持續時間: ${duration}秒`,
            fullDescription: `增加自身與隊友屬性攻擊傷害。（屬性充能增加10%，法師的屬性魔法傷害乘算110%）等級${i}效果：消耗MP${mpCost}，屬性傷害增加${attributeDmgIncrease}%，持續時間${duration}秒。`
        };
    })
}
            ],
            "4轉 (聖騎士)": [],
            "超技能": [],
            "5轉技能": [],
            "共通技能": []
        }
    },
            "黑騎士 (Dark Knight)": {
        startingLevelForSp: 10, // 劍士系通常10等轉職
        jobAdvancementSpBonuses: [10, 30, 70, 120],
        jobStagesOrder: ["0轉 (新手)", "1轉 (劍士)", "2轉 (槍騎兵)", "3轉 (龍騎士)", "4轉 (黑騎士)", "超技能", "5轉技能", "共通技能"],
        spRequiredFor2ndJob: 61, // 其他職業2轉點數需求
        spRequiredFor3rdJob: 182, // 其他職業3轉點數需求
        spRequiredFor4thJob: 249, // 4轉通用點數需求    
skills: {
            "0轉 (新手)": [],
            "1轉 (劍士)": [
                {
                    id: "hpRecovery",
                    name: "生命淨化",
                    maxLevel: 16,
                    requiredLevel: 10,
                    preRequisite: {},
                    description: "自我恢复时能回复更多HP。移動中可恢復",
                    imageUrl: "images/hpRecovery.png", // 確保圖片檔案存在
                    levels: Array(17).fill(null).map((_, i) => i === 0 ? null : {
                        effect: `回復量: ${i * 3}`,
                        fullDescription: `自我恢復時能回復更多HP。移動中可恢復。等級${i}效果：回復量${i * 3}。`
                    })
                },
                {
                    id: "hpBoost",
                    name: "生命擴展",
                    maxLevel: 10,
                    requiredLevel: 10,
                    preRequisite: {"hpRecovery":5},
                    description: "等級上升或使用升級點(AP)數增加HP的增血量。",
                    imageUrl: "images/hpBoost.png", // 確保圖片檔案存在
                    levels: Array(11).fill(null).map((_, i) => i === 0 ? null : {
                        effect: `升級血量: ${i * 4}`,
                        fullDescription: `等級上升或使用升級點(AP)數增加HP的增血量。等級${i}效果：升級血量${i * 4}。`
                    })
                },
                {
                    id: "hpRestore",
                    name: "生命恢復",
                    maxLevel: 8,
                    requiredLevel: 10,
                    preRequisite: { "hpRecovery": 5, "hpBoost": 3 },
                    description: "提升自我恢復HP。可與生命淨化疊加。",
                    imageUrl: "images/hpRestore.png", // 確保圖片檔案存在
                    levels: Array(9).fill(null).map((_, i) => i === 0 ? null : {
                        effect: `HP追加恢復: ${i * 4}`,
                        fullDescription: `提升自我恢復HP。可與生命淨化疊加。等級${i}效果：HP追加恢復${i * 4}。`
                    })
                },
                {
                    id: "ironBody",
                    name: "自身強化",
                    maxLevel: 20,
                    requiredLevel: 10,
                    preRequisite: { "hpRecovery": 5, "hpBoost": 3, "hpRestore": 3 },
                    description: "一定時間內增加物理防禦力。",
                    imageUrl: "images/ironBody.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, def, speed, duration;
                        if (i === 0) return null;
                        const mpCosts = [null, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15];
                        const defs = [null, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40];
                        const speeds = [null, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10];
                        const durations = [null, 75, 30, 45, 60, 75, 90, 105, 120, 135, 150, 165, 180, 195, 210, 225, 240, 255, 270, 285, 300];
                        mp = mpCosts[i];
                        def = defs[i];
                        speed = speeds[i];
                        duration = durations[i];
                        return {
                            effect: `消耗MP: ${mp}, 防禦力: ${def}, 移動速度: ${speed}, 持續時間: ${duration}秒`,
                            fullDescription: `一定時間內增加物理防禦力。等級${i}效果：消耗MP${mp}，防禦力${def}，移動速度${speed}，持續${duration}秒。`
                        };
                    })
                },
                {
                    id: "slashBlast",
                    name: "魔天一擊",
                    maxLevel: 20,
                    requiredLevel: 10,
                    preRequisite: {},
                    description: "消耗MP，給予怪物強力一擊。",
                    imageUrl: "images/slashBlast.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, attack;
                        if (i === 0) return null;
                        const mpCosts = [null, 4, 4, 4, 4, 5, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12];
                        const attacks = [null, 114, 120, 126, 132, 142, 148, 154, 164, 170, 180, 186, 196, 202, 212, 218, 228, 234, 244, 250, 260];
                        mp = mpCosts[i];
                        attack = attacks[i];
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%`,
                            fullDescription: `消耗MP，給予怪物強力一擊。等級${i}效果：消耗MP${mp}，攻擊力${attack}%。`
                        };
                    })
                },
                {
                    id: "powerStrike",
                    name: "劍氣縱橫",
                    maxLevel: 20,
                    requiredLevel: 10,
                    preRequisite: {"slashBlast":1},
                    description: "消耗HP和MP，同時攻擊周遭的多個怪物。",
                    imageUrl: "images/powerStrike.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let hp, mp, attack;
                        if (i === 0) return null;
                        const hpCosts = [null, 8, 8, 8, 8, 9, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, 14, 14, 15, 15, 16];
                        const mpCosts = [null, 6, 6, 6, 6, 7, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, 14];
                        const attacks = [null, 57, 60, 63, 66, 71, 74, 77, 85, 88, 93, 96, 101, 104, 109, 112, 117, 120, 122, 125, 130];
                        hp = hpCosts[i];
                        mp = mpCosts[i];
                        attack = attacks[i];
                        return {
                            effect: `消耗HP: ${hp}, 消耗MP: ${mp}, 攻擊力: ${attack}%`,
                            fullDescription: `消耗HP和MP，同時攻擊周遭的多個怪物。等級${i}效果：消耗HP${hp}，消耗MP${mp}，攻擊力${attack}%。`
                        };
                    })
                }
            ],
            "2轉 (槍騎兵)": [
                {
                    id: "spearMastery",
                    name: "精準之槍",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "提升槍系武器的命中率及熟練度，此技能必須是使用槍的情況下，才能發揮作用。",
                    imageUrl: "images/spearMastery.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let hitRate, mastery;
                        if (i === 0) return null;
                        const hitRates = [null, 1, 2, 3, 4, 5, 6, 6, 8, 8, 10, 10, 12, 12, 14, 14, 16, 16, 18, 19, 20];
                        const masteries = [null, 15, 15, 20, 20, 25, 25, 25, 30, 30, 35, 35, 40, 40, 45, 45, 50, 50, 55, 60, 60];
                        hitRate = hitRates[i];
                        mastery = masteries[i];
                        return {
                            effect: `命中率: ${hitRate}, 熟練度: ${mastery}%`,
                            fullDescription: `提升槍系武器的命中率及熟練度，此技能必須是使用槍的情況下，才能發揮作用。等級${i}效果：命中率${hitRate}，熟練度${mastery}%。`
                        };
                    })
                },
                {
                    id: "polearmMastery",
                    name: "精準之矛",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "提升矛系武器的命中率及熟練度，此技能必須是使用矛的情況下，才會發揮作用。",
                    imageUrl: "images/polearmMastery.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let hitRate, mastery;
                        if (i === 0) return null;
                        const hitRates = [null, 1, 2, 3, 4, 5, 6, 6, 8, 8, 10, 10, 12, 12, 14, 14, 16, 16, 18, 19, 20];
                        const masteries = [null, 15, 15, 20, 20, 25, 25, 25, 30, 30, 35, 35, 40, 40, 45, 45, 50, 50, 55, 60, 60];
                        hitRate = hitRates[i];
                        mastery = masteries[i];
                        return {
                            effect: `命中率: ${hitRate}, 熟練度: ${mastery}%`,
                            fullDescription: `提升矛系武器的命中率及熟練度，此技能必須是使用矛的情況下，才會發揮作用。等級${i}效果：命中率${hitRate}，熟練度${mastery}%。`
                        };
                    })
                },
                {
                    id: "spearBooster",
                    name: "快速之槍",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: { "spearMastery": 5 },
                    description: "消耗HP與MP，將使用槍的攻擊速度，向上提升一個等級。此技能必須是使用槍的情況下，才能發揮作用。",
                    imageUrl: "images/spearBooster.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, hp, duration;
                        if (i === 0) return null;
                        const mpCosts = [null, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10];
                        const hpCosts = [null, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10];
                        const durations = [null, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 120, 140, 160, 180, 200, 220, 240, 260, 280, 300];
                        mp = mpCosts[i];
                        hp = hpCosts[i];
                        duration = durations[i];
                        return {
                            effect: `消耗MP: ${mp}, 消耗HP: ${hp}, 持續時間: ${duration}秒`,
                            fullDescription: `消耗HP與MP，將使用槍的攻擊速度，向上提升一個等級。此技能必須是使用槍的情況下，才能發揮作用。等級${i}效果：消耗MP${mp}，消耗HP${hp}，持續${duration}秒。`
                        };
                    })
                },
                {
                    id: "polearmBooster",
                    name: "快速之矛",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: { "polearmMastery": 5 },
                    description: "消耗HP與MP，將使用矛的攻擊速度，向上提升一個等級。此技能必須是使用矛的情況下，才能發揮作用。",
                    imageUrl: "images/polearmBooster.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, hp, duration;
                        if (i === 0) return null;
                        const mpCosts = [null, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10];
                        const hpCosts = [null, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10];
                        const durations = [null, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 120, 140, 160, 180, 200, 220, 240, 260, 280, 300];
                        mp = mpCosts[i];
                        hp = hpCosts[i];
                        duration = durations[i];
                        return {
                            effect: `消耗MP: ${mp}, 消耗HP: ${hp}, 持續時間: ${duration}秒`,
                            fullDescription: `消耗HP與MP，將使用矛的攻擊速度，向上提升一個等級。此技能必須是使用矛的情況下，才能發揮作用。等級${i}效果：消耗MP${mp}，消耗HP${hp}，持續${duration}秒。`
                        };
                    })
                },
                {
                    id: "finalAttackSpear",
                    name: "終極之槍",
                    maxLevel: 30,
                    requiredLevel: 30,
                    preRequisite: { "spearMastery": 3 },
                    description: "按照一定機率，在使用攻擊技能後發動連續攻擊。此技能必須是使用槍的情況下，才能發揮作用。",
                    imageUrl: "images/finalAttackSpear.png",
                    levels: Array(31).fill(null).map((_, i) => {
                        let procRate, attack;
                        if (i === 0) return null;
                        const procRates = [null, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60];
                        const attacks = [null, 105, 110, 115, 120, 125, 130, 135, 140, 145, 150, 155, 160, 165, 170, 175, 180, 185, 10, 195, 200, 205, 210, 215, 220, 225, 230, 235, 240, 245, 250]; // Level 18 attack is 10% as provided
                        procRate = procRates[i];
                        attack = attacks[i];
                        return {
                            effect: `發動率: ${procRate}%, 攻擊力: ${attack}%`,
                            fullDescription: `按照一定機率，在使用攻擊技能後發動連續攻擊。此技能必須是使用槍的情況下，才能發揮作用。等級${i}效果：發動率${procRate}%，攻擊力${attack}%。`
                        };
                    })
                },
                {
                    id: "finalAttackPolearm",
                    name: "終極之矛",
                    maxLevel: 30,
                    requiredLevel: 30,
                    preRequisite: { "polearmMastery": 3 },
                    description: "按照一定機率，在使用攻擊技能後發動連續攻擊。此技能必須是使用矛的情況下，才能發揮作用。",
                    imageUrl: "images/finalAttackPolearm.png",
                    levels: Array(31).fill(null).map((_, i) => {
                        let procRate, attack;
                        if (i === 0) return null;
                        const procRates = [null, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60];
                        const attacks = [null, 105, 110, 115, 120, 125, 130, 135, 140, 145, 150, 155, 160, 165, 170, 175, 180, 185, 10, 195, 200, 205, 210, 215, 220, 225, 230, 235, 240, 245, 250]; // Level 18 attack is 10% as provided
                        procRate = procRates[i];
                        attack = attacks[i];
                        return {
                            effect: `發動率: ${procRate}%, 攻擊力: ${attack}%`,
                            fullDescription: `按照一定機率，在使用攻擊技能後發動連續攻擊。此技能必須是使用矛的情況下，才能發揮作用。等級${i}效果：發動率${procRate}%，攻擊力${attack}%。`
                        };
                    })
                },
                {
                    id: "hyperBody",
                    name: "禦魔陣",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "在一定時間內，提升周圍組員的物理防禦力與魔法防禦力。但若是使用自身強化技能的狀態下的話，則只提昇魔法防禦力。",
                    imageUrl: "images/hyperBody.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, pDef, mDef, duration;
                        if (i === 0) return null;
                        const mpCosts = [null, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24];
                        const defs = [null, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20];
                        const durations = [null, 15, 30, 45, 60, 75, 90, 105, 120, 135, 150, 165, 180, 195, 210, 225, 240, 255, 270, 285, 300];
                        mp = mpCosts[i];
                        pDef = defs[i];
                        mDef = defs[i];
                        duration = durations[i];
                        return {
                            effect: `消耗MP: ${mp}, 物理防禦: ${pDef}, 魔法防禦: ${mDef}, 持續時間: ${duration}秒`,
                            fullDescription: `在一定時間內，提升周圍組員的物理防禦力與魔法防禦力。等級${i}效果：消耗MP${mp}，物理防禦${pDef}，魔法防禦${mDef}，持續${duration}秒。`
                        };
                    })
                },
                {
                    id: "holyFire",
                    name: "神聖之火",
                    maxLevel: 30,
                    requiredLevel: 30,
                    preRequisite: { "hyperBody": 3 },
                    description: "將怪物對自身傷害的一定量回饋給怪物，但所能轉移給怪物的傷害，以怪物的最大HP10%為限度。",
                    imageUrl: "images/holyFire.png",
                    levels: Array(31).fill(null).map((_, i) => {
                        let mp, hpIncrease, mpIncrease, duration;
                        if (i === 0) return null;
                        const mpCosts = [null, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50];
                        const percents = [null, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60];
                        const durations = [null, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300];
                        mp = mpCosts[i];
                        hpIncrease = percents[i];
                        mpIncrease = percents[i];
                        duration = durations[i];
                        return {
                            effect: `消耗MP: ${mp}, HP提升: ${hpIncrease}%, MP提升: ${mpIncrease}%, 持續時間: ${duration}秒`,
                            fullDescription: `將怪物對自身傷害的一定量回饋給怪物，但所能轉移給怪物的傷害，以怪物的最大HP10%為限度。等級${i}效果：消耗MP${mp}，HP提升${hpIncrease}%，MP提升${mpIncrease}%，持續${duration}秒。`
                        };
                    })
                }
            ],
            "3轉 (龍騎士)": [
                {
                    id: "magicResistance",
                    name: "魔法抵抗",
                    maxLevel: 20,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "提高對所有屬性魔法的抗性。",
                    imageUrl: "images/magicResistance.png",
                    levels: Array(21).fill(null).map((_, i) => i === 0 ? null : {
                        effect: `抵抗性: ${i * 2}%`,
                        fullDescription: `提高對所有屬性魔法的抗性。等級${i}效果：抵抗性${i * 2}%。`
                    })
                },
                {
                    id: "dragonBusterSpear",
                    name: "槍連擊",
                    maxLevel: 30,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "配帶槍類武器時，可對前方多個怪物進行連續攻擊。",
                    imageUrl: "images/dragonBusterSpear.png",
                    levels: Array(31).fill(null).map((_, i) => {
                        let mp, attack, numAttacks, numEnemies;
                        if (i === 0) return null;
                        const mpCosts = [null, 10, 10, 10, 10, 10, 13, 13, 13, 13, 13, 16, 16, 16, 16, 16, 19, 19, 19, 19, 19, 22, 22, 22, 22, 22, 25, 25, 25, 25, 25];
                        const attacks = [null, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100, 104, 108, 112, 116, 120, 124, 128, 132, 136, 140, 143, 146, 149, 152, 155, 158, 161, 164, 167, 170];
                        const numAttacksArr = [null, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3];
                        const numEnemiesArr = [null, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3]; // This might be for "enemies hit"
                        mp = mpCosts[i];
                        attack = attacks[i];
                        numAttacks = numAttacksArr[i];
                        numEnemies = numEnemiesArr[i];
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%, 攻擊次數: ${numAttacks}, 敵人數量: ${numEnemies}`,
                            fullDescription: `配帶槍類武器時，可對前方多個怪物進行連續攻擊。等級${i}效果：消耗MP${mp}，攻擊力${attack}%，攻擊次數${numAttacks}，敵人數量${numEnemies}。`
                        };
                    })
                },
                {
                    id: "dragonBusterPolearm",
                    name: "矛連擊",
                    maxLevel: 30,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "配帶矛類武器時，可對前方多個怪物進行連續攻擊。",
                    imageUrl: "images/dragonBusterPolearm.png",
                    levels: Array(31).fill(null).map((_, i) => {
                        let mp, attack, numAttacks, numEnemies;
                        if (i === 0) return null;
                        const mpCosts = [null, 10, 10, 10, 10, 10, 13, 13, 13, 13, 13, 16, 16, 16, 16, 16, 19, 19, 19, 19, 19, 22, 22, 22, 22, 22, 25, 25, 25, 25, 25];
                        const attacks = [null, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100, 104, 108, 112, 116, 120, 124, 128, 132, 136, 140, 143, 146, 149, 152, 155, 158, 161, 164, 167, 170];
                        const numAttacksArr = [null, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3];
                        const numEnemiesArr = [null, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3];
                        mp = mpCosts[i];
                        attack = attacks[i];
                        numAttacks = numAttacksArr[i];
                        numEnemies = numEnemiesArr[i];
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%, 攻擊次數: ${numAttacks}, 敵人數量: ${numEnemies}`,
                            fullDescription: `配帶矛類武器時，可對前方多個怪物進行連續攻擊。等級${i}效果：消耗MP${mp}，攻擊力${attack}%，攻擊次數${numAttacks}，敵人數量${numEnemies}。`
                        };
                    })
                },
                {
                    id: "dragonFurySpear",
                    name: "無雙槍",
                    maxLevel: 30,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "配帶槍類武器時，可大範圍揮舞攻擊敵人。",
                    imageUrl: "images/dragonFurySpear.png",
                    levels: Array(31).fill(null).map((_, i) => {
                        let hp, mp, attack;
                        if (i === 0) return null;
                        const hpCosts = [null, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30];
                        const mpCosts = [null, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20];
                        const attacks = [null, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 175, 180, 185, 190, 195, 200, 205, 210, 215, 220, 223, 226, 229, 232, 235, 238, 241, 244, 247, 250];
                        hp = hpCosts[i];
                        mp = mpCosts[i];
                        attack = attacks[i];
                        return {
                            effect: `消耗HP: ${hp}, 消耗MP: ${mp}, 攻擊力: ${attack}%`,
                            fullDescription: `配帶槍類武器時，可大範圍揮舞攻擊敵人。等級${i}效果：消耗HP${hp}，消耗MP${mp}，攻擊力${attack}%。`
                        };
                    })
                },
                {
                    id: "dragonFuryPolearm",
                    name: "無雙矛",
                    maxLevel: 30,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "配帶矛類武器時，可大範圍揮舞攻擊敵人。",
                    imageUrl: "images/dragonFuryPolearm.png",
                    levels: Array(31).fill(null).map((_, i) => {
                        let hp, mp, attack;
                        if (i === 0) return null;
                        const hpCosts = [null, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30];
                        const mpCosts = [null, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20];
                        const attacks = [null, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 175, 180, 185, 190, 195, 200, 205, 210, 215, 220, 223, 226, 229, 232, 235, 238, 241, 244, 247, 250];
                        hp = hpCosts[i];
                        mp = mpCosts[i];
                        attack = attacks[i];
                        return {
                            effect: `消耗HP: ${hp}, 消耗MP: ${mp}, 攻擊力: ${attack}%`,
                            fullDescription: `配帶矛類武器時，可大範圍揮舞攻擊敵人。等級${i}效果：消耗HP${hp}，消耗MP${mp}，攻擊力${attack}%。`
                        };
                    })
                },
                {
                    id: "dragonSacrifice",
                    name: "龍之獻祭",
                    maxLevel: 30,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "犧牲自己的HP換取對敵人進行無視物理防禦的單體攻擊。對魔王級怪物無效，使用後自身HP不會少於1。",
                    imageUrl: "images/dragonSacrifice.png",
                    levels: Array(31).fill(null).map((_, i) => {
                        let mp, attack, hpReduction;
                        if (i === 0) return null;
                        const mpCosts = [null, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18];
                        const attacks = [null, 205, 210, 215, 220, 225, 230, 235, 240, 245, 250, 255, 260, 265, 270, 275, 280, 285, 290, 295, 300, 305, 310, 315, 320, 325, 330, 335, 340, 345, 350];
                        const hpReductions = [null, 30, 29, 28, 27, 18, 17, 17, 16, 16, 15, 15, 14, 14, 13, 13, 12, 12, 11, 11, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10];
                        mp = mpCosts[i];
                        attack = attacks[i];
                        hpReduction = hpReductions[i];
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%, 減少最大HP: ${hpReduction}%`,
                            fullDescription: `犧牲自己的HP換取對敵人進行無視物理防禦的單體攻擊。等級${i}效果：消耗MP${mp}，攻擊力${attack}%，減少最大HP${hpReduction}%。`
                        };
                    })
                },
                {
                    id: "dragonRoar",
                    name: "龍咆哮",
                    maxLevel: 30,
                    requiredLevel: 70,
                    preRequisite: {"dragonSacrifice":3},
                    description: "犧牲自己的HP換取對敵人進行大範圍攻擊，最多可同時攻擊15人。發動技能的瞬間角色將無法動彈。( HP須大於 50%以上才可使用)。",
                    imageUrl: "images/dragonRoar.png",
                    levels: Array(31).fill(null).map((_, i) => {
                        let mp, hpCost, attack, range, interval;
                        if (i === 0) return null;
                        const mpCosts = [null, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 24, 24, 24, 24, 24, 24, 24, 24, 24, 30];
                        const hpCosts = [null, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30];
                        const attacks = [null, 96, 102, 108, 114, 120, 126, 132, 138, 144, 150, 155, 160, 165, 170, 175, 180, 185, 190, 195, 200, 204, 208, 212, 216, 220, 224, 228, 232, 236, 240];
                        const ranges = [null, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400];
                        const intervals = [null, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2];
                        mp = mpCosts[i];
                        hpCost = hpCosts[i];
                        attack = attacks[i];
                        range = ranges[i];
                        interval = intervals[i];
                        return {
                            effect: `消耗MP: ${mp}, 消耗最大HP: ${hpCost}%, 攻擊: ${attack}%, 攻擊範圍: ${range}%, 間隔時間: ${interval}秒`,
                            fullDescription: `犧牲自己的HP換取對敵人進行大範圍攻擊。等級${i}效果：消耗MP${mp}，消耗最大HP${hpCost}%，攻擊${attack}%，攻擊範圍${range}%，間隔時間${interval}秒。`
                        };
                    })
                },
                {
                    id: "powerCrash",
                    name: "力量消除",
                    maxLevel: 20,
                    requiredLevel: 70,
                    preRequisite: {"dragonSpirit":3},
                    description: "一定時間內，使隊員獲得依照施法者HP比例計算的傷害減免效果。以HP1,000為基准為1%，最高20%",
                    imageUrl: "images/powerCrash.png",
                    levels: [
                        null,
                        { effect: "消耗MP: 35, 持續時間: 無資料", fullDescription: "一定時間內，使隊員獲得依照施法者HP比例計算的傷害減免效果。等級1效果：消耗MP35，持續時間無資料。" },
                        { effect: "消耗MP: 33, 持續時間: 無資料", fullDescription: "一定時間內，使隊員獲得依照施法者HP比例計算的傷害減免效果。等級2效果：消耗MP33，持續時間無資料。" },
                        { effect: "消耗MP: 31, 持續時間: 無資料", fullDescription: "一定時間內，使隊員獲得依照施法者HP比例計算的傷害減免效果。等級3效果：消耗MP31，持續時間無資料。" },
                        { effect: "消耗MP: 29, 持續時間: 無資料", fullDescription: "一定時間內，使隊員獲得依照施法者HP比例計算的傷害減免效果。等級4效果：消耗MP29，持續時間無資料。" },
                        { effect: "消耗MP: 35, 持續時間: 75秒", fullDescription: "一定時間內，使隊員獲得依照施法者HP比例計算的傷害減免效果。等級5效果：消耗MP35，持續時間75秒。" },
                        { effect: "消耗MP: 35, 持續時間: 90秒", fullDescription: "一定時間內，使隊員獲得依照施法者HP比例計算的傷害減免效果。等級6效果：消耗MP35，持續時間90秒。" },
                        { effect: "消耗MP: 23, 持續時間: 無資料", fullDescription: "一定時間內，使隊員獲得依照施法者HP比例計算的傷害減免效果。等級7效果：消耗MP23，持續時間無資料。" },
                        { effect: "消耗MP: 21, 持續時間: 無資料", fullDescription: "一定時間內，使隊員獲得依照施法者HP比例計算的傷害減免效果。等級8效果：消耗MP21，持續時間無資料。" },
                        { effect: "消耗MP: 19, 持續時間: 無資料", fullDescription: "一定時間內，使隊員獲得依照施法者HP比例計算的傷害減免效果。等級9效果：消耗MP19，持續時間無資料。" },
                        { effect: "消耗MP: 17, 持續時間: 無資料", fullDescription: "一定時間內，使隊員獲得依照施法者HP比例計算的傷害減免效果。等級10效果：消耗MP17，持續時間無資料。" },
                        { effect: "消耗MP: 16, 持續時間: 無資料", fullDescription: "一定時間內，使隊員獲得依照施法者HP比例計算的傷害減免效果。等級11效果：消耗MP16，持續時間無資料。" },
                        { effect: "消耗MP: 15, 持續時間: 無資料", fullDescription: "一定時間內，使隊員獲得依照施法者HP比例計算的傷害減免效果。等級12效果：消耗MP15，持續時間無資料。" },
                        { effect: "消耗MP: 14, 持續時間: 無資料", fullDescription: "一定時間內，使隊員獲得依照施法者HP比例計算的傷害減免效果。等級13效果：消耗MP14，持續時間無資料。" },
                        { effect: "消耗MP: 13, 持續時間: 無資料", fullDescription: "一定時間內，使隊員獲得依照施法者HP比例計算的傷害減免效果。等級14效果：消耗MP13，持續時間無資料。" },
                        { effect: "消耗MP: 12, 持續時間: 無資料", fullDescription: "一定時間內，使隊員獲得依照施法者HP比例計算的傷害減免效果。等級15效果：消耗MP12，持續時間無資料。" },
                        { effect: "消耗MP: 11, 持續時間: 無資料", fullDescription: "一定時間內，使隊員獲得依照施法者HP比例計算的傷害減免效果。等級16效果：消耗MP11，持續時間無資料。" },
                        { effect: "消耗MP: 10, 持續時間: 無資料", fullDescription: "一定時間內，使隊員獲得依照施法者HP比例計算的傷害減免效果。等級17效果：消耗MP10，持續時間無資料。" },
                        { effect: "消耗MP: 9, 持續時間: 無資料", fullDescription: "一定時間內，使隊員獲得依照施法者HP比例計算的傷害減免效果。等級18效果：消耗MP9，持續時間無資料。" },
                        { effect: "消耗MP: 8, 持續時間: 無資料", fullDescription: "一定時間內，使隊員獲得依照施法者HP比例計算的傷害減免效果。等級19效果：消耗MP8，持續時間無資料。" },
                        { effect: "消耗MP: 7, 持續時間: 無資料", fullDescription: "一定時間內，使隊員獲得依照施法者HP比例計算的傷害減免效果。等級20效果：消耗MP7，持續時間無資料。" }
                    ]
                },
                {
                    id: "dragonSpirit",
                    name: "龍之魂",
                    maxLevel: 20,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "一定時間內提升攻擊力，但HP會逐漸減少。若HP低於每4秒減少的數值，則不會再減少HP。",
                    imageUrl: "images/dragonSpirit.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, hpReduction, attackIncrease, duration;
                        if (i === 0) return null;
                        mp = i <= 10 ? 12 : 24;
                        hpReduction = i === 20 ? 295 : "--"; // Only level 20 has this value
                        attackIncrease = i;
                        duration = i * 8;
                        return {
                            effect: `消耗MP: ${mp}, 每4秒減少HP: ${hpReduction}, 增加攻擊力: ${attackIncrease}, 持續時間: ${duration}秒`,
                            fullDescription: `一定時間內提升攻擊力，但HP會逐漸減少。等級${i}效果：消耗MP${mp}，每4秒減少HP${hpReduction}，增加攻擊力${attackIncrease}，持續時間${duration}秒。`
                        };
                    })
                }
            ],
            "4轉 (黑騎士)": [],
            "超技能": [],
            "5轉技能": [],
            "共通技能": []
        }
    },
            "箭神 (Bowmaster)": {
        startingLevelForSp: 10, // 弓箭手系通常10等轉職
        jobAdvancementSpBonuses: [10, 30, 70, 120],
        jobStagesOrder: ["0轉 (新手)", "1轉 (弓箭手)", "2轉 (獵人)", "3轉 (遊俠)", "4轉 (箭神)", "超技能", "5轉技能", "共通技能"],
        spRequiredFor2ndJob: 61, // 其他職業2轉點數需求
        spRequiredFor3rdJob: 182, // 其他職業3轉點數需求
        spRequiredFor4thJob: 249, // 4轉通用點數需求
        skills: {
            "0轉 (新手)": [],
            "1轉 (弓箭手)": [
                {
                    id: "archeryMastery",
                    name: "精準強化",
                    maxLevel: 16,
                    requiredLevel: 10,
                    preRequisite: {},
                    description: "增加命中率",
                    imageUrl: "images/archeryMastery.png", // 確保圖片檔案存在
                    levels: Array(17).fill(null).map((_, i) => i === 0 ? null : {
                        effect: `命中率: ${i}`,
                        fullDescription: `增加命中率。等級${i}效果：命中率${i}。`
                    })
                },
                {
                    id: "eyeOfTheAmazon",
                    name: "百步穿楊",
                    maxLevel: 8,
                    requiredLevel: 10,
                    preRequisite: { "archeryMastery": 3 },
                    description: "增加弓或弩弓的射程距離",
                    imageUrl: "images/eyeOfTheAmazon.png", // 確保圖片檔案存在
                    levels: [
                        null, null, null, null, null, null, null, null, // Levels 1-7 are null/empty as per provided data
                        { effect: "射程: 120", fullDescription: "增加弓或弩弓的射程距離。等級8效果：射程120。" } // Level 8 data
                    ]
                },
                {
                    id: "criticalShot",
                    name: "霸王箭",
                    maxLevel: 20,
                    requiredLevel: 10,
                    preRequisite: {},
                    description: "攻擊中會有一定比例出現致命性一擊",
                    imageUrl: "images/criticalShot.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => {
                        let procRate, critAttack;
                        if (i === 0) return null;
                        procRate = i * 2;
                        critAttack = 100 + i * 5;
                        return {
                            effect: `發動率: ${procRate}%, 暴擊攻擊力: ${critAttack}%`,
                            fullDescription: `攻擊中會有一定比例出現致命性一擊。等級${i}效果：發動率${procRate}%，暴擊攻擊力${critAttack}%。`
                        };
                    })
                },
                {
                    id: "focus",
                    name: "集中術",
                    maxLevel: 20,
                    requiredLevel: 10,
                    preRequisite: { "archeryMastery": 3 },
                    description: "可在一定時間集中精神，增加命中率和迴避率。",
                    imageUrl: "images/focus.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, hitRate, avoidRate, duration;
                        if (i === 0) return null;
                        mp = i <= 10 ? 8 : 16;
                        hitRate = i;
                        avoidRate = i;
                        duration = i * 10 + 100; // From 110s to 300s
                        return {
                            effect: `消耗MP: ${mp}, 命中率: ${hitRate}, 迴避率: ${avoidRate}, 持續時間: ${duration}秒`,
                            fullDescription: `可在一定時間集中精神，增加命中率和迴避率。等級${i}效果：消耗MP${mp}，命中率${hitRate}，迴避率${avoidRate}，持續時間${duration}秒。`
                        };
                    })
                },
                {
                    id: "arrowBlow",
                    name: "斷魂箭",
                    maxLevel: 20,
                    requiredLevel: 10,
                    preRequisite: {},
                    description: "發射強力的箭矢，對敵人造成較大的殺傷力。",
                    imageUrl: "images/arrowBlow.png", // 確保圖片檔案存在
                    levels: [
                        null,
                        { effect: "消耗MP: 8, 攻擊力: 190%", fullDescription: "發射強力的箭矢，對敵人造成較大的殺傷力。等級1效果：消耗MP8，攻擊力190%。" },
                        { effect: "消耗MP: 8, 攻擊力: 193%", fullDescription: "發射強力的箭矢，對敵人造成較大的殺傷力。等級2效果：消耗MP8，攻擊力193%。" }
                        // 等級3-20無數據，將顯示通用提示
                    ].concat(Array(18).fill({ effect: "無此等級效果資料", fullDescription: "數據缺失或無法精確計算此等級效果。" }))
                },
                {
                        "id": "doubleShot",
    "name": "二連箭",
    "maxLevel": 20,
    "requiredLevel": 10,
    "preRequisite": { "arrowBlow": 1 },
    "description": "一次射出兩枝箭，向怪物發動兩次攻擊。",
    "imageUrl": "images/doubleShot.png",
    "levels": Array(21).fill(null).map((_, i) => {
        let mpCost, attack;
        if (i === 0) return null;

        // 消耗MP 的規律 (精確數值)
        const mpCosts = [null, 8, 8, 8, 8, 9, 9, 11, 12, 10, 11, 11, 12, 12, 13, 13, 14, 14, 15, 15, 15];
        mpCost = mpCosts[i];

        // 攻擊力 的規律 (精確數值)
        const attacks = [null, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118, 120, 122, 124, 126, 128, 130];
        attack = attacks[i];

        return {
            effect: `消耗MP: ${mpCost}, 攻擊力: ${attack}%`,
            fullDescription: `一次射出兩枝箭，向怪物發動兩次攻擊。等級${i}效果：消耗MP${mpCost}，攻擊力${attack}%。`
        };
    })
                }
            ],
            "2轉 (獵人)": [
                {
                    id: "bowMastery",
                    name: "精準之弓",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "提升弓系列武器的命中率及熟練度，此技能必須是配帶弓的情況下，才能發揮作用。",
                    imageUrl: "images/bowMastery.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let hitRate, mastery;
                        if (i === 0) return null;
                        const hitRates = [null, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20];
                        const masteries = [null, 15, 15, 20, 20, 25, 25, 30, 30, 35, 35, 40, 40, 45, 45, 50, 50, 55, 55, 60, 60];
                        hitRate = hitRates[i];
                        mastery = masteries[i];
                        return {
                            effect: `命中率: ${hitRate}, 熟練度: ${mastery}%`,
                            fullDescription: `提升弓系列武器的命中率及熟練度，此技能必須是配帶弓的情況下，才能發揮作用。等級${i}效果：命中率${hitRate}，熟練度${mastery}%。`
                        };
                    })
                },
                {
                    id: "finalAttackBow",
                    name: "終極之弓",
                    maxLevel: 30,
                    requiredLevel: 30,
                    preRequisite: { "bowMastery": 3 },
                    description: "按照一定機率，在使用攻擊技能後發動連續攻擊。此技能必須是配帶弓的情況下，才能發揮作用。",
                    imageUrl: "images/finalAttackBow.png",
                    levels: Array(31).fill(null).map((_, i) => {
                        let procRate, attack;
                        if (i === 0) return null;
                        procRate = i * 2;
                        attack = 100 + i * 5;
                        return {
                            effect: `連續攻擊率: ${procRate}%, 攻擊力: ${attack}%`,
                            fullDescription: `按照一定機率，在使用攻擊技能後發動連續攻擊。此技能必須是配帶弓的情況下，才能發揮作用。等級${i}效果：連續攻擊率${procRate}%，攻擊力${attack}%。`
                        };
                    })
                },
                {
                    id: "bowBooster",
                    name: "快速之箭",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: { "bowMastery": 5 },
                    description: "消耗HP與MP，將使用弓箭的攻擊速度，向上提升一個等級。此技能必須是配帶弓的情況下，才能發揮作用。",
                    imageUrl: "images/bowBooster.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, hp, duration;
                        if (i === 0) return null;
                        const mpCosts = [null, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10];
                        const hpCosts = [null, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10];
                        const durations = [null, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 120, 140, 160, 180, 200, 220, 240, 260, 280, 300];
                        mp = mpCosts[i];
                        hp = hpCosts[i];
                        duration = durations[i];
                        return {
                            effect: `消耗MP: ${mp}, 消耗HP: ${hp}, 持續時間: ${duration}秒`,
                            fullDescription: `消耗HP與MP，將使用弓箭的攻擊速度，向上提升一個等級。此技能必須是配帶弓的情況下，才能發揮作用。等級${i}效果：消耗MP${mp}，消耗HP${hp}，持續${duration}秒。`
                        };
                    })
                },
                {
                    id: "powerKnockBack",
                    name: "強弓",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "提升揮動弓時使怪物後退的機率，而且隨著等級上升，可擊退怪物數量也會增加。",
                    imageUrl: "images/powerKnockBack.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, attack, knockbackRate, numEnemies;
                        if (i === 0) return null;
                        const mpCosts = [null, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 16, 16, 16, 16, 16, 16, 16, 16, 16, 15];
                        const attacks = [null, 105, 110, 115, 120, 125, 130, 135, 140, 145, 150, 155, 160, 165, 170, 175, 180, 185, 190, 195, 200];
                        const knockbackRates = [null, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 70];
                        const numEnemiesArr = [null, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 5, 5, 5, 5, 6];
                        mp = mpCosts[i];
                        attack = attacks[i];
                        knockbackRate = knockbackRates[i];
                        numEnemies = numEnemiesArr[i];
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%, 擊退率: ${knockbackRate}%, 擊怪數量: ${numEnemies}`,
                            fullDescription: `提升揮動弓時使怪物後退的機率，而且隨著等級上升，可擊退怪物數量也會增加。等級${i}效果：消耗MP${mp}，攻擊力${attack}%，擊退率${knockbackRate}%，擊怪數量${numEnemies}。`
                        };
                    })
                },
                {
    "id": "arrowPlatter",
    "name": "無形之箭",
    "maxLevel": 20,
    "requiredLevel": 30,
    "preRequisite": { "bowBooster": 5 },
    "description": "在一定時間內，攻擊附帶無視防禦效果。此技能必須是配帶弓或弩的情況下，才能發揮作用。",
    "imageUrl": "images/arrowPlatter.png",
    "levels": Array(21).fill(null).map((_, i) => {
        let mpCost, duration, ignoreDefense;
        if (i === 0) return null;

        // 消耗MP 的規律：1-10級為15，11-19級為30，20級為20
        if (i >= 1 && i <= 10) {
            mpCost = 15;
        } else if (i >= 11 && i <= 19) {
            mpCost = 30;
        } else if (i === 20) {
            mpCost = 20;
        }

        // 持續時間 的規律：
        // 1-10級: 10秒, 20秒, ..., 100秒 (每次加10秒)
        // 11-20級: 120秒, 140秒, ..., 300秒 (每次加20秒)
        if (i >= 1 && i <= 10) {
            duration = i * 10;
        } else if (i >= 11 && i <= 20) {
            duration = 100 + (i - 10) * 20;
        }

        // 無視防禦力 固定為4%
        ignoreDefense = 4;

        return {
            effect: `消耗MP: ${mpCost}, 持續時間: ${duration}秒, 無視防禦力: ${ignoreDefense}%`,
            fullDescription: `在一定時間內，攻擊附帶無視防禦效果。等級${i}效果：消耗MP${mpCost}，持續時間${duration}秒，無視防禦力${ignoreDefense}%。此技能必須是配帶弓或弩的情況下，才能發揮作用。`
        };
    })
},
                {
                    id: "bombArrow",
                    name: "炸彈箭",
                    maxLevel: 30,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "利用安裝炸彈的箭攻擊怪物，而周圍的怪物則以一定比例暈倒。能夠攻擊的對手上限為6人，而且只限配帶弓的狀況下才能使用。",
                    imageUrl: "images/bombArrow.png",
                    levels: Array(31).fill(null).map((_, i) => {
                        let mp, attack, stunRate;
                        if (i === 0) return null;
                        mp = i <= 15 ? 14 : 28;
                        attack = 70 + i * 2;
                        stunRate = 30 + i;
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%, 暈眩率: ${stunRate}%`,
                            fullDescription: `利用安裝炸彈的箭攻擊怪物，而周圍的怪物則以一定比例暈倒。等級${i}效果：消耗MP${mp}，攻擊力${attack}%，暈眩率${stunRate}%。`
                        };
                    })
                }
            ],
            "3轉 (遊俠)": [
                {
                    id: "nimbleFeet", // 假設這是疾風步，因為移動速度增加
                    name: "疾風步",
                    maxLevel: 20,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "提升移動速度",
                    imageUrl: "images/nimbleFeet.png",
                    levels: Array(21).fill(null).map((_, i) => i === 0 ? null : {
                        effect: `移動速度: ${10 + i}`,
                        fullDescription: `提升移動速度。等級${i}效果：移動速度${10 + i}。`
                    })
                },
                 {
    "id": "mortalBlow",
    "name": "致命箭",
    "maxLevel": 20,
    "requiredLevel": 70,
    "preRequisite": {},
    "description": "無視怪物5%物理防禦，同時增加昇龍弩跟箭雨傷害60%。",
    "imageUrl": "images/mortalBlow.png",
    "levels": Array(21).fill(null).map((_, i) => {
        let ignoreDef, dmgIncrease;
        if (i === 0) return null;

        // 無視防禦力 的規律
        if (i >= 1 && i <= 5) {
            ignoreDef = 1;
        } else if (i >= 6 && i <= 10) {
            ignoreDef = 2;
        } else if (i >= 11 && i <= 15) {
            ignoreDef = 3;
        } else if (i >= 16 && i <= 19) {
            ignoreDef = 4;
        } else if (i === 20) {
            ignoreDef = 5;
        }

        // 傷害增加 的規律：線性增加 (每次加3%) => i * 3
        dmgIncrease = i * 3;

        return {
            effect: `無視防禦力: ${ignoreDef}%, 傷害增加: ${dmgIncrease}%`,
            fullDescription: `無視怪物5%物理防禦，同時增加昇龍弩跟箭雨傷害60%。等級${i}效果：無視防禦力${ignoreDef}%，傷害增加${dmgIncrease}%。`
        };
    })
},
                {
                    id: "puppet",
                    name: "替身術",
                    maxLevel: 20,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "在一定時間內製造出自己的分身。 怪物攻擊時傀儡代替承受25%傷害的效果。",
                    imageUrl: "images/puppet.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, dmgReduction, duration;
                        if (i === 0) return null;
                        const mpCosts = [null, 23, 23, 23, 23, 23, 26, 26, 26, 26, 26, 29, 29, 29, 29, 29, 32, 32, 32, 32, 32];
                        const dmgReductions = [null, 10, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25];
                        const durations = [null, 5, 5, 10, 10, 10, 20, 20, 20, 30, 30, 30, 40, 40, 40, 50, 50, 50, 60, 60, 60];
                        mp = mpCosts[i];
                        dmgReduction = dmgReductions[i];
                        duration = durations[i];
                        return {
                            effect: `消耗MP: ${mp}, 抵擋傷害: ${dmgReduction}%, 持續時間: ${duration}秒`,
                            fullDescription: `在一定時間內製造出自己的分身。怪物攻擊時傀儡代替承受25%傷害的效果。等級${i}效果：消耗MP${mp}，抵擋傷害${dmgReduction}%，持續${duration}秒。`
                        };
                    })
                },
                {
    "id": "strafeBow",
    "name": "四連箭",
    "maxLevel": 30,
    "requiredLevel": 70,
    "preRequisite": {},
    "description": "同時射出四發弓箭給予敵人四次傷害。只限裝備弓箭才可使用。增加BOSS傷害20%，增加爆擊率30%，最大爆擊傷害上限為150%，最大爆擊率上限為70%。",
    "imageUrl": "images/strafeBow.png",
    "levels": Array(31).fill(null).map((_, i) => {
        let mpCost, attack, bonusCritRate;
        if (i === 0) return null;

        // 消耗MP 的規律：
        // 1-15級: 26
        // 16-30級: 32
        if (i >= 1 && i <= 15) {
            mpCost = 26;
        } else if (i >= 16 && i <= 30) {
            mpCost = 32;
        }

        // 攻擊力 的規律：71% 到 100% (每次加1%) => 70 + i
        attack = 70 + i;

        // 追加爆擊機率 的規律：1% 到 30% (每次加1%) => i
        bonusCritRate = i;

        return {
            effect: `消耗MP: ${mpCost}, 攻擊力: ${attack}%, 追加爆擊機率: ${bonusCritRate}%`,
            fullDescription: `同時射出四發弓箭給予敵人四次傷害。只限裝備弓箭才可使用。等級${i}效果：消耗MP${mpCost}，攻擊力${attack}%，追加爆擊機率${bonusCritRate}%。增加BOSS傷害20%，增加爆擊率30%，最大爆擊傷害上限為150%，最大爆擊率上限為70%。`
        };
    })
},
                {
                    id: "inferno",
                    name: "烈火箭",
                    maxLevel: 30,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "利用烈焰攻擊敵人，在攻擊目標敵人的同時也會使周圍敵人造成傷害。最多攻擊6個敵人，只限裝備弓箭才能使用。",
                    imageUrl: "images/inferno.png",
                    levels: Array(31).fill(null).map((_, i) => {
                        let mp, attack;
                        if (i === 0) return null;
                        mp = i <= 10 ? 20 : (i <= 20 ? 25 : 30);
                        attack = 49 + i * 3; // Simplified
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%`,
                            fullDescription: `利用烈焰攻擊敵人，在攻擊目標敵人的同時也會使周圍敵人造成傷害。等級${i}效果：消耗MP${mp}，攻擊力${attack}%。`
                        };
                    })
                },
                {
                        "id": "arrowRain",
    "name": "箭雨",
    "maxLevel": 30,
    "requiredLevel": 70,
    "preRequisite": { "mortalBlow": 5 },
    "description": "從高空墜落箭雨攻擊周圍的敵人，最多攻擊6個怪物。只限裝備弓箭才能使用。",
    "imageUrl": "images/arrowRain.png",
    "levels": Array(31).fill(null).map((_, i) => {
        let mpCost, attack;
        if (i === 0) return null;

        // 消耗MP 的規律
        if (i >= 1 && i <= 10) {
            mpCost = 18;
        } else if (i >= 11 && i <= 20) {
            mpCost = 23;
        } else if (i >= 21 && i <= 30) {
            mpCost = 28;
        }

        // 攻擊力 的規律 (精確數值)
        const attacks = [null, 80, 83, 86, 89, 92, 95, 98, 101, 104, 107, 110, 113, 116, 119, 122, 125, 128, 131, 134, 137, 140, 143, 146, 149, 152, 154, 156, 158, 159, 160];
        attack = attacks[i];

        return {
            effect: `消耗MP: ${mpCost}, 攻擊力: ${attack}%`,
            fullDescription: `從高空墜落箭雨攻擊周圍的敵人，最多攻擊6個怪物。等級${i}效果：消耗MP${mpCost}，攻擊力${attack}%。`
        };
    })
                },
                {
                    id: "summonSilverHawk",
                    name: "銀鷹召喚",
                    maxLevel: 30,
                    requiredLevel: 70,
                    preRequisite: { "puppet": 5 },
                    description: "消費召喚石召喚銀色老鷹，在一定的時間會跟隨在主人周圍，並且對附近的怪物發動攻擊。",
                    imageUrl: "images/summonSilverHawk.png",
                    levels: Array(31).fill(null).map((_, i) => {
                        let mp, procRate, numAttacks, duration;
                        if (i === 0) return null;
                        mp = 30 + Math.floor((i - 1) / 5) * 2; // Simplified
                        procRate = 50 + Math.floor((i - 1) / 5) * 3; // Simplified
                        numAttacks = 13 + Math.floor((i - 1) / 5) * 3; // Simplified
                        duration = 100 + Math.floor((i - 1) / 5) * 15; // Simplified
                        return {
                            effect: `消耗MP: ${mp}, 發動率: ${procRate}%, 攻擊次數: ${numAttacks}, 持續時間: ${duration}秒`,
                            fullDescription: `消費召喚石召喚銀色老鷹，在一定的時間會跟隨在主人周圍，並且對附近的怪物發動攻擊。等級${i}效果：消耗MP${mp}，發動率${procRate}%，攻擊次數${numAttacks}，持續時間${duration}秒。`
                        };
                    })
                }
            ],
            "4轉 (箭神)": [],
            "超技能": [],
            "5轉技能": [],
            "共通技能": []
        }
    },
            "神射手 (Marksman)": {
        startingLevelForSp: 10, // 弓箭手系通常10等轉職
        jobAdvancementSpBonuses: [10, 30, 70, 120],
        jobStagesOrder: ["0轉 (新手)", "1轉 (弓箭手)", "2轉 (弩弓手)", "3轉 (狙擊手)", "4轉 (神射手)", "超技能", "5轉技能", "共通技能"],
        spRequiredFor2ndJob: 61, // 其他職業2轉點數需求
        spRequiredFor3rdJob: 182, // 其他職業3轉點數需求
        spRequiredFor4thJob: 249, // 4轉通用點數需求
skills: {
            "0轉 (新手)": [],
            "1轉 (弓箭手)": [
                {
                    id: "archeryMastery",
                    name: "精準強化",
                    maxLevel: 16,
                    requiredLevel: 10,
                    preRequisite: {},
                    description: "增加命中率",
                    imageUrl: "images/archeryMastery.png", // 確保圖片檔案存在
                    levels: Array(17).fill(null).map((_, i) => i === 0 ? null : {
                        effect: `命中率: ${i}`,
                        fullDescription: `增加命中率。等級${i}效果：命中率${i}。`
                    })
                },
                {
                    id: "eyeOfTheAmazon",
                    name: "百步穿楊",
                    maxLevel: 8,
                    requiredLevel: 10,
                    preRequisite: { "archeryMastery": 3 },
                    description: "增加弓或弩弓的射程距離",
                    imageUrl: "images/eyeOfTheAmazon.png", // 確保圖片檔案存在
                    levels: [
                        null, null, null, null, null, null, null, null,
                        { effect: "射程: 120", fullDescription: "增加弓或弩弓的射程距離。等級8效果：射程120。" }
                    ]
                },
                {
                    id: "criticalShot",
                    name: "霸王箭",
                    maxLevel: 20,
                    requiredLevel: 10,
                    preRequisite: {},
                    description: "攻擊中會有一定比例出現致命性一擊",
                    imageUrl: "images/criticalShot.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let procRate, critAttack;
                        if (i === 0) return null;
                        procRate = i * 2;
                        critAttack = 100 + i * 5;
                        return {
                            effect: `發動率: ${procRate}%, 暴擊攻擊力: ${critAttack}%`,
                            fullDescription: `攻擊中會有一定比例出現致命性一擊。等級${i}效果：發動率${procRate}%，暴擊攻擊力${critAttack}%。`
                        };
                    })
                },
                {
                    id: "focus",
                    name: "集中術",
                    maxLevel: 20,
                    requiredLevel: 10,
                    preRequisite: { "archeryMastery": 3 },
                    description: "可在一定時間集中精神，增加命中率和迴避率。",
                    imageUrl: "images/focus.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, hitRate, avoidRate, duration;
                        if (i === 0) return null;
                        mp = i <= 10 ? 8 : 16;
                        hitRate = i;
                        avoidRate = i;
                        duration = i * 10 + 100;
                        return {
                            effect: `消耗MP: ${mp}, 命中率: ${hitRate}, 迴避率: ${avoidRate}, 持續時間: ${duration}秒`,
                            fullDescription: `可在一定時間集中精神，增加命中率和迴避率。等級${i}效果：消耗MP${mp}，命中率${hitRate}，迴避率${avoidRate}，持續時間${duration}秒。`
                        };
                    })
                },
                {
                    id: "arrowBlow",
                    name: "斷魂箭",
                    maxLevel: 20,
                    requiredLevel: 10,
                    preRequisite: {},
                    description: "發射強力的箭矢，對敵人造成較大的殺傷力。",
                    imageUrl: "images/arrowBlow.png",
                    levels: [
                        null,
                        { effect: "消耗MP: 8, 攻擊力: 190%", fullDescription: "發射強力的箭矢，對敵人造成較大的殺傷力。等級1效果：消耗MP8，攻擊力190%。" },
                        { effect: "消耗MP: 8, 攻擊力: 193%", fullDescription: "發射強力的箭矢，對敵人造成較大的殺傷力。等級2效果：消耗MP8，攻擊力193%。" }
                    ].concat(Array(18).fill({ effect: "無此等級效果資料", fullDescription: "數據缺失或無法精確計算此等級效果。" }))
                },
                {
                        "id": "doubleShot",
    "name": "二連箭",
    "maxLevel": 20,
    "requiredLevel": 10,
    "preRequisite": { "arrowBlow": 1 },
    "description": "一次射出兩枝箭，向怪物發動兩次攻擊。",
    "imageUrl": "images/doubleShot.png",
    "levels": Array(21).fill(null).map((_, i) => {
        let mpCost, attack;
        if (i === 0) return null;

        // 消耗MP 的規律 (精確數值)
        const mpCosts = [null, 8, 8, 8, 8, 9, 9, 11, 12, 10, 11, 11, 12, 12, 13, 13, 14, 14, 15, 15, 15];
        mpCost = mpCosts[i];

        // 攻擊力 的規律 (精確數值)
        const attacks = [null, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118, 120, 122, 124, 126, 128, 130];
        attack = attacks[i];

        return {
            effect: `消耗MP: ${mpCost}, 攻擊力: ${attack}%`,
            fullDescription: `一次射出兩枝箭，向怪物發動兩次攻擊。等級${i}效果：消耗MP${mpCost}，攻擊力${attack}%。`
        };
    })
                }
            ],
            "2轉 (弩弓手)": [
                {
                    id: "crossbowMastery",
                    name: "精準之弩",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "提升弩系列武器的命中率及熟練度，此技能必須是配帶弩的情況下，才能發揮作用。",
                    imageUrl: "images/crossbowMastery.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let hitRate, mastery;
                        if (i === 0) return null;
                        const hitRates = [null, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20];
                        const masteries = [null, 15, 15, 20, 20, 25, 25, 30, 30, 35, 35, 40, 40, 45, 45, 50, 50, 55, 55, 60, 60];
                        hitRate = hitRates[i];
                        mastery = masteries[i];
                        return {
                            effect: `命中率: ${hitRate}, 熟練度: ${mastery}%`,
                            fullDescription: `提升弩系列武器的命中率及熟練度，此技能必須是配帶弩的情況下，才能發揮作用。等級${i}效果：命中率${hitRate}，熟練度${mastery}%。`
                        };
                    })
                },
                {
                    id: "finalAttackCrossbow",
                    name: "終極之弩",
                    maxLevel: 30,
                    requiredLevel: 30,
                    preRequisite: { "crossbowMastery": 3 },
                    description: "按照一定機率，在使用攻擊技能後發動連續攻擊。此技能必須是配帶弩的情況下，才能發揮作用。",
                    imageUrl: "images/finalAttackCrossbow.png",
                    levels: Array(31).fill(null).map((_, i) => {
                        let procRate, attack;
                        if (i === 0) return null;
                        procRate = i * 2;
                        attack = 100 + i * 5;
                        return {
                            effect: `連續攻擊率: ${procRate}%, 攻擊力: ${attack}%`,
                            fullDescription: `按照一定機率，在使用攻擊技能後發動連續攻擊。此技能必須是配帶弩的情況下，才能發揮作用。等級${i}效果：連續攻擊率${procRate}%，攻擊力${attack}%。`
                        };
                    })
                },
                {
                    id: "crossbowBooster",
                    name: "快速之弩",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: { "crossbowMastery": 5 },
                    description: "消耗HP與MP，將使用弩的攻擊速度，向上提升一個等級。此技能必須是配帶弩的情況下，才能發揮作用。",
                    imageUrl: "images/crossbowBooster.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, hp, duration;
                        if (i === 0) return null;
                        const mpCosts = [null, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10];
                        const hpCosts = [null, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10];
                        const durations = [null, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 120, 140, 160, 180, 200, 220, 240, 260, 280, 300];
                        mp = mpCosts[i];
                        hp = hpCosts[i];
                        duration = durations[i];
                        return {
                            effect: `消耗MP: ${mp}, 消耗HP: ${hp}, 持續時間: ${duration}秒`,
                            fullDescription: `消耗HP與MP，將使用弩的攻擊速度，向上提升一個等級。此技能必須是配帶弩的情況下，才能發揮作用。等級${i}效果：消耗MP${mp}，消耗HP${hp}，持續${duration}秒。`
                        };
                    })
                },
                {
                    id: "boltBurst",
                    name: "強弩",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "提升揮動弩時使怪物後退的機率，而且隨著等級上升，可擊退怪物數量也會增加。",
                    imageUrl: "images/boltBurst.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, attack, knockbackRate, numEnemies;
                        if (i === 0) return null;
                        const mpCosts = [null, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16];
                        const attacks = [null, 105, 110, 115, 120, 125, 130, 135, 140, 145, 150, 155, 160, 165, 170, 175, 180, 185, 190, 195, 200];
                        const knockbackRates = [null, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40];
                        const numEnemiesArr = [null, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5];
                        mp = mpCosts[i];
                        attack = attacks[i];
                        knockbackRate = knockbackRates[i];
                        numEnemies = numEnemiesArr[i];
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%, 擊退率: ${knockbackRate}%, 擊怪數量: ${numEnemies}`,
                            fullDescription: `提升揮動弩時使怪物後退的機率，而且隨著等級上升，可擊退怪物數量也會增加。等級${i}效果：消耗MP${mp}，攻擊力${attack}%，擊退率${knockbackRate}%，擊怪數量${numEnemies}。`
                        };
                    })
                },
                {
                    id: "arrowPlatter",
                    name: "無形之箭",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: { "crossbowBooster": 5 },
                    description: "在一定時間內，在不需消耗箭的情況下，也可進行攻擊。此技能必須是配帶弓或弩的情況下，才能發揮作用。",
                    imageUrl: "images/arrowPlatter.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, duration, ignoreDef;
                        if (i === 0) return null;
                        mp = i <= 10 ? 15 : 30;
                        duration = i * 30;
                        ignoreDef = 4; // 固定4%
                        return {
                            effect: `消耗MP: ${mp}, 持續時間: ${duration}秒, 無視防禦力: ${ignoreDef}%`,
                            fullDescription: `在一定時間內，在不需消耗箭的情況下，也可進行攻擊。等級${i}效果：消耗MP${mp}，持續時間${duration}秒，無視防禦力${ignoreDef}%。`
                        };
                    })
                },
                {
                    id: "piercingArrow",
                    name: "穿透之箭",
                    maxLevel: 30,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "發射的弩箭可貫穿怪物，每當慣穿第一個怪物時，其殺傷力會減弱，最多能貫穿6個怪物。此技能必須是配帶弩的情況下，才能發揮作用。",
                    imageUrl: "images/piercingArrow.png",
                    levels: Array(31).fill(null).map((_, i) => {
                        let mp, attack;
                        if (i === 0) return null;
                        mp = i <= 15 ? 14 : 28;
                        attack = 120 + i * 3; // Simplified
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%`,
                            fullDescription: `發射的弩箭可貫穿怪物，每當慣穿第一個怪物時，其殺傷力會減弱，最多能貫穿6個怪物。等級${i}效果：消耗MP${mp}，攻擊力${attack}%。`
                        };
                    })
                }
            ],
            "3轉 (狙擊手)": [
                {
                    id: "nimbleFeet",
                    name: "疾風步",
                    maxLevel: 20,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "提升移動速度",
                    imageUrl: "images/nimbleFeet.png",
                    levels: Array(21).fill(null).map((_, i) => i === 0 ? null : {
                        effect: `移動速度: ${10 + i}`,
                        fullDescription: `提升移動速度。等級${i}效果：移動速度${10 + i}。`
                    })
                },
                {
    "id": "mortalBlow",
    "name": "致命箭",
    "maxLevel": 20,
    "requiredLevel": 70,
    "preRequisite": {},
    "description": "無視怪物5%物理防禦，同時增加昇龍弩跟箭雨傷害60%。",
    "imageUrl": "images/mortalBlow.png",
    "levels": Array(21).fill(null).map((_, i) => {
        let ignoreDef, dmgIncrease;
        if (i === 0) return null;

        // 無視防禦力 的規律
        if (i >= 1 && i <= 5) {
            ignoreDef = 1;
        } else if (i >= 6 && i <= 10) {
            ignoreDef = 2;
        } else if (i >= 11 && i <= 15) {
            ignoreDef = 3;
        } else if (i >= 16 && i <= 19) {
            ignoreDef = 4;
        } else if (i === 20) {
            ignoreDef = 5;
        }

        // 傷害增加 的規律：線性增加 (每次加3%) => i * 3
        dmgIncrease = i * 3;

        return {
            effect: `無視防禦力: ${ignoreDef}%, 傷害增加: ${dmgIncrease}%`,
            fullDescription: `無視怪物5%物理防禦，同時增加昇龍弩跟箭雨傷害60%。等級${i}效果：無視防禦力${ignoreDef}%，傷害增加${dmgIncrease}%。`
        };
    })
},
                {
                    id: "puppet",
                    name: "替身術",
                    maxLevel: 20,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "在一定時間內製造出自己的分身。 怪物攻擊時傀儡代替承受25%傷害的效果。",
                    imageUrl: "images/puppet.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, dmgReduction, duration;
                        if (i === 0) return null;
                        const mpCosts = [null, 23, 23, 23, 23, 23, 26, 26, 26, 26, 26, 29, 29, 29, 29, 29, 32, 32, 32, 32, 32];
                        const dmgReductions = [null, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25];
                        const durations = [null, 5, 5, 10, 10, 10, 20, 20, 20, 30, 30, 30, 40, 40, 40, 50, 50, 50, 60, 60, 60];
                        mp = mpCosts[i];
                        dmgReduction = dmgReductions[i];
                        duration = durations[i];
                        return {
                            effect: `消耗MP: ${mp}, 抵擋傷害: ${dmgReduction}%, 持續時間: ${duration}秒`,
                            fullDescription: `在一定時間內製造出自己的分身。怪物攻擊時傀儡代替承受25%傷害的效果。等級${i}效果：消耗MP${mp}，抵擋傷害${dmgReduction}%，持續${duration}秒。`
                        };
                    })
                },
                {
    "id": "strafeBow",
    "name": "四連箭",
    "maxLevel": 30,
    "requiredLevel": 70,
    "preRequisite": {},
    "description": "同時射出四發弓箭給予敵人四次傷害。只限裝備弓箭才可使用。增加BOSS傷害20%，增加爆擊率30%，最大爆擊傷害上限為150%，最大爆擊率上限為70%。",
    "imageUrl": "images/strafeBow.png",
    "levels": Array(31).fill(null).map((_, i) => {
        let mpCost, attack, bonusCritRate;
        if (i === 0) return null;

        // 消耗MP 的規律：
        // 1-15級: 26
        // 16-30級: 32
        if (i >= 1 && i <= 15) {
            mpCost = 26;
        } else if (i >= 16 && i <= 30) {
            mpCost = 32;
        }

        // 攻擊力 的規律：71% 到 100% (每次加1%) => 70 + i
        attack = 70 + i;

        // 追加爆擊機率 的規律：1% 到 30% (每次加1%) => i
        bonusCritRate = i;

        return {
            effect: `消耗MP: ${mpCost}, 攻擊力: ${attack}%, 追加爆擊機率: ${bonusCritRate}%`,
            fullDescription: `同時射出四發弓箭給予敵人四次傷害。只限裝備弓箭才可使用。等級${i}效果：消耗MP${mpCost}，攻擊力${attack}%，追加爆擊機率${bonusCritRate}%。增加BOSS傷害20%，增加爆擊率30%，最大爆擊傷害上限為150%，最大爆擊率上限為70%。`
        };
    })
},
                {
                    id: "blizzardCrossbow", // 寒冰箭對應冰屬性攻擊
                    name: "寒冰箭",
                    maxLevel: 30,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "利用寒冰攻擊敵人，在攻擊目標敵人的同時也會使周圍敵人造成傷害。最多攻擊6個敵人，只限裝備弩弓的情況下才能使用。",
                    imageUrl: "images/blizzardCrossbow.png",
                    levels: Array(31).fill(null).map((_, i) => {
                        let mp, attack, freezeDuration;
                        if (i === 0) return null;
                        mp = i <= 10 ? 20 : (i <= 20 ? 25 : 30);
                        attack = 99 + i; // Simplified
                        freezeDuration = i <= 10 ? 1 : (i <= 20 ? 2 : 3);
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%, 冰凍時間: ${freezeDuration}秒`,
                            fullDescription: `利用寒冰攻擊敵人，在攻擊目標敵人的同時也會使周圍敵人造成傷害。等級${i}效果：消耗MP${mp}，攻擊力${attack}%，冰凍時間${freezeDuration}秒。`
                        };
                    })
                },
                {
                    id: "arrowEruptionCrossbow", // 昇龍弩，針對弩弓
                    name: "昇龍弩",
                    maxLevel: 30,
                    requiredLevel: 70,
                    preRequisite: { "mortalBlow": 5 },
                    description: "從地面向高空發射弩箭攻擊周圍的敵人，最多可攻擊6個怪物。只限裝備弩弓的情況下才能使用。",
                    imageUrl: "images/arrowEruptionCrossbow.png",
                    levels: Array(31).fill(null).map((_, i) => {
                        let mp, attack;
                        if (i === 0) return null;
                        mp = i <= 10 ? 18 : (i <= 20 ? 23 : 28);
                        attack = 59 + i * 3.5; // Simplified
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%`,
                            fullDescription: `從地面向高空發射弩箭攻擊周圍的敵人，最多可攻擊6個怪物。等級${i}效果：消耗MP${mp}，攻擊力${attack}%。`
                        };
                    })
                },
                {
                    id: "summonGoldenEagle",
                    name: "金鷹召喚",
                    maxLevel: 30,
                    requiredLevel: 70,
                    preRequisite: { "puppet": 5 },
                    description: "消費召喚石召喚金色老鷹，在一定的時間會跟隨在主人周圍，並且對附近的怪物發動攻擊。",
                    imageUrl: "images/summonGoldenEagle.png",
                    levels: Array(31).fill(null).map((_, i) => {
                        let mp, procRate, numAttacks, duration;
                        if (i === 0) return null;
                        mp = 30 + Math.floor((i - 1) / 5) * 2; // Simplified
                        procRate = 50 + Math.floor((i - 1) / 5) * 3; // Simplified
                        numAttacks = 13 + Math.floor((i - 1) / 5) * 3; // Simplified
                        duration = 100 + Math.floor((i - 1) / 5) * 15; // Simplified
                        return {
                            effect: `消耗MP: ${mp}, 發動率: ${procRate}%, 攻擊次數: ${numAttacks}, 持續時間: ${duration}秒`,
                            fullDescription: `消費召喚石召喚金色老鷹，在一定的時間會跟隨在主人周圍，並且對附近的怪物發動攻擊。等級${i}效果：消耗MP${mp}，發動率${procRate}%，攻擊次數${numAttacks}，持續時間${duration}秒。`
                        };
                    })
                }
            ],
            "4轉 (神射手)": [],
            "超技能": [],
            "5轉技能": [],
            "共通技能": []
        }
    },
            "暗影神偷 (Shadower)": {
        startingLevelForSp: 10, // 盜賊系通常10等轉職
        jobAdvancementSpBonuses: [10, 30, 70, 120],
        jobStagesOrder: ["0轉 (新手)", "1轉 (盜賊)", "2轉 (俠盜)", "3轉 (神偷)", "4轉 (暗影神偷)", "超技能", "5轉技能", "共通技能"],
        spRequiredFor2ndJob: 61, // 其他職業2轉點數需求
        spRequiredFor3rdJob: 182, // 其他職業3轉點數需求
        spRequiredFor4thJob: 249, // 4轉通用點數需求
skills: {
            "0轉 (新手)": [],
            "1轉 (盜賊)": [
                {
                    id: "haste",
                    name: "幻化術",
                    maxLevel: 20,
                    requiredLevel: 10,
                    preRequisite: {},
                    description: "增加命中率和迴避率",
                    imageUrl: "images/haste.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => i === 0 ? null : {
                        effect: `命中率: ${i}, 迴避率: ${i}`,
                        fullDescription: `增加命中率和迴避率。等級${i}效果：命中率${i}，迴避率${i}。`
                    })
                },
                {
                    id: "keenEyes",
                    name: "鷹之眼",
                    maxLevel: 8,
                    requiredLevel: 10,
                    preRequisite: { "haste": 3 },
                    description: "增加暗器系武器的射程距離",
                    imageUrl: "images/keenEyes.png", // 確保圖片檔案存在
                    levels: Array(9).fill(null).map((_, i) => {
                        const rangePercent = 25 * i;
                        return i === 0 ? null : {
                            effect: `射程: ${rangePercent}%`,
                            fullDescription: `增加暗器系武器的射程距離。等級${i}效果：射程${rangePercent}%。`
                        };
                    })
                },
                {
                    id: "curse",
                    name: "詛咒術",
                    maxLevel: 20,
                    requiredLevel: 10,
                    preRequisite: {},
                    description: "可於一定時間降低怪物的物理防禦力。（適用於BOSS）",
                    imageUrl: "images/curse.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => {
                        const mp = i <= 10 ? 5 : 10;
                        const defReduction = i * 0.5;
                        const duration = i * 3;
                        return i === 0 ? null : {
                            effect: `消耗MP: ${mp}, 物理防禦: -${defReduction}%, 持續時間: ${duration}秒`,
                            fullDescription: `可於一定時間降低怪物的物理防禦力。（適用於BOSS）等級${i}效果：消耗MP${mp}，物理防禦-${defReduction}%，持續${duration}秒。`
                        };
                    })
                },
                {
                    id: "darkSight",
                    name: "隱身術",
                    maxLevel: 20,
                    requiredLevel: 10,
                    preRequisite: {},
                    description: "一定時間內消耗MP而隱身於影子之中。不會受怪物攻擊但會受環境影響如地震、毒氣、會損血的環境，無法攻擊怪物，無法喝水撿取物品，但其他行動則會正常，使用普通攻擊可以解除隱身。",
                    imageUrl: "images/darkSight.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, moveSpeed, duration;
                        if (i === 0) return null;
                        const mpCosts = [null, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5];
                        const moveSpeeds = [null, -30, -28, -26, -24, -22, -20, -18, -16, -14, -12, -10, -8, -7, -6, -5, -4, -3, -2, -1, 0];
                        const durations = Array(21).fill(10); // 持續時間固定10秒
                        mp = mpCosts[i];
                        moveSpeed = moveSpeeds[i];
                        duration = durations[i];
                        return {
                            effect: `消耗MP: ${mp}, 移動速度: ${moveSpeed}, 持續時間: ${duration}秒`,
                            fullDescription: `一定時間內消耗MP而隱身於影子之中。等級${i}效果：消耗MP${mp}，移動速度${moveSpeed}，持續${duration}秒。`
                        };
                    })
                },
                {
                    id: "doubleStab",
                    name: "劈空斬",
                    maxLevel: 20,
                    requiredLevel: 10,
                    preRequisite: {},
                    description: "消耗 MP 使用短刀連續攻擊怪物兩次。",
                    imageUrl: "images/doubleStab.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, attack;
                        if (i === 0) return null;
                        const mpCosts = [null, 6, 6, 6, 6, 7, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, 14];
                        const attacks = [null, 103, 106, 109, 112, 115, 118, 121, 124, 127, 130, 133, 136, 139, 142, 145, 148, 151, 154, 157, 160];
                        mp = mpCosts[i];
                        attack = attacks[i];
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%`,
                            fullDescription: `消耗MP使用短刀連續攻擊怪物兩次。等級${i}效果：消耗MP${mp}，攻擊力${attack}%。`
                        };
                    })
                },
                {
                    id: "luckySeven",
                    name: "雙飛斬",
                    maxLevel: 20,
                    requiredLevel: 10,
                    preRequisite: {},
                    description: "消耗MP，發射兩個飛鏢向怪物進行攻擊，而攻擊力則受幸運數值的影響。不受暗器精準的影響，以固定的形式進行攻擊。",
                    imageUrl: "images/luckySeven.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, attack;
                        if (i === 0) return null;
                        const mpCosts = [null, 8, 8, 8, 8, 9, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, 14, 14, 15, 15, 16];
                        const attacks = [null, 58, 62, 68, 72, 78, 84, 88, 94, 98, 104, 108, 114, 118, 124, 128, 132, 136, 142, 144, 150];
                        mp = mpCosts[i];
                        attack = attacks[i];
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%`,
                            fullDescription: `消耗MP，發射兩個飛鏢向怪物進行攻擊，而攻擊力則受幸運數值的影響。等級${i}效果：消耗MP${mp}，攻擊力${attack}%。`
                        };
                    })
                }
            ],
            "2轉 (俠盜)": [
                {
                    id: "recovery",
                    name: "恢復術",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "提高恢復HP/ MP。當等級提高，恢復速度會愈快，所能恢復量也會變多。",
                    imageUrl: "images/recovery.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => {
                        let recoveryTime, hpAdd, mpAdd;
                        if (i === 0) return null;
                        const recoveryTimes = [null, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10];
                        const hpAdds = [null, 3, 6, 9, 12, 15, 18, 21, 24, 27, 30, 33, 36, 39, 42, 45, 48, 51, 54, 57, 60];
                        const mpAdds = [null, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20];
                        recoveryTime = recoveryTimes[i];
                        hpAdd = hpAdds[i];
                        mpAdd = mpAdds[i];
                        return {
                            effect: `回復時間: ${recoveryTime}秒, HP追加回復量: ${hpAdd}, MP追加回復量: ${mpAdd}`,
                            fullDescription: `提高恢復HP/ MP。等級${i}效果：回復時間${recoveryTime}秒，HP追加回復量${hpAdd}，MP追加回復量${mpAdd}。`
                        };
                    })
                },
                {
                    id: "booster",
                    name: "速度激發",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "於一定時間內，提升所有隊員的移動速度與跳躍力。",
                    imageUrl: "images/booster.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, moveSpeed, jump, duration;
                        if (i === 0) return null;
                        const mpCosts = [null, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30];
                        const moveSpeeds = [null, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40];
                        const jumps = [null, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20];
                        const durations = [null, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 120, 140, 160, 180, 200, 220, 240, 260, 280, 300];
                        mp = mpCosts[i];
                        moveSpeed = moveSpeeds[i];
                        jump = jumps[i];
                        duration = durations[i];
                        return {
                            effect: `消耗MP: ${mp}, 移動速度: ${moveSpeed}, 跳躍力: ${jump}, 持續時間: ${duration}秒`,
                            fullDescription: `於一定時間內，提升所有隊員的移動速度與跳躍力。等級${i}效果：消耗MP${mp}，移動速度${moveSpeed}，跳躍力${jump}，持續時間${duration}秒。`
                        };
                    })
                },
                {
                    id: "daggerMastery",
                    name: "精準之刀",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "提升短劍系列武器的命中率及熟練度，該技能只限在配帶短劍的情況下，才會發揮效力。",
                    imageUrl: "images/daggerMastery.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => {
                        let hitRate, mastery;
                        if (i === 0) return null;
                        const hitRates = [null, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20];
                        const masteries = [null, 15, 15, 20, 20, 25, 25, 30, 30, 35, 35, 40, 40, 45, 45, 50, 50, 55, 55, 60, 60];
                        hitRate = hitRates[i];
                        mastery = masteries[i];
                        return {
                            effect: `命中率: ${hitRate}, 熟練度: ${mastery}%`,
                            fullDescription: `提升短劍系列武器的命中率及熟練度，該技能只限在配帶短劍的情況下，才會發揮效力。等級${i}效果：命中率${hitRate}，熟練度${mastery}%。`
                        };
                    })
                },
                {
                    id: "daggerBooster",
                    name: "快速之刀",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: { "daggerMastery": 5 },
                    description: "消耗HP與MP，而使一定時間內，讓所配帶的短劍的攻擊速度，向上提升一個等級。該技能只限在配帶短劍的情況下，才會發揮效力。",
                    imageUrl: "images/daggerBooster.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, hp, duration;
                        if (i === 0) return null;
                        const mpCosts = [null, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10];
                        const hpCosts = [null, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10];
                        const durations = [null, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 120, 140, 160, 180, 200, 220, 240, 260, 280, 300];
                        mp = mpCosts[i];
                        hp = hpCosts[i];
                        duration = durations[i];
                        return {
                            effect: `消耗MP: ${mp}, 消耗HP: ${hp}, 持續時間: ${duration}秒`,
                            fullDescription: `消耗HP與MP，而使一定時間內，讓所配帶的短劍的攻擊速度，向上提升一個等級。等級${i}效果：消耗MP${mp}，消耗HP${hp}，持續${duration}秒。`
                        };
                    })
                },
                {
                    id: "steal",
                    name: "妙手術",
                    maxLevel: 30,
                    requiredLevel: 30,
                    preRequisite: { "booster": 5 },
                    description: "攻擊範圍內的敵人，並有40%的機率恢復造成傷害的10%HP。",
                    imageUrl: "images/steal.png", // 確保圖片檔案存在
                    levels: Array(31).fill(null).map((_, i) => {
                        let mp, attack, successRate;
                        if (i === 0) return null;
                        mp = i <= 15 ? 12 : 24;
                        attack = 80 + i * 2; // Simplified
                        successRate = 10 + i; // Simplified
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%, 成功率: ${successRate}%`,
                            fullDescription: `攻擊範圍內的敵人，並有40%的機率恢復造成傷害的10%HP。等級${i}效果：消耗MP${mp}，攻擊力${attack}%，成功率${successRate}%。`
                        };
                    })
                },
                {
                    id: "savageBlow",
                    name: "迴旋斬",
                    maxLevel: 30,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "消耗MP而對敵人連續發動六次的攻擊，天、流、血、斬、殺",
                    imageUrl: "images/savageBlow.png", // 確保圖片檔案存在
                    levels: Array(31).fill(null).map((_, i) => {
                        let mp, attack, numAttacks;
                        if (i === 0) return null;
                        mp = i <= 10 ? 9 : (i <= 20 ? 18 : 27);
                        attack = 50 + i * 2; // Simplified
                        numAttacks = i <= 10 ? 2 : (i <= 20 ? 4 : 6);
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%, 攻擊次數: ${numAttacks}`,
                            fullDescription: `消耗MP而對敵人連續發動六次的攻擊。等級${i}效果：消耗MP${mp}，攻擊力${attack}%，攻擊次數${numAttacks}。`
                        };
                    })
                }
            ],
            "3轉 (神偷)": [
                {
                    id: "shieldMasteryThief",
                    name: "強化盾",
                    maxLevel: 20,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "提高裝備盾牌的防禦力，必須裝備盾牌才能發揮效果。",
                    imageUrl: "images/shieldMasteryThief.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => i === 0 ? null : {
                        effect: `防禦力: ${100 + i * 5}%`,
                        fullDescription: `提高裝備盾牌的防禦力，必須裝備盾牌才能發揮效果。等級${i}效果：防禦力${100 + i * 5}%。`
                    })
                },
                {
                    id: "mesoGuard",
                    name: "血魔轉換",
                    maxLevel: 30,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "消耗MP轉換成HP，轉換過程中若角色受到攻擊或移動，技能便會停止。冷卻時間210秒",
                    imageUrl: "images/mesoGuard.png",
                    levels: Array(31).fill(null).map((_, i) => {
                        let mp, hpRestoreRate, dmgTakenReduction;
                        if (i === 0) return null;
                        mp = i <= 10 ? 15 : (i <= 20 ? 21 : 27);
                        hpRestoreRate = 9 + i * 7.5; // Simplified
                        dmgTakenReduction = 200 - i * 2.8; // Simplified
                        return {
                            effect: `消耗MP: ${mp}, HP回復率: ${hpRestoreRate}%, 被攻擊損血: ${dmgTakenReduction}%`,
                            fullDescription: `消耗MP轉換成HP，轉換過程中若角色受到攻擊或移動，技能便會停止。冷卻時間210秒。等級${i}效果：消耗MP${mp}，HP回復率${hpRestoreRate}%，被攻擊損血${dmgTakenReduction}%。`
                        };
                    })
                },
                {
                    id: "assaulter",
                    name: "落葉斬",
                    maxLevel: 30,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "對單一敵人發動快速且強力的攻擊，並且在一定機率內有機會使敵人昏迷。攻擊無視物理傷害的怪物效果",
                    imageUrl: "images/assaulter.png",
                    levels: Array(31).fill(null).map((_, i) => {
                        let mp, attack, stunRate;
                        if (i === 0) return null;
                        mp = i <= 10 ? 12 : (i <= 20 ? 19 : 26);
                        attack = 200 + i * 10; // Simplified
                        stunRate = 20 + i * 2; // Simplified
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%, 昏迷率: ${stunRate}%`,
                            fullDescription: `對單一敵人發動快速且強力的攻擊，並且在一定機率內有機會使敵人昏迷。等級${i}效果：消耗MP${mp}，攻擊力${attack}%，昏迷率${stunRate}%。`
                        };
                    })
                },
                {
                    id: "mesoUp",
                    name: "勇者掠奪術",
                    maxLevel: 20,
                    requiredLevel: 70,
                    preRequisite: { "mesoExplosion": 3 },
                    description: "於一定時間內當玩家攻擊怪物時，使怪物額外掉落楓幣。掉落的楓幣量會隨著技能等級和傷殺力而增加。",
                    imageUrl: "images/mesoUp.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, duration, procRate;
                        if (i === 0) return null;
                        const mpCosts = [null, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50];
                        const durations = [null, 90, 90, 90, 90, 90, 120, 120, 120, 120, 120, 150, 150, 150, 150, 150, 180, 180, 180, 180, 180];
                        const procRates = [null, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60];
                        mp = mpCosts[i];
                        duration = durations[i];
                        procRate = procRates[i];
                        return {
                            effect: `消耗MP: ${mp}, 持續時間: ${duration}秒, 發動率: ${procRate}%`,
                            fullDescription: `於一定時間內當玩家攻擊怪物時，使怪物額外掉落楓幣。等級${i}效果：消耗MP${mp}，持續時間${duration}秒，發動率${procRate}%。`
                        };
                    })
                },
                {
                    "id": "shadowPartner",
    "name": "分身術",
    "maxLevel": 30,
    "requiredLevel": 70,
    "preRequisite": {},
    "description": "消費召喚石於一定時間內召喚出分身，分身會模仿主人做出相同的動作或攻擊。影分身並沒有HP，當超過時效時便會自動消失。",
    "imageUrl": "images/shadowPartner.png",
    "levels": Array(31).fill(null).map((_, i) => {
        let mpCost, attack, numClones;
        if (i === 0) return null;

        // 消耗MP 的規律
        if (i >= 1 && i <= 6) {
            mpCost = 10;
        } else if (i >= 7 && i <= 12) {
            mpCost = 20;
        } else if (i >= 13 && i <= 18) {
            mpCost = 30;
        } else if (i >= 19 && i <= 24) {
            mpCost = 40;
        } else if (i >= 25 && i <= 30) {
            mpCost = 50;
        }

        // 攻擊力 的規律：分段線性
        if (i >= 1 && i <= 6) {
            attack = 100 + i * 10;
        } else if (i >= 7 && i <= 12) {
            attack = 110 + (i - 6) * 10;
        } else if (i >= 13 && i <= 18) {
            attack = 120 + (i - 12) * 10;
        } else if (i >= 19 && i <= 24) {
            attack = 130 + (i - 18) * 10;
        } else if (i >= 25 && i <= 30) {
            attack = 150 + (i - 24) * 10;
        }

        // 分身數 的規律：分段
        if (i >= 1 && i <= 6) {
            numClones = 1;
        } else if (i >= 7 && i <= 12) {
            numClones = 2;
        } else if (i >= 13 && i <= 18) {
            numClones = 3;
        } else if (i >= 19 && i <= 24) {
            numClones = 4;
        } else if (i >= 25 && i <= 30) {
            numClones = 5;
        }

        return {
            effect: `消耗MP: ${mpCost}, 攻擊力: ${attack}%, 分身數: ${numClones}`,
            fullDescription: `召喚分身對周圍多個敵人發動攻擊，最多可同時攻擊6個怪物。等級${i}效果：消耗MP${mpCost}，攻擊力${attack}%，分身數${numClones}。`
        };
    })
                },
                {
                    id: "mesoGuardShield",
                    name: "楓幣護盾",
                    maxLevel: 20,
                    requiredLevel: 70,
                    preRequisite: { "mesoGuard": 3 }, // 假設血魔轉換的ID是mesoGuard
                    description: "用楓幣來抵擋怪物對自身造成的50%殺傷力。使用此技能時，身上需具備足夠的楓幣，當角色損血時，將會以一定比例扣除角色楓幣，當身上楓幣為零時，技能便自動解除。(公式:自身傷害除2 乘 楓幣減少%=減少的金幣)",
                    imageUrl: "images/mesoGuardShield.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, mesoConsumptionRate, duration;
                        if (i === 0) return null;
                        const mpCosts = [null, 20, 20, 20, 20, 20, 25, 25, 25, 25, 25, 30, 30, 30, 30, 30, 35, 35, 35, 35, 35];
                        const mesoConsumptionRates = [null, 90, 90, 89, 89, 88, 88, 87, 87, 86, 86, 85, 85, 84, 84, 83, 82, 81, 80, 79, 80]; // From data
                        const durations = [null, 33, 36, 39, 42, 53, 56, 59, 62, 65, 76, 79, 82, 85, 88, 99, 102, 105, 108, 111, 120]; // From data
                        mp = mpCosts[i];
                        mesoConsumptionRate = mesoConsumptionRates[i];
                        duration = durations[i];
                        return {
                            effect: `消耗MP: ${mp}, 楓幣消耗率: ${mesoConsumptionRate}%, 持續時間: ${duration}秒`,
                            fullDescription: `用楓幣來抵擋怪物對自身造成的50%殺傷力。等級${i}效果：消耗MP${mp}，楓幣消耗率${mesoConsumptionRate}%，持續時間${duration}秒。`
                        };
                    })
                },
                {
                    id: "mesoExplosion",
                    name: "楓幣炸彈",
                    maxLevel: 30,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "引爆前方掉落在地上的楓幣來攻擊附近的怪物，但無法引爆其他人獵殺怪物時所打掉的楓幣。",
                    imageUrl: "images/mesoExplosion.png",
                    levels: Array(31).fill(null).map((_, i) => {
                        let mp, explodeCount, mastery;
                        if (i === 0) return null;
                        mp = i <= 10 ? 18 : (i <= 20 ? 24 : 30);
                        explodeCount = 10 + Math.floor((i - 1) / 5) * 2; // Simplified
                        mastery = 50 + Math.floor((i - 1) / 5) * 2; // Simplified
                        return {
                            effect: `消耗MP: ${mp}, 引爆數: ${explodeCount}, 熟練度: ${mastery}%`,
                            fullDescription: `引爆前方掉落在地上的楓幣來攻擊附近的怪物。等級${i}效果：消耗MP${mp}，引爆數${explodeCount}，熟練度${mastery}%。`
                        };
                    })
                }
            ],
            "4轉 (暗影神偷)": [],
            "超技能": [],
            "5轉技能": [],
            "共通技能": []
        }
    },
            "夜使者 (Night Lord)": {
        startingLevelForSp: 10, // 盜賊系通常10等轉職
        jobAdvancementSpBonuses: [10, 30, 70, 120],
        jobStagesOrder: ["0轉 (新手)", "1轉 (盜賊)", "2轉 (刺客)", "3轉 (暗殺者)", "4轉 (夜使者)", "超技能", "5轉技能", "共通技能"],
        spRequiredFor2ndJob: 61, // 其他職業2轉點數需求
        spRequiredFor3rdJob: 182, // 其他職業3轉點數需求
        spRequiredFor4thJob: 249, // 4轉通用點數需求
skills: {
            "0轉 (新手)": [],
            "1轉 (盜賊)": [
                {
                    id: "haste",
                    name: "幻化術",
                    maxLevel: 20,
                    requiredLevel: 10,
                    preRequisite: {},
                    description: "增加命中率和迴避率",
                    imageUrl: "images/haste.png",
                    levels: Array(21).fill(null).map((_, i) => i === 0 ? null : {
                        effect: `命中率: ${i}, 迴避率: ${i}`,
                        fullDescription: `增加命中率和迴避率。等級${i}效果：命中率${i}，迴避率${i}。`
                    })
                },
                {
                    id: "keenEyes",
                    name: "鷹之眼",
                    maxLevel: 8,
                    requiredLevel: 10,
                    preRequisite: { "haste": 3 },
                    description: "增加暗器系武器的射程距離",
                    imageUrl: "images/keenEyes.png",
                    levels: Array(9).fill(null).map((_, i) => {
                        const rangePercent = 25 * i;
                        return i === 0 ? null : {
                            effect: `射程: ${rangePercent}%`,
                            fullDescription: `增加暗器系武器的射程距離。等級${i}效果：射程${rangePercent}%。`
                        };
                    })
                },
                {
                    id: "curse",
                    name: "詛咒術",
                    maxLevel: 20,
                    requiredLevel: 10,
                    preRequisite: {},
                    description: "可於一定時間降低怪物的物理防禦力。（適用於BOSS）",
                    imageUrl: "images/curse.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        const mp = i <= 10 ? 5 : 10;
                        const defReduction = i * 0.5;
                        const duration = i * 3;
                        return i === 0 ? null : {
                            effect: `消耗MP: ${mp}, 物理防禦: -${defReduction}%, 持續時間: ${duration}秒`,
                            fullDescription: `可於一定時間降低怪物的物理防禦力。（適用於BOSS）等級${i}效果：消耗MP${mp}，物理防禦-${defReduction}%，持續${duration}秒。`
                        };
                    })
                },
                {
                    id: "darkSight",
                    name: "隱身術",
                    maxLevel: 20,
                    requiredLevel: 10,
                    preRequisite: {},
                    description: "一定時間內消耗MP而隱身於影子之中。不會受怪物攻擊但會受環境影響如地震、毒氣、會損血的環境，無法攻擊怪物，無法喝水撿取物品，但其他行動則會正常，使用普通攻擊可以解除隱身。",
                    imageUrl: "images/darkSight.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, moveSpeed, duration;
                        if (i === 0) return null;
                        const mpCosts = [null, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5];
                        const moveSpeeds = [null, -30, -28, -26, -24, -22, -20, -18, -16, -14, -12, -10, -8, -7, -6, -5, -4, -3, -2, -1, 0];
                        const durations = Array(21).fill(10); // 持續時間固定10秒
                        mp = mpCosts[i];
                        moveSpeed = moveSpeeds[i];
                        duration = durations[i];
                        return {
                            effect: `消耗MP: ${mp}, 移動速度: ${moveSpeed}, 持續時間: ${duration}秒`,
                            fullDescription: `一定時間內消耗MP而隱身於影子之中。等級${i}效果：消耗MP${mp}，移動速度${moveSpeed}，持續${duration}秒。`
                        };
                    })
                },
                {
                    id: "doubleStab",
                    name: "劈空斬",
                    maxLevel: 20,
                    requiredLevel: 10,
                    preRequisite: {},
                    description: "消耗 MP 使用短刀連續攻擊怪物兩次。",
                    imageUrl: "images/doubleStab.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, attack;
                        if (i === 0) return null;
                        const mpCosts = [null, 6, 6, 6, 6, 7, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, 14];
                        const attacks = [null, 103, 106, 109, 112, 115, 118, 121, 124, 127, 130, 133, 136, 139, 142, 145, 148, 151, 154, 157, 160];
                        mp = mpCosts[i];
                        attack = attacks[i];
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%`,
                            fullDescription: `消耗MP使用短刀連續攻擊怪物兩次。等級${i}效果：消耗MP${mp}，攻擊力${attack}%。`
                        };
                    })
                },
                {
                    id: "luckySeven",
                    name: "雙飛斬",
                    maxLevel: 20,
                    requiredLevel: 10,
                    preRequisite: {},
                    description: "消耗MP，發射兩個飛鏢向怪物進行攻擊，而攻擊力則受幸運數值的影響。不受暗器精準的影響，以固定的形式進行攻擊。",
                    imageUrl: "images/luckySeven.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, attack;
                        if (i === 0) return null;
                        const mpCosts = [null, 8, 8, 8, 8, 9, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, 14, 14, 15, 15, 16];
                        const attacks = [null, 58, 62, 68, 72, 78, 84, 88, 94, 98, 104, 108, 114, 118, 124, 128, 132, 136, 142, 144, 150];
                        mp = mpCosts[i];
                        attack = attacks[i];
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%`,
                            fullDescription: `消耗MP，發射兩個飛鏢向怪物進行攻擊，而攻擊力則受幸運數值的影響。等級${i}效果：消耗MP${mp}，攻擊力${attack}%。`
                        };
                    })
                }
            ],
            "2轉 (刺客)": [
                {
                    id: "recovery",
                    name: "恢復術",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "當角色在梯子或繩索上，也能恢復HP/ MP。當等級提高，恢復速度會愈快，所能恢復量也會變多。",
                    imageUrl: "images/recovery.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let recoveryTime, hpAdd, mpAdd;
                        if (i === 0) return null;
                        const recoveryTimes = [null, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10];
                        const hpAdds = [null, 3, 6, 9, 12, 15, 18, 21, 24, 27, 30, 33, 36, 39, 42, 45, 48, 51, 54, 57, 60];
                        const mpAdds = [null, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20];
                        recoveryTime = recoveryTimes[i];
                        hpAdd = hpAdds[i];
                        mpAdd = mpAdds[i];
                        return {
                            effect: `回復時間: ${recoveryTime}秒, HP追加回復量: ${hpAdd}, MP追加回復量: ${mpAdd}`,
                            fullDescription: `當角色在梯子或繩索上，也能恢復HP/ MP。等級${i}效果：回復時間${recoveryTime}秒，HP追加回復量${hpAdd}，MP追加回復量${mpAdd}。`
                        };
                    })
                },
                {
                    id: "booster",
                    name: "速度激發",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "於一定時間內，提升所有隊員的移動速度與跳躍力。",
                    imageUrl: "images/booster.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, moveSpeed, jump, duration;
                        if (i === 0) return null;
                        const mpCosts = [null, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30];
                        const moveSpeeds = [null, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40];
                        const jumps = [null, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20];
                        const durations = [null, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 120, 140, 160, 180, 200, 220, 240, 260, 280, 300];
                        mp = mpCosts[i];
                        moveSpeed = moveSpeeds[i];
                        jump = jumps[i];
                        duration = durations[i];
                        return {
                            effect: `消耗MP: ${mp}, 移動速度: ${moveSpeed}, 跳躍力: ${jump}, 持續時間: ${duration}秒`,
                            fullDescription: `於一定時間內，提升所有隊員的移動速度與跳躍力。等級${i}效果：消耗MP${mp}，移動速度${moveSpeed}，跳躍力${jump}，持續時間${duration}秒。`
                        };
                    })
                },
                {
                    id: "shurikenMastery",
                    name: "精準暗器",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "增加使用暗器系武器的命中率及熟練度。該技能需在投擲飛鏢等武器時才會發揮效力。",
                    imageUrl: "images/shurikenMastery.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let hitRate, mastery;
                        if (i === 0) return null;
                        const hitRates = [null, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20];
                        const masteries = [null, 15, 15, 20, 20, 25, 25, 30, 30, 35, 35, 40, 40, 45, 45, 50, 50, 55, 55, 60, 60];
                        hitRate = hitRates[i];
                        mastery = masteries[i];
                        return {
                            effect: `命中率: ${hitRate}, 熟練度: ${mastery}%`,
                            fullDescription: `增加使用暗器系武器的命中率及熟練度。等級${i}效果：命中率${hitRate}，熟練度${mastery}%。`
                        };
                    })
                },
                {
                    id: "shurikenBooster",
                    name: "極速暗殺",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: { "shurikenMastery": 5 },
                    description: "消耗HP與MP，而使所配帶的拳套的攻擊速度向上提升一個等級。該技能只限角色配戴拳套，並投擲飛鏢等武器時才會發揮效力。",
                    imageUrl: "images/shurikenBooster.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, hp, duration;
                        if (i === 0) return null;
                        const mpCosts = [null, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10];
                        const hpCosts = [null, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10];
                        const durations = [null, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 120, 140, 160, 180, 200, 220, 240, 260, 280, 300];
                        mp = mpCosts[i];
                        hp = hpCosts[i];
                        duration = durations[i];
                        return {
                            effect: `消耗MP: ${mp}, 消耗HP: ${hp}, 持續時間: ${duration}秒`,
                            fullDescription: `消耗HP與MP，而使所配帶的拳套的攻擊速度向上提升一個等級。等級${i}效果：消耗MP${mp}，消耗HP${hp}，持續${duration}秒。`
                        };
                    })
                },
                {
                    id: "criticalThrow",
                    name: "強力投擲",
                    maxLevel: 30,
                    requiredLevel: 30,
                    preRequisite: { "shurikenMastery": 3 },
                    description: "按照一定比率，可發動致命一擊的攻擊。",
                    imageUrl: "images/criticalThrow.png",
                    levels: Array(31).fill(null).map((_, i) => {
                        let procRate, attack;
                        if (i === 0) return null;
                        const procRates = [null, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50];
                        const attacks = [null, 113, 116, 119, 122, 125, 128, 131, 134, 137, 140, 143, 146, 149, 152, 155, 158, 161, 164, 167, 170, 173, 176, 179, 182, 185, 188, 191, 194, 197, 200];
                        procRate = procRates[i];
                        attack = attacks[i];
                        return {
                            effect: `發動機率: ${procRate}%, 攻擊力: ${attack}%`,
                            fullDescription: `按照一定比率，可發動致命一擊的攻擊。等級${i}效果：發動機率${procRate}%，攻擊力${attack}%。`
                        };
                    })
                },
                {
                    id: "drain",
                    name: "吸血術",
                    maxLevel: 30,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "吸收怪物所收到的傷害值，並按照一定比例，恢復角色自身的HP。所吸收的能量，不大於角色最大HP的50%，亦不大於怪獸最大HP。",
                    imageUrl: "images/drain.png",
                    levels: Array(31).fill(null).map((_, i) => {
                        let mp, attack, absorbRate;
                        if (i === 0) return null;
                        mp = i <= 15 ? 12 : 24;
                        attack = 100 + i * 2;
                        absorbRate = 15 + i;
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}, 吸收率: ${absorbRate}%`,
                            fullDescription: `吸收怪物所收到的傷害值，並按照一定比例，恢復角色自身的HP。等級${i}效果：消耗MP${mp}，攻擊力${attack}，吸收率${absorbRate}%。`
                        };
                    })
                }
            ],
            "3轉 (暗殺者)": [
                {
    "id": "alchemist",
    "name": "藥劑精通",
    "maxLevel": 20,
    "requiredLevel": 70,
    "preRequisite": {},
    "description": "增加恢復性道具的回復量及延長狀態道具的持續時間。但若是根據比例來恢復的道具則不適用，例如特殊藥水。",
    "imageUrl": "images/alchemist.png",
    "levels": Array(21).fill(null).map((_, i) => {
        let recoveryAmount, durationIncrease;
        if (i === 0) return null;

        // 回復量 和 適用時間增加 的規律
        // 1-10級: 103% 106% ... 130% (每次加3%) => 100 + i * 3
        // 11-20級: 132% 134% ... 150% (每次加2%) => 130 + (i-10)*2
        if (i >= 1 && i <= 10) {
            recoveryAmount = 100 + i * 3;
            durationIncrease = 100 + i * 3;
        } else if (i >= 11 && i <= 20) {
            recoveryAmount = 130 + (i - 10) * 2;
            durationIncrease = 130 + (i - 10) * 2;
        }

        return {
            effect: `回復量: ${recoveryAmount}%, 適用時間增加: ${durationIncrease}%`,
            fullDescription: `增加恢復性道具的回復量及延長狀態道具的持續時間。等級${i}效果：回復量${recoveryAmount}%，適用時間增加${durationIncrease}%。`
        };
    })
},
               {
     "id": "luckyCharm",
    "name": "幸運術",
    "maxLevel": 20,
    "requiredLevel": 70,
    "preRequisite": {},
    "description": "一定時間內，包括自己及周圍的隊友，在獵殺怪物時可獲得更多的楓幣。",
    "imageUrl": "images/luckyCharm.png",
    "levels": Array(21).fill(null).map((_, i) => {
        let mpCost, duration, increaseRate;
        if (i === 0) return null;

        // 消耗MP 的規律：分段
        if (i >= 1 && i <= 5) {
            mpCost = 45;
        } else if (i >= 6 && i <= 10) {
            mpCost = 50;
        } else if (i >= 11 && i <= 15) {
            mpCost = 55;
        } else if (i >= 16 && i <= 20) {
            mpCost = 60;
        }

        // 持續時間 的規律：分段線性
        if (i >= 1 && i <= 10) {
            duration = i * 10;
        } else { // i >= 11 && i <= 20
            duration = 100 + (i - 10) * 20;
        }

        // 增加率 的規律：分段線性
        if (i >= 1 && i <= 10) {
            increaseRate = i * 3;
        } else { // i >= 11 && i <= 20
            increaseRate = 30 + (i - 10) * 2;
        }
        
        return {
            effect: `消耗MP: ${mpCost}, 持續時間: ${duration}秒, 增加率: ${increaseRate}%`,
            fullDescription: `一定時間內，包括自己及周圍的隊友，在獵殺怪物時可獲得更多的楓幣。等級${i}效果：消耗MP${mpCost}，持續時間${duration}秒，增加率${increaseRate}%。`
        };
    })
},
                {
    "id": "shadowClone",
    "name": "影分身",
    "maxLevel": 30,
    "requiredLevel": 70,
    "preRequisite": {},
    "description": "消費召喚石於一定時間內召喚出分身，分身會模仿主人做出相同的動作或攻擊。影分身並沒有HP，當超過時效時便會自動消失。",
    "imageUrl": "images/shadowClone.png",
    "levels": Array(31).fill(null).map((_, i) => {
        let mpCost, duration, normalAttackPercent, skillAttackPercent;
        if (i === 0) return null;

        // 消耗MP 的規律：線性遞減
        // 200 -> 105 (減5) for level 1-20
        // 100 -> 55 (減5) for level 21-30
        if (i <= 20) {
            mpCost = 205 - i * 5;
        } else {
            mpCost = 105 - (i - 20) * 5;
        }
        
        // 持續時間 的規律：線性遞增
        // 10 -> 200 (加10) for level 1-20
        // 210 -> 300 (加10) for level 21-30
        if (i <= 20) {
            duration = i * 10;
        } else {
            duration = 200 + (i - 20) * 10;
        }

        // 普通攻擊 的規律：
        // 20% -> 70% (加4%) for level 1-20
        // 71% -> 80% (加1%或2%) for level 21-30
        if (i <= 20) {
            normalAttackPercent = 16 + i * 2; // Level 1 is 20%
        } else {
            // Complex pattern based on provided values, hardcode for accuracy
            const normalAttacksRaw = [
                null, 20, 24, 28, 32, 36, 40, 44, 46, 48, 50, // L1-10
                52, 54, 56, 58, 60, 62, 64, 66, 68, 70, // L11-20
                71, 72, 73, 74, 75, 76, 77, 78, 79, 80 // L21-30
            ];
            normalAttackPercent = normalAttacksRaw[i];
        }

        // 技能攻擊 的規律：
        // 21% (固定) for level 1-7
        // 22% -> 34% (加1%) for level 8-20
        // 35% -> 50% (加1%或2%) for level 21-30
        if (i <= 7) {
            skillAttackPercent = 21;
        } else if (i <= 20) {
            skillAttackPercent = 20 + i; // Level 8 is 22%
        } else {
            // Complex pattern based on provided values, hardcode for accuracy
            const skillAttacksRaw = [
                null, 21, 21, 21, 21, 21, 21, 21, 22, 23, 24, // L1-10
                25, 26, 27, 28, 29, 30, 31, 32, 33, 34, // L11-20
                35, 36, 37, 38, 40, 42, 44, 46, 48, 50 // L21-30
            ];
            skillAttackPercent = skillAttacksRaw[i];
        }

        return {
            effect: `消耗MP: ${mpCost}, 持續時間: ${duration}秒, 普通攻擊: ${normalAttackPercent}%, 技能攻擊: ${skillAttackPercent}%`,
            fullDescription: `消費召喚石於一定時間內召喚出分身，分身會模仿主人做出相同的動作或攻擊。影分身並沒有HP，當超過時效時便會自動消失。等級${i}效果：消耗MP${mpCost}，持續時間${duration}秒，普通攻擊${normalAttackPercent}%，技能攻擊${skillAttackPercent}%。`
        };
    })
},
                {
                    id: "shadowWeb",
                    name: "影網術",
                    maxLevel: 20,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "將自己的影子做成蜘蛛網，用來纏住六個以下的敵人。被蜘蛛網束縛住的敵人將無法動彈力。",
                    imageUrl: "images/shadowWeb.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, duration, bindRate;
                        if (i === 0) return null;
                        mp = i <= 5 ? 10 : (i <= 10 ? 14 : (i <= 15 ? 18 : 22));
                        duration = Math.floor((i - 1) / 5) + 5; // Simplified
                        bindRate = 40 + i * 2; // Simplified
                        return {
                            effect: `消耗MP: ${mp}, 持續時間: ${duration}秒, 束縛成功率: ${bindRate}%`,
                            fullDescription: `將自己的影子做成蜘蛛網，用來纏住六個以下的敵人。等級${i}效果：消耗MP${mp}，持續時間${duration}秒，束縛成功率${bindRate}%。`
                        };
                    })
                },
                {
                    "id": "mesoAttack",
    "name": "楓幣攻擊",
    "maxLevel": 30,
    "requiredLevel": 70,
    "preRequisite": { "luckyCharm": 5 },
    "description": "使用楓幣進行攻擊，根據投擲的楓幣數量，對敵人造成傷害。該技能將無視敵人物理防禦及魔法防禦的提升。強打率:一定機率多增加50%傷害",
    "imageUrl": "images/mesoAttack.png",
    "levels": Array(31).fill(null).map((_, i) => {
        let minMeso, maxMeso, procRate, attack;
        if (i === 0) return null;

        // 最小消耗金幣的規律：線性 (40 + i * 10)
        minMeso = 40 + i * 10;
        
        // 最大消耗金幣的規律：線性 (200 + i * 20)
        maxMeso = 200 + i * 20;

        // 強打率 的規律：線性 (1% 到 30%)
        procRate = i;

        // 攻擊力 固定150%
        attack = 150;

        return {
            effect: `最小消耗金幣: ${minMeso}, 最大消耗金幣: ${maxMeso}, 強打率: ${procRate}%, 攻擊力: ${attack}%`,
            fullDescription: `使用楓幣進行攻擊，根據投擲的楓幣數量，對敵人造成傷害。等級${i}效果：最小消耗金幣${minMeso}，最大消耗金幣${maxMeso}，強打率${procRate}%，攻擊力${attack}%。`
        };
    })
                },
                {
                    id: "windDemonShuriken", // 風魔手裡劍
                    name: "風魔手裡劍",
                    maxLevel: 30,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "消耗MP對怪物投擲出大型飛鏢(消費3個飛鏢)，投擲的飛鏢將貫穿敵人，可同時對前方的怪物造成傷害。",
                    imageUrl: "images/windDemonShuriken.png",
                    levels: Array(31).fill(null).map((_, i) => {
                        let mp, attack, numEnemies;
                        if (i === 0) return null;
                        mp = i <= 10 ? 16 : (i <= 20 ? 23 : 30);
                        attack = 60 + i * 4; // Simplified
                        numEnemies = 4 + Math.floor((i - 1) / 10); // Simplified
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%, 敵人數量: ${numEnemies}`,
                            fullDescription: `消耗MP對怪物投擲出大型飛鏢(消費3個飛鏢)，投擲的飛鏢將貫穿敵人，可同時對前方的怪物造成傷害。等級${i}效果：消耗MP${mp}，攻擊力${attack}%，敵人數量${numEnemies}。`
                        };
                    })
                },
                {
                    id: "doubleJump",
                    name: "二段跳",
                    maxLevel: 20,
                    requiredLevel: 70,
                    preRequisite: { "windDemonShuriken": 5 }, // 前置技能：風魔手裡劍x5
                    description: "角色跳躍時，可使用此技能在空中進行向前方遠距離跳躍的動作。",
                    imageUrl: "images/doubleJump.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp;
                        if (i === 0) return null;
                        mp = 60 - i * 2.35; // Simplified
                        return {
                            effect: `消耗MP: ${Math.round(mp)}`,
                            fullDescription: `角色跳躍時，可使用此技能在空中進行向前方遠距離跳躍的動作。等級${i}效果：消耗MP${Math.round(mp)}。`
                        };
                    })
                }
            ],
            "4轉 (夜使者)": [],
            "超技能": [],
            "5轉技能": [],
            "共通技能": []
        }
    },
            "拳霸 (Buccaneer)": {
        startingLevelForSp: 10, // 海盜系通常10等轉職
        jobAdvancementSpBonuses: [10, 30, 70, 120],
        jobStagesOrder: ["0轉 (新手)", "1轉 (海盜)", "2轉 (打手)", "3轉 (格鬥家)", "4轉 (拳霸)", "超技能", "5轉技能", "共通技能"],
        spRequiredFor2ndJob: 61, // 其他職業2轉點數需求
        spRequiredFor3rdJob: 182, // 其他職業3轉點數需求
        spRequiredFor4thJob: 249, // 4轉通用點數需求
skills: {
            "0轉 (新手)": [],
            "1轉 (海盜)": [
                {
                    id: "nimbleBody",
                    name: "極限迴避",
                    maxLevel: 20,
                    requiredLevel: 10,
                    preRequisite: {},
                    description: "增加命中率和迴避率",
                    imageUrl: "images/nimbleBody.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => i === 0 ? null : {
                        effect: `命中率: ${i}, 迴避率: ${i}`,
                        fullDescription: `增加命中率和迴避率。等級${i}效果：命中率${i}，迴避率${i}。`
                    })
                },
                {
                    id: "straightPunch",
                    name: "衝擊拳",
                    maxLevel: 20,
                    requiredLevel: 10,
                    preRequisite: {},
                    description: "以拳頭快速攻擊單一敵人。",
                    imageUrl: "images/straightPunch.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, attack;
                        if (i === 0) return null;
                        const mpCosts = [null, 6, 6, 6, 6, 7, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, 14];
                        const attacks = [null, 156, 162, 168, 174, 180, 186, 192, 198, 204, 210, 216, 222, 228, 234, 240, 246, 252, 258, 264, 270];
                        mp = mpCosts[i];
                        attack = attacks[i];
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%`,
                            fullDescription: `以拳頭快速攻擊單一敵人。等級${i}效果：消耗MP${mp}，攻擊力${attack}%。`
                        };
                    })
                },
                {
                    id: "somersaultKick",
                    name: "旋風斬",
                    maxLevel: 20,
                    requiredLevel: 10,
                    preRequisite: {},
                    description: "跳躍動作向後旋轉，同時以腿部向週遭的多個敵人展開攻擊。",
                    imageUrl: "images/somersaultKick.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, attack, numEnemies;
                        if (i === 0) return null;
                        const mpCosts = [null, 8, 8, 8, 8, 9, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, 14, 14, 15, 15, 17];
                        const attacks = [null, 114, 118, 122, 126, 130, 134, 138, 142, 146, 150, 154, 158, 162, 166, 170, 174, 178, 182, 186, 190];
                        const numEnemiesArr = [null, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6];
                        mp = mpCosts[i];
                        attack = attacks[i];
                        numEnemies = numEnemiesArr[i];
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%, 攻擊敵人數: ${numEnemies}`,
                            fullDescription: `跳躍動作向後旋轉，同時以腿部向週遭的多個敵人展開攻擊。等級${i}效果：消耗MP${mp}，攻擊力${attack}%，攻擊敵人數${numEnemies}。`
                        };
                    })
                },
                {
                    id: "doubleShotPirate", // 為了區分其他職業的Double Shot
                    name: "雙子星攻擊",
                    maxLevel: 20,
                    requiredLevel: 10,
                    preRequisite: {},
                    description: "一次發射兩顆子彈來攻擊敵人。",
                    imageUrl: "images/doubleShotPirate.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, attack;
                        if (i === 0) return null;
                        const mpCosts = [null, 4, 4, 4, 4, 5, 5, 5, 5, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7];
                        const attacks = [null, 53, 56, 59, 62, 65, 68, 71, 74, 77, 80, 83, 86, 89, 92, 95, 98, 101, 104, 107, 110];
                        mp = mpCosts[i];
                        attack = attacks[i];
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%`,
                            fullDescription: `一次發射兩顆子彈來攻擊敵人。等級${i}效果：消耗MP${mp}，攻擊力${attack}%。`
                        };
                    })
                },
                {
                    id: "dash",
                    name: "衝鋒",
                    maxLevel: 10,
                    requiredLevel: 10,
                    preRequisite: {},
                    description: "暫時提升移動速度與跳躍力。",
                    imageUrl: "images/dash.png", // 確保圖片檔案存在
                    levels: Array(11).fill(null).map((_, i) => {
                        let mp, duration, moveSpeed, jump;
                        if (i === 0) return null;
                        const mpCosts = [null, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5];
                        const durations = [null, 15, 30, 45, 60, 75, 90, 105, 120, 135, 150]; // Level 10 duration is 150s
                        const moveSpeeds = [null, 8, 8, 8, 8, 8, 15, 15, 15, 15, 15];
                        const jumps = [null, 2, 2, 2, 2, 2, 5, 5, 5, 5, 5];
                        mp = mpCosts[i];
                        duration = durations[i];
                        moveSpeed = moveSpeeds[i];
                        jump = jumps[i];
                        return {
                            effect: `消耗MP: ${mp}, 持續時間: ${duration}秒, 移動速度: ${moveSpeed}, 跳躍力: ${jump}`,
                            fullDescription: `暫時提升移動速度與跳躍力。等級${i}效果：消耗MP${mp}，持續時間${duration}秒，移動速度${moveSpeed}，跳躍力${jump}。`
                        };
                    })
                }
            ],
            "2轉 (打手)": [
                {
                    id: "hpIncrease",
                    name: "體魄強健",
                    maxLevel: 10,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "當角色升級，或是將升級時所獲得能力點數分配到最大HP時，可提升最大HP的增加量。",
                    imageUrl: "images/hpIncrease.png", // 確保圖片檔案存在
                    levels: Array(11).fill(null).map((_, i) => i === 0 ? null : {
                        effect: `最大HP: ${i * 3}`,
                        fullDescription: `當角色升級，或是將升級時所獲得能力點數分配到最大HP時，可提升最大HP的增加量。等級${i}效果：最大HP${i * 3}。`
                    })
                },
                {
                    id: "knuckleMastery",
                    name: "精通指虎",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "提升指虎系列武器的熟練度與命中率。限定必須裝備指虎。增加10%的BOSS傷害",
                    imageUrl: "images/knuckleMastery.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => {
                        let hitRate, mastery;
                        if (i === 0) return null;
                        const hitRates = [null, 1, 2, 3, 4, 5, 6, 6, 8, 8, 10, 10, 12, 12, 14, 14, 16, 16, 18, 19, 20];
                        const masteries = [null, 15, 15, 20, 20, 25, 25, 25, 30, 30, 35, 35, 40, 40, 45, 45, 50, 50, 55, 60, 60];
                        hitRate = hitRates[i];
                        mastery = masteries[i];
                        return {
                            effect: `命中率: ${hitRate}, 熟練度: ${mastery}%`,
                            fullDescription: `提升指虎系列武器的熟練度與命中率。等級${i}效果：命中率${hitRate}，熟練度${mastery}%。`
                        };
                    })
                },
                {
                    id: "backspinBlow",
                    name: "迴旋肘擊",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "快速滑向後方，用手肘對後方多名敵人造成暈眩與傷害。減少後置延遲",
                    imageUrl: "images/backspinBlow.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, attack, numEnemies;
                        if (i === 0) return null;
                        const mpCosts = [null, 12, 12, 14, 14, 16, 16, 18, 18, 20, 20, 22, 22, 24, 24, 26, 26, 28, 28, 30, 30];
                        const attacks = [null, 88, 96, 104, 112, 120, 128, 136, 144, 152, 160, 168, 176, 184, 192, 200, 208, 216, 224, 232, 240];
                        const numEnemiesArr = Array(21).fill(3); // 敵人數量固定3
                        mp = mpCosts[i];
                        attack = attacks[i];
                        numEnemies = numEnemiesArr[i];
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%, 攻擊敵人個數: ${numEnemies}`,
                            fullDescription: `快速滑向後方，用手肘對後方多名敵人造成暈眩與傷害。等級${i}效果：消耗MP${mp}，攻擊力${attack}%，攻擊敵人個數${numEnemies}。`
                        };
                    })
                },
                {
                    id: "screwPunch",
                    name: "昇龍拳",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "以拳頭快速向敵人發動連續兩次攻擊，造成暈眩與傷害。",
                    imageUrl: "images/screwPunch.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, attack;
                        if (i === 0) return null;
                        const mpCosts = [null, 15, 15, 15, 15, 15, 20, 20, 20, 20, 20, 25, 25, 25, 25, 25, 30, 30, 30, 30, 30];
                        const attacks = [null, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290];
                        mp = mpCosts[i];
                        attack = attacks[i];
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%`,
                            fullDescription: `以拳頭快速向敵人發動連續兩次攻擊，造成暈眩與傷害。等級${i}效果：消耗MP${mp}，攻擊力${attack}%。`
                        };
                    })
                },
                {
                    id: "corkscrewBlow",
                    name: "狂暴衝擊",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "向前方衝刺，並對前方的敵人以拳頭發動攻擊。",
                    imageUrl: "images/corkscrewBlow.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, attack, numEnemies;
                        if (i === 0) return null;
                        const mpCosts = [null, 20, 20, 20, 20, 24, 24, 24, 24, 28, 28, 28, 28, 32, 32, 32, 32, 36, 36, 36, 36];
                        const attacks = [null, 135, 150, 165, 180, 195, 210, 225, 240, 255, 270, 285, 300, 315, 330, 345, 360, 375, 390, 405, 420];
                        const numEnemiesArr = Array(21).fill(3); // 敵人數量固定3
                        mp = mpCosts[i];
                        attack = attacks[i];
                        numEnemies = numEnemiesArr[i];
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%, 攻擊敵人個數: ${numEnemies}`,
                            fullDescription: `向前方衝刺，並對前方的敵人以拳頭發動攻擊。等級${i}效果：消耗MP${mp}，攻擊力${attack}%，攻擊敵人個數${numEnemies}。`
                        };
                    })
                },
                {
                    id: "mpRecovery",
                    name: "魔力再生",
                    maxLevel: 10,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "消耗自己的HP來恢復MP。",
                    imageUrl: "images/mpRecovery.png", // 確保圖片檔案存在
                    levels: Array(11).fill(null).map((_, i) => {
                        let hpCost, mpRestore, cooldown;
                        if (i === 0) return null;
                        const hpCosts = Array(11).fill("10%"); // HP消耗固定10%
                        const mpRestores = [null, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100];
                        const cooldowns = [null, 70, 65, 60, 55, 50, 45, 40, 35, 30, 25];
                        hpCost = hpCosts[i];
                        mpRestore = mpRestores[i];
                        cooldown = cooldowns[i];
                        return {
                            effect: `消耗HP: ${hpCost}, 回復MP: ${mpRestore}%, 冷卻時間: ${cooldown}秒`,
                            fullDescription: `消耗自己的HP來恢復MP。等級${i}效果：消耗HP${hpCost}，回復MP${mpRestore}%，冷卻時間${cooldown}秒。`
                        };
                    })
                },
                {
                    id: "knuckleBooster",
                    name: "致命快打",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: { "knuckleMastery": 5 },
                    description: "消耗HP、MP，一定時間內提升指虎的攻擊速度。限定必須裝備指虎。",
                    imageUrl: "images/knuckleBooster.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, hp, duration;
                        if (i === 0) return null;
                        const mpCosts = [null, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10];
                        const hpCosts = [null, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10];
                        const durations =  [null, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 120, 140, 160, 180, 200, 220, 240, 260, 280, 300]; // Level 13-20 durations are adjusted
                        mp = mpCosts[i];
                        hp = hpCosts[i];
                        duration = durations[i];
                        return {
                            effect: `消耗MP: ${mp}, 消耗HP: ${hp}, 持續時間: ${duration}秒`,
                            fullDescription: `消耗HP、MP，一定時間內提升指虎的攻擊速度。限定必須裝備指虎。等級${i}效果：消耗MP${mp}，消耗HP${hp}，持續${duration}秒。`
                        };
                    })
                },
                {
                    id: "oakBarrel",
                    name: "偽裝術",
                    maxLevel: 10,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "套上能阻檔一次傷害的木桶。有幾率打穿而受到傷害。若成功擋下攻擊，將無法繼續阻擋傷害，除非再次使用技能",
                    imageUrl: "images/oakBarrel.png", // 確保圖片檔案存在
                    levels: Array(11).fill(null).map((_, i) => {
                        let mp, missRate, cooldown;
                        if (i === 0) return null;
                        const mpCosts = [null, 20, 20, 14, 14, 16, 16, 18, 18, 20, 20];
                        const missRates = [null, 37, 34, 31, 28, 25, 22, 19, 16, 13, 10];
                        const cooldowns = [null, 20, 20, 30, 30, 25, 25, 20, 20, 15, 15];
                        mp = mpCosts[i];
                        missRate = missRates[i];
                        cooldown = cooldowns[i];
                        return {
                            effect: `消耗MP: ${mp}, 未格檔機率: ${missRate}%, 冷卻時間: ${cooldown}秒`,
                            fullDescription: `套上能阻檔一次傷害的木桶。等級${i}效果：消耗MP${mp}，未格檔機率${missRate}%，冷卻時間${cooldown}秒。`
                        };
                    })
                }
            ],
            "3轉 (格鬥家)": [
                {
                    id: "demolition",
                    name: "致命暗襲",
                    maxLevel: 20,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "對暈眩狀態的敵人進行攻擊時，會以一定機率發動致命一擊。",
                    imageUrl: "images/demolition.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, attack;
                        if (i === 0) return null;
                        const mpCosts = [null, 14, 14, 14, 14, 14, 18, 18, 18, 18, 18, 22, 22, 22, 22, 22, 26, 26, 26, 26, 26];
                        const attacks = [null, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260];
                        mp = mpCosts[i];
                        attack = attacks[i];
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%`,
                            fullDescription: `對暈眩狀態的敵人進行攻擊時，會以一定機率發動致命一擊。等級${i}效果：消耗MP${mp}，攻擊力${attack}%。`
                        };
                    })
                },
                {
                    id: "energyCharge",
                    name: "蓄能激發",
                    maxLevel: 40,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "每次攻擊就會儲存一定的能量，當能量補滿就會自動發動物理攻擊與狀態的特效，並可使用消耗能量的技能。",
                    imageUrl: "images/energyCharge.png", // 確保圖片檔案存在
                    levels: Array(41).fill(null).map((_, i) => {
                        let attack, hitRate, avoidRate, duration;
                        if (i === 0) return null;
                        const attacks = [0, 0, 0, 0, 11, 11, 11, 11, 12, 12, 12, 12, 13, 13, 13, 13, 14, 14, 14, 14, 15, 15, 15, 15, 16, 16, 16, 16, 17, 17, 17, 17, 18, 18, 18, 18, 19, 19, 19, 19, 20];
                        const rates = [0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, 14, 14, 15, 15, 16, 16, 17, 17, 18, 18, 19, 19, 20, 20]; // 命中率和迴避率
                        const durations = [0, 31, 31, 32, 32, 33, 33, 34, 34, 35, 35, 36, 36, 37, 37, 38, 38, 39, 39, 40, 40, 41, 41, 42, 42, 43, 43, 44, 44, 45, 45, 46, 46, 47, 47, 48, 48, 49, 49, 50, 50];
                        attack = attacks[i];
                        hitRate = rates[i];
                        avoidRate = rates[i];
                        duration = durations[i];
                        return {
                            effect: `攻擊力: ${attack}, 命中率: ${hitRate}, 回避率: ${avoidRate}, 持續時間: ${duration}秒`,
                            fullDescription: `每次攻擊就會儲存一定的能量，當能量補滿就會自動發動物理攻擊與狀態的特效，並可使用消耗能量的技能。等級${i}效果：攻擊力${attack}，命中率${hitRate}，回避率${avoidRate}，持續時間${duration}秒。`
                        };
                    })
                },
                {
                    id: "energyBlast",
                    name: "能量暴擊",
                    maxLevel: 30,
                    requiredLevel: 70,
                    preRequisite: { "energyCharge": 1 },
                    description: "藉著消耗能量，向近距離的多個敵人發動攻擊。只限在能量補滿的狀態下使用。",
                    imageUrl: "images/energyBlast.png", // 確保圖片檔案存在
                    levels: Array(31).fill(null).map((_, i) => {
                        let attack, numEnemies;
                        if (i === 0) return null;
                        const attacks = [null, 246, 252, 258, 264, 270, 276, 282, 288, 294, 300, 306, 312, 318, 324, 330, 336, 342, 348, 354, 360, 366, 372, 378, 384, 390, 396, 402, 408, 414, 420];
                        const numEnemiesArr = [null, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4];
                        attack = attacks[i];
                        numEnemies = numEnemiesArr[i];
                        return {
                            effect: `攻擊力: ${attack}%, 攻擊敵人個數: ${numEnemies}`,
                            fullDescription: `藉著消耗能量，向近距離的多個敵人發動攻擊。等級${i}效果：攻擊力${attack}%，攻擊敵人個數${numEnemies}。`
                        };
                    })
                },
                {
                    id: "energyDrain",
                    name: "損人利己",
                    maxLevel: 20,
                    requiredLevel: 70,
                    preRequisite: { "energyCharge": 1 },
                    description: "在能量補滿的狀態下利用能量將敵人的部份HP轉變為自己的HP。只限在能量補滿的狀態下使用。",
                    imageUrl: "images/energyDrain.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => {
                        let absorbPercent, attack;
                        if (i === 0) return null;
                        const absorbPercents = [null, 11, 11, 12, 12, 13, 13, 14, 14, 15, 15, 16, 16, 17, 17, 18, 18, 19, 19, 20, 20];
                        const attacks = [null, 265, 270, 275, 280, 285, 290, 295, 300, 305, 310, 315, 320, 325, 330, 335, 340, 345, 350, 355, 360];
                        absorbPercent = absorbPercents[i];
                        attack = attacks[i];
                        return {
                            effect: `吸收敵人傷害百分比: ${absorbPercent}%, 攻擊力: ${attack}%`,
                            fullDescription: `在能量補滿的狀態下利用能量將敵人的部份HP轉變為自己的HP。等級${i}效果：吸收敵人傷害百分比${absorbPercent}%，攻擊力${attack}%。`
                        };
                    })
                },
                {
                    id: "transformation",
                    name: "鬥神附體",
                    maxLevel: 20,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "120秒內可轉變為變身狀態。可使用技能：衝擊波、極限再起、能量衝擊、損人利己、楓葉祝福、堅忍意志、最終極速、時間置換。",
                    imageUrl: "images/transformation.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, pDef, mDef, cooldown;
                        if (i === 0) return null;
                        mp = 20 + i * 2;
                        pDef = i * 2;
                        mDef = i * 2;
                        cooldown = 880 - i * 40; // 860 - (i-1)*20
                        return {
                            effect: `消耗MP: ${mp}, 物理防禦力: ${pDef}, 魔法防禦力: ${mDef}, 冷卻時間: ${cooldown}秒`,
                            fullDescription: `120秒內可轉變為變身狀態。等級${i}效果：消耗MP${mp}，物理防禦力${pDef}，魔法防禦力${mDef}，冷卻時間${cooldown}秒。`
                        };
                    })
                },
                {
                    id: "shockwave",
                    name: "衝擊波",
                    maxLevel: 30,
                    requiredLevel: 70,
                    preRequisite: { "transformation": 1 },
                    description: "強烈地敲擊地面，藉此衝擊讓多個敵人收到傷害。只限鬥神附體、鬥神降世狀態下才能使用。",
                    imageUrl: "images/shockwave.png", // 確保圖片檔案存在
                    levels: Array(31).fill(null).map((_, i) => {
                        let mp, attack, numEnemies;
                        if (i === 0) return null;
                        mp = 18 + Math.floor((i - 1) / 5) * 4; // Simplified
                        attack = 260 + i * 15; // Simplified
                        numEnemies = 4 + Math.floor((i - 1) / 10) * 1; // Simplified
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%, 攻擊敵人個數: ${numEnemies}`,
                            fullDescription: `強烈地敲擊地面，藉此衝擊讓多個敵人收到傷害。等級${i}效果：消耗MP${mp}，攻擊力${attack}%，攻擊敵人個數${numEnemies}。`
                        };
                    })
                }
            ],
            "4轉 (拳霸)": [],
            "超技能": [],
            "5轉技能": [],
            "共通技能": []
        }
    },
            "槍神 (Corsair)": {
        startingLevelForSp: 10, // 海盜系通常10等轉職
        jobAdvancementSpBonuses: [10, 30, 70, 120],
        jobStagesOrder: ["0轉 (新手)", "1轉 (海盜)", "2轉 (槍手)", "3轉 (神槍手)", "4轉 (槍神)", "超技能", "5轉技能", "共通技能"],
        spRequiredFor2ndJob: 61, // 其他職業2轉點數需求
        spRequiredFor3rdJob: 182, // 其他職業3轉點數需求
        spRequiredFor4thJob: 249, // 4轉通用點數需求
skills: {
            "0轉 (新手)": [],
            "1轉 (海盜)": [
                {
                    id: "nimbleBody",
                    name: "極限迴避",
                    maxLevel: 20,
                    requiredLevel: 10,
                    preRequisite: {},
                    description: "增加命中率和迴避率",
                    imageUrl: "images/nimbleBody.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => i === 0 ? null : {
                        effect: `命中率: ${i}, 迴避率: ${i}`,
                        fullDescription: `增加命中率和迴避率。等級${i}效果：命中率${i}，迴避率${i}。`
                    })
                },
                {
                    id: "straightPunch",
                    name: "衝擊拳",
                    maxLevel: 20,
                    requiredLevel: 10,
                    preRequisite: {},
                    description: "以拳頭快速攻擊單一敵人。",
                    imageUrl: "images/straightPunch.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, attack;
                        if (i === 0) return null;
                        const mpCosts = [null, 6, 6, 6, 6, 7, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, 14];
                        const attacks = [null, 156, 162, 168, 174, 180, 186, 192, 198, 204, 210, 216, 222, 228, 234, 240, 246, 252, 258, 264, 270];
                        mp = mpCosts[i];
                        attack = attacks[i];
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%`,
                            fullDescription: `以拳頭快速攻擊單一敵人。等級${i}效果：消耗MP${mp}，攻擊力${attack}%。`
                        };
                    })
                },
                {
                    id: "somersaultKick",
                    name: "旋風斬",
                    maxLevel: 20,
                    requiredLevel: 10,
                    preRequisite: {},
                    description: "跳躍動作向後旋轉，同時以腿部向週遭的多個敵人展開攻擊。",
                    imageUrl: "images/somersaultKick.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, attack, numEnemies;
                        if (i === 0) return null;
                        const mpCosts = [null, 8, 8, 8, 8, 9, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, 14, 14, 15, 15, 17];
                        const attacks = [null, 114, 118, 122, 126, 130, 134, 138, 142, 146, 150, 154, 158, 162, 166, 170, 174, 178, 182, 186, 190];
                        const numEnemiesArr = [null, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6];
                        mp = mpCosts[i];
                        attack = attacks[i];
                        numEnemies = numEnemiesArr[i];
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%, 攻擊敵人數: ${numEnemies}`,
                            fullDescription: `跳躍動作向後旋轉，同時以腿部向週遭的多個敵人展開攻擊。等級${i}效果：消耗MP${mp}，攻擊力${attack}%，攻擊敵人數${numEnemies}。`
                        };
                    })
                },
                {
                    id: "doubleShotPirate", // 為了區分其他職業的Double Shot
                    name: "雙子星攻擊",
                    maxLevel: 20,
                    requiredLevel: 10,
                    preRequisite: {},
                    description: "一次發射兩顆子彈來攻擊敵人。",
                    imageUrl: "images/doubleShotPirate.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, attack;
                        if (i === 0) return null;
                        const mpCosts = [null, 4, 4, 4, 4, 5, 5, 5, 5, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7];
                        const attacks = [null, 53, 56, 59, 62, 65, 68, 71, 74, 77, 80, 83, 86, 89, 92, 95, 98, 101, 104, 107, 110];
                        mp = mpCosts[i];
                        attack = attacks[i];
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%`,
                            fullDescription: `一次發射兩顆子彈來攻擊敵人。等級${i}效果：消耗MP${mp}，攻擊力${attack}%。`
                        };
                    })
                },
                {
                    id: "dash",
                    name: "衝鋒",
                    maxLevel: 10,
                    requiredLevel: 10,
                    preRequisite: {},
                    description: "暫時提升移動速度與跳躍力。",
                    imageUrl: "images/dash.png", // 確保圖片檔案存在
                    levels: Array(11).fill(null).map((_, i) => {
                        let mp, duration, moveSpeed, jump;
                        if (i === 0) return null;
                        const mpCosts = [null, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5];
                        const durations = [null, 4, 4, 8, 8, 12, 12, 16, 16, 20, 150]; // Level 10 duration is 150s
                        const moveSpeeds = [null, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15];
                        const jumps = [null, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5];
                        mp = mpCosts[i];
                        duration = durations[i];
                        moveSpeed = moveSpeeds[i];
                        jump = jumps[i];
                        return {
                            effect: `消耗MP: ${mp}, 持續時間: ${duration}秒, 移動速度: ${moveSpeed}, 跳躍力: ${jump}`,
                            fullDescription: `暫時提升移動速度與跳躍力。等級${i}效果：消耗MP${mp}，持續時間${duration}秒，移動速度${moveSpeed}，跳躍力${jump}。`
                        };
                    })
                }
            ],
            "2轉 (槍手)": [
                {
                    id: "gunMastery",
                    name: "精通槍法",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "提升火槍系列武器的熟練度與命中率。限定必須裝備火槍。",
                    imageUrl: "images/gunMastery.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => {
                        let hitRate, mastery;
                        if (i === 0) return null;
                        const hitRates = [null, 1, 2, 3, 4, 5, 6, 6, 8, 8, 10, 10, 12, 12, 14, 14, 16, 16, 18, 19, 20];
                        const masteries = [null, 15, 15, 20, 20, 25, 25, 25, 30, 30, 35, 35, 40, 40, 45, 45, 50, 50, 55, 60, 60];
                        hitRate = hitRates[i];
                        mastery = masteries[i];
                        return {
                            effect: `命中率: ${hitRate}, 熟練度: ${mastery}%`,
                            fullDescription: `提升火槍系列武器的命中率及熟練度。等級${i}效果：命中率${hitRate}，熟練度${mastery}%。`
                        };
                    })
                },
                {
                    id: "scatterShot",
                    name: "散射",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "在短時間內，以迅雷不及掩耳的速度發射子彈來攻擊敵人。",
                    imageUrl: "images/scatterShot.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, attack, numEnemies;
                        if (i === 0) return null;
                        const mpCosts = [null, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 25]; // Level 20 MP is 25
                        const attacks = [null, 75, 80, 85, 90, 95, 100, 105, 110, 115, 120, 125, 130, 135, 140, 145, 150, 155, 160, 165, 170];
                        const numEnemiesArr = Array(21).fill(3); // 敵人數量固定3
                        mp = mpCosts[i];
                        attack = attacks[i];
                        numEnemies = numEnemiesArr[i];
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%, 攻擊敵人個數: ${numEnemies}`,
                            fullDescription: `在短時間內，以迅雷不及掩耳的速度發射子彈來攻擊敵人。等級${i}效果：消耗MP${mp}，攻擊力${attack}%，攻擊敵人個數${numEnemies}。`
                        };
                    })
                },
                {
                    id: "bombToss",
                    name: "炸彈投擲",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "丟擲炸彈來攻擊敵人，被擊中的敵方降低攻擊力予防禦力。",
                    imageUrl: "images/bombToss.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, attack, procRate, defReduction;
                        if (i === 0) return null;
                        const mpCosts = [null, 18, 18, 18, 18, 18, 24, 24, 24, 24, 24, 30, 30, 30, 30, 30, 36, 36, 36, 36, 27]; // Level 20 MP is 27
                        const attacks = [null, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100, 105, 110, 115, 120, 125, 130, 135, 195]; // Level 20 attack is 195%
                        const procRates = Array(21).fill(100); // 機率固定100%
                        const defReductions = [null, 0.5, 1, 1.5, 2, 2.5, 3, 3.5, 4, 4.5, 5, 5.5, 6, 6.5, 7, 7.5, 8, 8.5, 9, 9.5, 10]; // 降低的防禦力
                        mp = mpCosts[i];
                        attack = attacks[i];
                        procRate = procRates[i];
                        defReduction = defReductions[i];
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%, 機率: ${procRate}%, 攻擊力與防禦力降低: -${defReduction}%`,
                            fullDescription: `丟擲炸彈來攻擊敵人，被擊中的敵方降低攻擊力予防禦力。等級${i}效果：消耗MP${mp}，攻擊力${attack}%，機率${procRate}%，攻擊力與防禦力降低-${defReduction}%。`
                        };
                    })
                },
                {
                    id: "gunBooster",
                    name: "迅雷再起",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: { "gunMastery": 5 },
                    description: "消耗HP與MP，一定時間內提升火槍的攻擊速度。限定必須裝備火槍。",
                    imageUrl: "images/gunBooster.png",
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, hp, duration;
                        if (i === 0) return null;
                        const mpCosts = [null, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10];
                        const hpCosts = [null, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10];
                        const durations = [null, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 120, 140, 160, 180, 200, 220, 240, 260, 280, 300];
                        mp = mpCosts[i];
                        hp = hpCosts[i];
                        duration = durations[i];
                        return {
                            effect: `消耗MP: ${mp}, 消耗HP: ${hp}, 持續時間: ${duration}秒`,
                            fullDescription: `消耗HP與MP，一定時間內提升火槍的攻擊速度。限定必須裝備火槍。等級${i}效果：消耗MP${mp}，消耗HP${hp}，持續${duration}秒。`
                        };
                    })
                },
                {
                    id: "fakeShot",
                    name: "偽裝射擊",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "假裝要發射子彈，但卻投擲出旗幟來讓敵人感到驚嚇，藉此讓敵人無法動彈。同時可對3個敵人發動攻擊。",
                    imageUrl: "images/fakeShot.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, attack, stunDuration, numEnemies;
                        if (i === 0) return null;
                        const mpCosts = [null, 10, 10, 10, 10, 10, 15, 15, 15, 15, 15, 20, 20, 20, 20, 20, 25, 25, 25, 25, 25];
                        const attacks = [null, 63, 66, 69, 72, 75, 78, 81, 84, 87, 90, 93, 96, 99, 102, 105, 108, 111, 114, 117, 120];
                        const stunDurations = [null, 43, 46, 49, 52, 55, 58, 61, 64, 67, 70, 73, 76, 79, 82, 85, 88, 91, 94, 97, 100];
                        const numEnemiesArr = [null, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4];
                        mp = mpCosts[i];
                        attack = attacks[i];
                        stunDuration = stunDurations[i];
                        numEnemies = numEnemiesArr[i];
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%, 暈眩時間: ${stunDuration}秒, 攻擊敵人個數: ${numEnemies}`,
                            fullDescription: `假裝要發射子彈，但卻投擲出旗幟來讓敵人感到驚嚇，藉此讓敵人無法動彈。等級${i}效果：消耗MP${mp}，攻擊力${attack}%，暈眩時間${stunDuration}秒，攻擊敵人個數${numEnemies}。`
                        };
                    })
                },
                {
                    id: "slowDescent",
                    name: "緩降術",
                    maxLevel: 10,
                    requiredLevel: 30,
                    preRequisite: {},
                    description: "比起一般跳躍，可施展空中駐留時間更長的跳躍，最多駐留時間為5秒",
                    imageUrl: "images/slowDescent.png", // 確保圖片檔案存在
                    levels: Array(11).fill(null).map((_, i) => {
                        let mp, descentSpeed;
                        if (i === 0) return null;
                        mp = 50 - i * 4;
                        descentSpeed = 280 - i * 20;
                        return {
                            effect: `消耗MP: ${mp}, 降落速度: ${descentSpeed}`,
                            fullDescription: `比起一般跳躍，可施展空中駐留時間更長的跳躍。等級${i}效果：消耗MP${mp}，降落速度${descentSpeed}。`
                        };
                    })
                },
                {
                    id: "recoilShot",
                    name: "脫離戰場",
                    maxLevel: 20,
                    requiredLevel: 30,
                    preRequisite: { "slowDescent": 5 },
                    description: "利用火槍的後座力，發射子彈攻擊敵人並向後方移動，再次使用等待時間：3秒。",
                    imageUrl: "images/recoilShot.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, attack;
                        if (i === 0) return null;
                        const mpCosts = [null, 14, 14, 14, 14, 14, 18, 18, 18, 18, 18, 22, 22, 22, 22, 22, 26, 26, 26, 26, 26];
                        const attacks = [null, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260];
                        mp = mpCosts[i];
                        attack = attacks[i];
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%`,
                            fullDescription: `利用火槍的後座力，發射子彈攻擊敵人並向後方移動。等級${i}效果：消耗MP${mp}，攻擊力${attack}%。`
                        };
                    })
                }
            ],
            "3轉 (神槍手)": [
                {
                    id: "tripleFire",
                    name: "3連發",
                    maxLevel: 20,
                    requiredLevel: 70,
                    preRequisite: { "doubleShotPirate": 20 },
                    description: "使用連擊時所發射的子彈數量增多，且攻擊力也會提升。",
                    imageUrl: "images/tripleFire.png", // 確保圖片檔案存在
                    levels: Array(21).fill(null).map((_, i) => {
                        let mp, attack;
                        if (i === 0) return null;
                        const mpCosts = [null, 13, 13, 14, 14, 15, 15, 16, 16, 17, 17, 18, 18, 19, 19, 20, 20, 21, 21, 22, 22];
                        const attacks = [null, 115, 100, 105, 110, 115, 120, 125, 130, 135, 140, 145, 150, 155, 160, 165, 170, 175, 180, 185, 190]; // Level 2 attack is 100%, then increases.
                        mp = mpCosts[i];
                        attack = attacks[i];
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%`,
                            fullDescription: `使用連擊時所發射的子彈數量增多，且攻擊力也會提升。等級${i}效果：消耗MP${mp}，攻擊力${attack}%。`
                        };
                    })
                },
                {
                    id: "summonOctopus",
                    name: "章魚砲台",
                    maxLevel: 30,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "召喚可幫助攻擊的章魚，但所召喚出的章魚不會移動。再次使用等待時間：10秒。",
                    imageUrl: "images/summonOctopus.png", // 確保圖片檔案存在
                    levels: Array(31).fill(null).map((_, i) => {
                        let mp, attack, duration;
                        if (i === 0) return null;
                        mp = i <= 10 ? 10 + i : (i <= 20 ? 10 + Math.floor((i - 1) / 2) : 20 + Math.floor((i - 20) / 2)); // Simplified
                        attack = 80 + i * 4; // Simplified
                        duration = 10 + Math.floor((i - 1) / 10) * 10; // Simplified
                        return {
                            effect: `消耗MP: ${mp}, 物理攻擊力: ${attack}, 持續時間: ${duration}秒`,
                            fullDescription: `召喚可幫助攻擊的章魚，但所召喚出的章魚不會移動。等級${i}效果：消耗MP${mp}，物理攻擊力${attack}，持續時間${duration}秒。`
                        };
                    })
                },
                {
                    id: "gaviota",
                    name: "海鷗突擊隊",
                    maxLevel: 30,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "召喚出會向敵人投擲炸彈的海鷗，被召喚出的海鷗一旦發現敵人，便會投擲炸彈後消失。再次使用等待時間：5秒。",
                    imageUrl: "images/gaviota.png", // 確保圖片檔案存在
                    levels: Array(31).fill(null).map((_, i) => {
                        let mp, attack, duration;
                        if (i === 0) return null;
                        mp = 10 + Math.floor((i - 1) / 10) * 3; // Simplified
                        attack = 200 + i * 3; // Simplified
                        duration = 10 + Math.floor((i - 1) / 10) * 10; // Simplified
                        return {
                            effect: `消耗MP: ${mp}, 物理攻擊力: ${attack}, 持續時間: ${duration}秒`,
                            fullDescription: `召喚出會向敵人投擲炸彈的海鷗，被召喚出的海鷗一旦發現敵人，便會投擲炸彈後消失。等級${i}效果：消耗MP${mp}，物理攻擊力${attack}，持續時間${duration}秒。`
                        };
                    })
                },
                {
                    id: "flamethrower",
                    name: "火焰噴射",
                    maxLevel: 30,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "向近距離的敵人發動火焰屬性攻擊，受到攻擊的敵人會在一定時間內額外受到持續性傷害。",
                    imageUrl: "images/flamethrower.png", // 確保圖片檔案存在
                    levels: Array(31).fill(null).map((_, i) => {
                        let mp, attack, numEnemies;
                        if (i === 0) return null;
                        mp = i <= 10 ? 25 : (i <= 20 ? 30 : 35);
                        attack = 70 + i * 3; // Simplified
                        numEnemies = i <= 6 ? 2 : (i <= 18 ? 3 : (i <= 24 ? 4 : 5)); // Simplified
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%, 攻擊敵人個數: ${numEnemies}`,
                            fullDescription: `向近距離的敵人發動火焰屬性攻擊。等級${i}效果：消耗MP${mp}，攻擊力${attack}%，攻擊敵人個數${numEnemies}。`
                        };
                    })
                },
                {
                    id: "coldBeam",
                    name: "寒霜噴射",
                    maxLevel: 30,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "向近距離的敵人發動寒霜攻擊，受到攻擊的對方將在一定時間內成為結冰狀態。",
                    imageUrl: "images/coldBeam.png", // 確保圖片檔案存在
                    levels: Array(31).fill(null).map((_, i) => {
                        let mp, attack, numEnemies, freezeDuration;
                        if (i === 0) return null;
                        mp = i <= 10 ? 25 : (i <= 20 ? 30 : 35);
                        attack = 70 + i * 2; // Simplified
                        numEnemies = i <= 6 ? 2 : (i <= 18 ? 3 : (i <= 24 ? 4 : 5)); // Simplified
                        freezeDuration = i <= 10 ? 1 : (i <= 20 ? 2 : 3);
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%, 攻擊敵人個數: ${numEnemies}, 冰凍時間: ${freezeDuration}秒`,
                            fullDescription: `向近距離的敵人發動寒霜攻擊。等級${i}效果：消耗MP${mp}，攻擊力${attack}%，攻擊敵人個數${numEnemies}，冰凍時間${freezeDuration}秒。`
                        };
                    })
                },
                {
                    id: "targeting",
                    name: "指定攻擊",
                    maxLevel: 30,
                    requiredLevel: 70,
                    preRequisite: {},
                    description: "派出鸚鵡為敵方標記，攻擊被鸚鵡標記得敵方時，會造成額外傷害。",
                    imageUrl: "images/targeting.png", // 確保圖片檔案存在
                    levels: Array(31).fill(null).map((_, i) => {
                        let mp, attack, extraDmg;
                        if (i === 0) return null;
                        mp = i <= 20 ? 20 + Math.floor((i - 1) / 5) * 5 : 25 + Math.floor((i - 21) / 5) * 5; // Simplified
                        attack = 147 + i * 6; // Simplified
                        extraDmg = i === 1 ? "10秒內追加1％" : "--"; // Only level 1 has explicit extra damage
                        return {
                            effect: `消耗MP: ${mp}, 攻擊力: ${attack}%, 追加傷害: ${extraDmg}`,
                            fullDescription: `派出鸚鵡為敵方標記，攻擊被鸚鵡標記得敵方時，會造成額外傷害。等級${i}效果：消耗MP${mp}，攻擊力${attack}%，追加傷害${extraDmg}。`
                        };
                    })
                }
            ],
            "4轉 (槍神)": [],
            "超技能": [],
            "5轉技能": [],
            "共通技能": []
        }
    }
            // ... 未來可以繼續添加其他職業
        };

        // --- 全局變數 ---
        let currentProfessionKey = "主教 (Bishop)"; // 預設選中的職業
        let currentProfessionData = allProfessionsData[currentProfessionKey];
        let skillsData = currentProfessionData.skills; // 技能數據現在會根據所選職業動態變化

        let currentSkillLevels = {};
        let spentSp = 0;
        let remainingSp = 0;
        let currentLevel = 100;

        // --- 初始化模擬器 ---
        function initializeSimulator() {
            populateProfessionDropdown();

            const urlParams = new URLSearchParams(window.location.search);
            const sharedProf = urlParams.get('prof');
            const sharedLvl = urlParams.get('lvl');
            const sharedSkills = urlParams.get('skills');

            // 如果網址包含有效的分享資訊，則載入它
            if (sharedProf && sharedLvl && sharedSkills && allProfessionsData[sharedProf]) {
                // 1. 在下拉選單中設定對應的職業
                document.getElementById('professionSelect').value = sharedProf;
                // 2. 載入該職業的基礎數據（這會重置為預設值）
                loadProfessionData(sharedProf);

                // 3. 用分享的數據覆蓋預設值
                currentLevel = parseInt(sharedLvl, 10);
                document.getElementById('levelInput').value = currentLevel;

                // 4. 清空預設點數並應用分享的技能點數
                spentSp = 0;
                Object.keys(currentSkillLevels).forEach(id => currentSkillLevels[id] = 0);

                sharedSkills.split(',').forEach(pair => {
                    const [id, lvl] = pair.split(':');
                    const skillLevel = parseInt(lvl, 10);
                    if (id && !isNaN(skillLevel) && currentSkillLevels.hasOwnProperty(id)) {
                        currentSkillLevels[id] = skillLevel;
                        spentSp += skillLevel;
                    }
                });

                // 5. 重新計算剩餘點數並更新整個UI
                remainingSp = calculateMaxSp(currentLevel) - spentSp;
                updateUI();
            } else {
                // 否則，載入預設職業
                loadProfessionData(currentProfessionKey);
            }
        }
        // --- 填充職業下拉選單 ---
        function populateProfessionDropdown() {
            const selectElement = document.getElementById('professionSelect');
            for (const key in allProfessionsData) {
                const option = document.createElement('option');
                option.value = key;
                option.textContent = key;
                selectElement.appendChild(option);
            }
            selectElement.value = currentProfessionKey; // 設定預設選中項
        }

        // --- 載入指定職業數據 ---
        function loadProfessionData(professionKey) {
            currentProfessionKey = professionKey;
            currentProfessionData = allProfessionsData[currentProfessionKey];
            skillsData = currentProfessionData.skills; // 更新技能數據參考

            // 重置當前技能點數和SP
            currentSkillLevels = {};
            for (const jobStage in skillsData) {
                skillsData[jobStage].forEach(skill => {
                    currentSkillLevels[skill.id] = 0;
                });
            }
            spentSp = 0;
            currentLevel = 100; // 重置角色等級
            document.getElementById('levelInput').value = 100; // 更新等級輸入框顯示
            remainingSp = calculateMaxSp(currentLevel);

            // 修正：先渲染技能樹的HTML結構，再更新UI內容
            renderSkillTree();
            updateUI();
        }

        // --- 計算最大 SP ---
       function calculateMaxSp(level) {
            let totalSp = 0;
            const { startingLevelForSp, jobAdvancementSpBonuses } = currentProfessionData;

            // 1. 轉職前等級不提供 SP
            if (level < startingLevelForSp) {
                return 0;
            }

            // 2. 從起始等級開始，每級給3點SP
            totalSp += (level - startingLevelForSp) * 3;

            // 3. 額外在轉職等級獲得SP
            jobAdvancementSpBonuses.forEach(bonusLevel => {
                if (level >= bonusLevel) {
                    if (bonusLevel === 120) { // 特別處理120等轉職
                        totalSp += 3; // 120等獲得3點
                    } else {
                        totalSp += 1; // 其他轉職等級獲得1點
                    }
                }
            });

            return totalSp;
        }

        // --- 輔助函式：計算特定轉職階段的已分配SP ---
        function getSpentSpInJobStage(jobStageKey) {
            let sp = 0;
            if (skillsData[jobStageKey]) { // 確保使用當前職業的 skillsData
                skillsData[jobStageKey].forEach(skill => {
                    sp += currentSkillLevels[skill.id] || 0;
                });
            }
            return sp;
        }

        // --- 渲染技能樹 ---
        function renderSkillTree() {
            const skillTreeDiv = document.getElementById('skillTree');
            skillTreeDiv.innerHTML = ''; // 清空現有內容

            // 依照 jobStagesOrder 定義的順序來渲染
            currentProfessionData.jobStagesOrder.forEach(jobStageKey => {
                if (skillsData[jobStageKey] && skillsData[jobStageKey].length > 0) { // 確保該階段有技能
                    const sectionDiv = document.createElement('div');
                    sectionDiv.className = 'skill-section';
                    sectionDiv.innerHTML = `<h2>${jobStageKey}</h2>`;

                    skillsData[jobStageKey].forEach(skill => {
                        const skillItem = document.createElement('div');
                        skillItem.className = 'skill-item';
                        skillItem.setAttribute('data-skill-id', skill.id);

                        const skillHeader = document.createElement('div');
                        skillHeader.className = 'skill-header';
                        skillHeader.innerHTML = `
                            ${skill.imageUrl ? `<img src="${skill.imageUrl}" alt="${skill.name}" class="skill-icon" onerror="this.onerror=null;this.src='images/default.png';">` : ''}
                            <div class="skill-name">${skill.name}</div>
                            <div class="skill-level-controls">
                            <button onclick="decreaseSkill('${skill.id}')" ${currentSkillLevels[skill.id] === 0 ? 'disabled' : ''}>-</button>
                            <span class="skill-current-level" id="${skill.id}-level">${currentSkillLevels[skill.id]}</span>
                            <button onclick="increaseSkill('${skill.id}')" ${currentSkillLevels[skill.id] >= skill.maxLevel ? 'disabled' : ''}>+</button>
                            <span>/${skill.maxLevel}</span>
                            <button onclick="maxSkill('${skill.id}')" class="max-button" id="${skill.id}-max-btn">點滿</button>
                        </div>
                        `;
                        skillHeader.onclick = (event) => {
                            event.stopPropagation();
                            toggleSkillDescription(skill.id);
                        };
                        skillItem.appendChild(skillHeader);
                        // --- 新增：前置技能顯示區塊 ---
                        const preReqsDiv = document.createElement('div');
                        preReqsDiv.className = 'skill-prerequisites';
                        preReqsDiv.id = `${skill.id}-prereqs`;
                        skillItem.appendChild(preReqsDiv);
                        // 初始化時，如果沒有前置，這個區塊會被 updateSkillPrerequisitesDisplay 隱藏
                        // 但在 renderSkillTree 結束後，updateSkillDetailsDisplay 會被呼叫，確保更新

                        const descArea = document.createElement('div');
                        descArea.className = 'skill-description-area';
                        descArea.id = `${skill.id}-description`;
                        descArea.innerHTML = `
                            <p>等級 <span id="${skill.id}-level-in-desc">${currentSkillLevels[skill.id]}</span> 效果: <span id="${skill.id}-current-effect" class="current-level-effect"></span></p>
                            <span class="vertical-separator"></span>
                            <p class="full-description" id="${skill.id}-full-description">${skill.description || "無詳細描述。"}</p>
                        `;

                        if (currentSkillLevels[skill.id] > 1) {
                            descArea.style.display = 'flex';
                        } else {
                            descArea.style.display = 'none';
                        }

                        skillItem.appendChild(descArea);
                        sectionDiv.appendChild(skillItem);
                    });
                    skillTreeDiv.appendChild(sectionDiv);
                }
            });
            // updateUI(); // 渲染後更新一次UI狀態
        }

        // --- 更新 UI 顯示 ---
        function updateUI() {
            document.getElementById('spentSp').textContent = spentSp;
            document.getElementById('remainingSp').textContent = remainingSp;

            const jobStagesOrder = currentProfessionData.jobStagesOrder;

            // --- 更新各轉職階段的點數顯示 (已配置 / 轉職需求) ---
            const spentSp1stJob = getSpentSpInJobStage(jobStagesOrder[1] || "");
            const reqSp2ndJob = currentProfessionData.spRequiredFor2ndJob || 0;
            document.getElementById('spentSp_1stJob').textContent = spentSp1stJob;
            document.getElementById('reqSp_2ndJob').textContent = reqSp2ndJob;

            const spentSp2ndJob = getSpentSpInJobStage(jobStagesOrder[2] || "");
            const spentSp2ndJobTotal = spentSp1stJob + spentSp2ndJob;
            const reqSp3rdJob = currentProfessionData.spRequiredFor3rdJob || 0;
            document.getElementById('spentSp_2ndJob_total').textContent = spentSp2ndJobTotal;
            document.getElementById('reqSp_3rdJob').textContent = reqSp3rdJob;

            const spentSp3rdJob = getSpentSpInJobStage(jobStagesOrder[3] || "");
            const spentSp3rdJobTotal = spentSp2ndJobTotal + spentSp3rdJob;
            const reqSp4thJob = currentProfessionData.spRequiredFor4thJob || 0;
            document.getElementById('spentSp_3rdJob_total').textContent = spentSp3rdJobTotal;
            document.getElementById('reqSp_4thJob').textContent = reqSp4thJob;

            // --- 更新所有技能的按鈕狀態和詳情 ---
            currentProfessionData.jobStagesOrder.forEach(jobStageKey => {
                if (skillsData[jobStageKey]) {
                    skillsData[jobStageKey].forEach(skill => {
                        const levelSpan = document.getElementById(`${skill.id}-level`);
                        if (levelSpan) {
                            levelSpan.textContent = currentSkillLevels[skill.id];

                            const increaseBtn = levelSpan.nextElementSibling;
                            const decreaseBtn = levelSpan.previousElementSibling;
                            const maxBtn = document.getElementById(`${skill.id}-max-btn`); // 獲取點滿按鈕

                            // 檢查是否可增加點數 (原有的canIncrease邏輯)
                            const canIncrease =
                                currentSkillLevels[skill.id] < skill.maxLevel &&
                                remainingSp > 0 &&
                                checkOverallSkillConditions(skill, jobStageKey);

                            if (increaseBtn) increaseBtn.disabled = !canIncrease;
                            if (decreaseBtn) decreaseBtn.disabled = currentSkillLevels[skill.id] === 0;

                            // --- 判斷點滿按鈕是否可點擊 ---
                            const spNeededToMax = skill.maxLevel - currentSkillLevels[skill.id];
                            const canMaxSkill =
                                spNeededToMax > 0 && // 還有點數可點
                                remainingSp >= spNeededToMax && // 剩餘SP足夠
                                checkOverallSkillConditions(skill, jobStageKey); // 其他條件也符合

                            if (maxBtn) maxBtn.disabled = !canMaxSkill; // 啟用或禁用點滿按鈕

                            // --- 更新前置技能顯示 ---
                            updateSkillPrerequisitesDisplay(skill.id); 
                            // ... (技能詳情顯示邏輯保持不變) ...
                            const descArea = document.getElementById(`${skill.id}-description`);
                            if (descArea) {
                                if (currentSkillLevels[skill.id] > 1) {
                                    descArea.style.display = 'flex';
                                    descArea.removeAttribute('data-user-toggled');
                                } else {
                                    const userToggled = descArea.getAttribute('data-user-toggled');
                                    if (userToggled === 'open') {
                                        descArea.style.display = 'flex';
                                    } else {
                                        descArea.style.display = 'none';
                                    }
                                }
                                updateSingleSkillDetail(skill.id);
                            }
                        }
                    });
                }
            });
        }
        // --- 檢查所有技能點數和等級的條件 ---
        function checkOverallSkillConditions(skillBeingChecked, jobStageKeyOfSkill) {
            // 1. 檢查角色等級是否符合技能要求
            if (currentLevel < skillBeingChecked.requiredLevel) {
                return false;
            }

            // 2. 檢查單一技能的前置技能是否點足夠
            for (const preReqSkillId in skillBeingChecked.preRequisite) {
                if (currentSkillLevels[preReqSkillId] < skillBeingChecked.preRequisite[preReqSkillId]) {
                    return false;
                }
            }

            // 3. 檢查轉職點數總和要求
            const currentJobIndex = currentProfessionData.jobStagesOrder.indexOf(jobStageKeyOfSkill);

            // 如果是2轉技能，檢查1轉總點數
            if (jobStageKeyOfSkill.startsWith("2轉") && currentJobIndex > 0) {
                const prevJobStageKey = currentProfessionData.jobStagesOrder[currentJobIndex - 1]; // 獲取1轉的鍵名
                const spentInPrevJob = getSpentSpInJobStage(prevJobStageKey);
                // 使用 currentProfessionData 中定義的動態閾值
                if (spentInPrevJob < currentProfessionData.spRequiredFor2ndJob) {
                    return false;
                }
            }
            // 如果是3轉技能，檢查1轉+2轉總點數
            else if (jobStageKeyOfSkill.startsWith("3轉") && currentJobIndex > 1) {
                let totalSpentInPrevJobs = 0;
                for (let i = 1; i < currentJobIndex; i++) { // 從1轉開始累計到該轉職前一轉
                    totalSpentInPrevJobs += getSpentSpInJobStage(currentProfessionData.jobStagesOrder[i]);
                }
                // 使用 currentProfessionData 中定義的動態閾值
                if (totalSpentInPrevJobs < currentProfessionData.spRequiredFor3rdJob) {
                    return false;
                }
            }
            // 如果是4轉技能，檢查1轉+2轉+3轉總點數
            else if (jobStageKeyOfSkill.startsWith("4轉") && currentJobIndex > 2) {
                let totalSpentInPrevJobs = 0;
                for (let i = 1; i < currentJobIndex; i++) { // 從1轉開始累計到該轉職前一轉
                    totalSpentInPrevJobs += getSpentSpInJobStage(currentProfessionData.jobStagesOrder[i]);
                }
                // 使用 currentProfessionData 中定義的動態閾值 (spRequiredFor4thJob)
                if (totalSpentInPrevJobs < currentProfessionData.spRequiredFor4thJob) {
                    return false;
                }
            }
            // 您可以在這裡添加超技能、5轉等點數要求

            return true;
        }

        // --- 更新單一技能的詳情內容 ---
        function updateSingleSkillDetail(skillId) {
            let skill = null;
            // 在當前職業的技能數據中查找技能
            for (const jobStageKey in currentProfessionData.skills) {
                skill = currentProfessionData.skills[jobStageKey].find(s => s.id === skillId);
                if (skill) break;
            }
            if (!skill) return;

            const currentLevelPointed = currentSkillLevels[skillId];
            const levelInDescSpan = document.getElementById(`${skillId}-level-in-desc`); // 獲取顯示等級的 span
            const effectSpan = document.getElementById(`${skillId}-current-effect`);
            const fullDescP = document.getElementById(`${skillId}-full-description`);

            if (levelInDescSpan) { // 更新描述區塊中的等級數字
                levelInDescSpan.textContent = currentLevelPointed;
            }

            let effectText = "（點擊技能名稱查看效果）"; // 預設效果文字
            // 為了避免資訊重複，詳細描述區域始終顯示技能的基礎描述
            const descriptionText = skill.description || "無詳細描述。";

            if (currentLevelPointed > 0 && skill.levels && skill.levels[currentLevelPointed]) {
                const levelData = skill.levels[currentLevelPointed];
                effectText = levelData.effect || "（無此等級效果描述）";
                // 不再從 levelData.fullDescription 讀取，因為它與 effect 重複
            }

            if (effectSpan) effectSpan.textContent = effectText;
            if (fullDescP) fullDescP.innerHTML = descriptionText; // 將詳細描述區域設定為基礎描述
        }

        // --- 增加技能點數 ---
        function increaseSkill(skillId) {
            let skill = null;
            let jobStageKey = null;
            for (const stageKey in currentProfessionData.skills) {
                const foundSkill = currentProfessionData.skills[stageKey].find(s => s.id === skillId);
                if (foundSkill) {
                    skill = foundSkill;
                    jobStageKey = stageKey;
                    break;
                }
            }

            if (!skill) return;

            const canIncrease =
                currentSkillLevels[skillId] < skill.maxLevel &&
                remainingSp > 0 &&
                checkOverallSkillConditions(skill, jobStageKey);

            if (canIncrease) {
                currentSkillLevels[skillId]++;
                spentSp++;
                remainingSp--;
                updateUI();
            }
        }

        // --- 減少技能點數 ---
        function decreaseSkill(skillId) {
            if (currentSkillLevels[skillId] > 0) {
                currentSkillLevels[skillId]--;
                spentSp--;
                remainingSp++;
                updateUI();
            }
        }

        // --- 分享配點 ---
        async function shareBuild() {
            const baseUrl = window.location.origin + window.location.pathname;
            
            const skillsToShare = [];
            for (const skillId in currentSkillLevels) {
                if (currentSkillLevels[skillId] > 0) {
                    skillsToShare.push(`${skillId}:${currentSkillLevels[skillId]}`);
                }
            }
            
            const params = new URLSearchParams({
                prof: currentProfessionKey,
                lvl: currentLevel,
                skills: skillsToShare.join(',')
            });
            
            const shareUrl = `${baseUrl}?${params.toString()}`;
            await navigator.clipboard.writeText(shareUrl);
            alert('配點連結已複製到剪貼簿！\n現在可以將連結傳給朋友了。');
        }
// --- 點滿技能函式 ---
       function maxSkill(skillId) {
            let skill = null;
            let jobStageKey = null;
            for (const stageKey in currentProfessionData.skills) {
                const foundSkill = currentProfessionData.skills[stageKey].find(s => s.id === skillId);
                if (foundSkill) {
                    skill = foundSkill;
                    jobStageKey = stageKey;
                    break;
                }
            }

            if (!skill) return;

            const spNeeded = skill.maxLevel - currentSkillLevels[skill.id];

            // 檢查是否可以點滿
            const canMax =
                spNeeded > 0 && // 還有點數可點
                remainingSp >= spNeeded && // 剩餘SP足夠
                currentLevel >= skill.requiredLevel && // 角色等級符合
                checkOverallSkillConditions(skill, jobStageKey); // 其他條件也符合 (前置技能，轉職總SP等)

            if (canMax) {
                currentSkillLevels[skillId] = skill.maxLevel;
                spentSp += spNeeded;
                remainingSp -= spNeeded;
                updateUI(); // 更新UI
            } else {
                // 如果不能點滿，可以在這裡添加一些提示（例如：點數不足、等級不足、前置技能未滿等）
                // 為了簡潔，這裡暫時不顯示具體提示
                console.log(`無法點滿技能 ${skill.name}: 點數不足、等級不足或前置條件未滿足。`);
            }
        }
       // --- 輔助函式：根據技能ID獲取技能數據 ---
        function getSkillById(skillId) {
            // 遍歷所有職業的所有轉職階段來查找技能
            for (const professionKey in allProfessionsData) {
                const professionSkills = allProfessionsData[professionKey].skills;
                for (const jobStageKey in professionSkills) {
                    const foundSkill = professionSkills[jobStageKey].find(s => s.id === skillId);
                    if (foundSkill) {
                        return foundSkill; // 找到技能即返回
                    }
                }
            }
            return null; // 未找到
        }

        // --- 輔助函式：更新單一技能的前置技能顯示 ---
        function updateSkillPrerequisitesDisplay(skillId) {
            const skill = getSkillById(skillId);
            const preReqsDiv = document.getElementById(`${skillId}-prereqs`);

            if (!skill || !preReqsDiv) return;

            // 如果沒有前置技能，清空並隱藏區塊
            if (!skill.preRequisite || Object.keys(skill.preRequisite).length === 0) {
                preReqsDiv.innerHTML = '';
                preReqsDiv.style.display = 'none'; // 隱藏沒有前置技能的區塊
                return;
            }

            let preReqsHtml = '前置: ';
            let allMet = true; // 追蹤所有前置技能是否都已滿足

            for (const preReqSkillId in skill.preRequisite) {
                const requiredLevel = skill.preRequisite[preReqSkillId];
                const currentLevel = currentSkillLevels[preReqSkillId] || 0; // 確保有值，沒有點是0
                const preReqSkillData = getSkillById(preReqSkillId);
                const preReqName = preReqSkillData ? preReqSkillData.name : preReqSkillId; // 顯示技能名稱或ID

                const isMet = currentLevel >= requiredLevel;
                if (!isMet) allMet = false; // 只要有一個不滿足，就設為false

                preReqsHtml += `<span class="${isMet ? 'prereq-met' : 'prereq-unmet'}">${preReqName} (${currentLevel}/${requiredLevel})</span> `;
            }

            preReqsDiv.innerHTML = preReqsHtml;
            preReqsDiv.style.display = 'flex'; // 有前置技能時顯示

            // (可選) 根據前置技能是否滿足來改變技能項目本身的邊框或背景
            const skillItem = preReqsDiv.closest('.skill-item');
            if (skillItem) {
                if (allMet) {
                    skillItem.classList.remove('prereqs-not-all-met');
                    skillItem.classList.add('prereqs-all-met'); // 添加一個表示已滿足的class
                } else {
                    skillItem.classList.remove('prereqs-all-met');
                    skillItem.classList.add('prereqs-not-all-met'); // 添加一個表示未滿足的class
                }
            }
        }
        // --- 重置模擬器 (針對當前職業) ---
        function resetSimulator() {
            if (confirm("您確定要重置所有技能點數嗎？")) {
                loadProfessionData(currentProfessionKey); // 重新載入當前職業，達到重置效果
            }
        }

        // --- 玩家等級輸入處理 ---
        function updateLevelFromInput() {
            const inputElement = document.getElementById('levelInput');
            let newLevel = parseInt(inputElement.value);

            if (isNaN(newLevel) || newLevel < 1) {
                newLevel = 1;
                inputElement.value = 1;
            }
            if (newLevel > 300) {
                newLevel = 300;
                inputElement.value = 300;
            }

            if (newLevel !== currentLevel) {
                currentLevel = newLevel;
                remainingSp = calculateMaxSp(currentLevel) - spentSp;
                if (remainingSp < 0) remainingSp = 0;

                updateUI();
            }
        }

        // --- 切換技能詳情顯示/隱藏 ---
        function toggleSkillDescription(skillId) {
            const descArea = document.getElementById(`${skillId}-description`);
            if (!descArea) return;

            const currentLevel = currentSkillLevels[skillId];

            if (currentLevel > 1) {
                descArea.style.display = 'flex';
                descArea.removeAttribute('data-user-toggled');
                updateSingleSkillDetail(skillId);
            } else {
                if (descArea.style.display === 'flex') {
                    descArea.style.display = 'none';
                    descArea.setAttribute('data-user-toggled', 'closed');
                } else {
                    descArea.style.display = 'flex';
                    descArea.setAttribute('data-user-toggled', 'open');
                    updateSingleSkillDetail(skillId);
                }
            }
        }

        // 初始載入
        initializeSimulator();
    </script>
    <h1>MADE BY JAMOX</h1>
</body>

</html>


